<!DOCTYPE html> 
<html> 
<head> <title>KaSim, KaSa, &#x0026; KaDE reference manual
(release 03078c3)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="KaSim_manual.css" /> 
<script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true }, "HTML-CSS": { availableFonts: ["TeX"] } }); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><style type="text/css"> .MathJax_MathML {text-indent: 0;} </style></head><body 
>
<div class="maketitle">
                                                                                  

                                                                                  
                                                                                  

                                                                                  
                                                                                  

                                                                                  

<h2 class="titleHead">KaSim,Â KaSa,Â &#x0026; KaDEÂ reference manual<br />
(release 03078c3)</h2>
 <div class="author" ><span 
class="ecrm-1200">Pierre Boutillier, J</span><span 
class="ecrm-1200">Ã©</span><span 
class="ecrm-1200">r</span><span 
class="ecrm-1200">Ã´</span><span 
class="ecrm-1200">me Feret, Jean Krivine</span><span class="thank-mark"><a 
href="#tk-1"><!--l. 87--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ—</mo></math></a></span> <span 
class="ecrm-1200">and L</span><span 
class="ecrm-1200">Ã½</span> <span 
class="ecrm-1200">Kim Quy</span><span 
class="ecrm-1200">Ãª</span><span 
class="ecrm-1200">n</span>
<br />                                                                   <a 
href="http://www.kappalanguage.org" ><span 
class="ecrm-1200">KappaLanguage.org</span></a></div>
<br />
<div class="date" ></div>
<div class="thanks" ><br /><a 
 id="tk-1"></a><span class="thank-mark"><!--l. 87--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ—</mo></math></span>corresponding
author: jean.krivine@irif.fr</div>
                                                                                  

                                                                                  
</div>
                                                                                  

                                                                                  
<h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2> <div class="tableofcontents">
<span class="chapterToc" >1 <a 
href="#x1-30001" id="QQ2-1-3">Introduction</a></span>
<br />Â <span class="sectionToc" >1.1 <a 
href="#x1-40001.1" id="QQ2-1-4">Preamble</a></span>
<br />Â <span class="sectionToc" >1.2 <a 
href="#x1-50001.2" id="QQ2-1-5">The <span 
class="ecss-1095">KaSim</span>Â engine</a></span>
<br />Â <span class="sectionToc" >1.3 <a 
href="#x1-60001.3" id="QQ2-1-7">The <span 
class="ecss-1095">KaSa</span>Â static analyser</a></span>
<br />Â <span class="sectionToc" >1.4 <a 
href="#x1-70001.4" id="QQ2-1-8">The <span 
class="ecss-1095">KaDE</span>Â ODEs generator</a></span>
<br />Â <span class="sectionToc" >1.5 <a 
href="#x1-80001.5" id="QQ2-1-9">Support</a></span>
<br /><span class="chapterToc" >2 <a 
href="#x1-90002" id="QQ2-1-10">Installation</a></span>
<br />Â <span class="sectionToc" >2.1 <a 
href="#x1-100002.1" id="QQ2-1-11">Using precompiled binaries</a></span>
<br />Â <span class="sectionToc" >2.2 <a 
href="#x1-110002.2" id="QQ2-1-12">Obtaining the sources</a></span>
<br />Â <span class="sectionToc" >2.3 <a 
href="#x1-120002.3" id="QQ2-1-13">Compilation</a></span>
<br />Â <span class="sectionToc" >2.4 <a 
href="#x1-130002.4" id="QQ2-1-14">Compilation of the graphical interface of KaSaÂ and KaDE</a></span>
<br /><span class="chapterToc" >3 <a 
href="#x1-140003" id="QQ2-1-15">The kappa language</a></span>
<br />Â <span class="sectionToc" >3.1 <a 
href="#x1-150003.1" id="QQ2-1-16">General structure</a></span>
<br />Â <span class="sectionToc" >3.2 <a 
href="#x1-160003.2" id="QQ2-1-17">Agent and token signatures</a></span>
<br />Â <span class="sectionToc" >3.3 <a 
href="#x1-170003.3" id="QQ2-1-19">Sited-graph pattern: Kappa expression</a></span>
<br />Â Â <span class="subsectionToc" >3.3.1 <a 
href="#x1-180003.3.1" id="QQ2-1-20">Graph syntax</a></span>
<br />Â Â <span class="subsectionToc" >3.3.2 <a 
href="#x1-200003.3.2" id="QQ2-1-22">Pattern syntax</a></span>
<br />Â Â <span class="subsectionToc" >3.3.3 <a 
href="#x1-210003.3.3" id="QQ2-1-24">Link type</a></span>
<br />Â <span class="sectionToc" >3.4 <a 
href="#x1-230003.4" id="QQ2-1-26">Rules</a></span>
<br />Â Â <span class="subsectionToc" >3.4.1 <a 
href="#x1-240003.4.1" id="QQ2-1-28">Chemical notation rules</a></span>
<br />Â Â <span class="subsectionToc" >3.4.2 <a 
href="#x1-280003.4.2" id="QQ2-1-32">Edit notation rules</a></span>
                                                                                  

                                                                                  
<br />Â Â <span class="subsectionToc" >3.4.3 <a 
href="#x1-290003.4.3" id="QQ2-1-33">Hybrid rules</a></span>
<br />Â Â <span class="subsectionToc" >3.4.4 <a 
href="#x1-300003.4.4" id="QQ2-1-34">Rates</a></span>
<br />Â Â <span class="subsectionToc" >3.4.5 <a 
href="#x1-310003.4.5" id="QQ2-1-36">Ambiguous molecularity</a></span>
<br />Â <span class="sectionToc" >3.5 <a 
href="#x1-320003.5" id="QQ2-1-40">Variables</a></span>
<br />Â <span class="sectionToc" >3.6 <a 
href="#x1-330003.6" id="QQ2-1-43">Initial conditions</a></span>
<br /><span class="chapterToc" >4 <a 
href="#x1-340004" id="QQ2-1-44">The command line</a></span>
<br />Â <span class="sectionToc" >4.1 <a 
href="#x1-350004.1" id="QQ2-1-45">General usage</a></span>
<br />Â <span class="sectionToc" >4.2 <a 
href="#x1-360004.2" id="QQ2-1-46">Main options</a></span>
<br />Â <span class="sectionToc" >4.3 <a 
href="#x1-370004.3" id="QQ2-1-48">Advanced options</a></span>
<br />Â <span class="sectionToc" >4.4 <a 
href="#x1-380004.4" id="QQ2-1-50">Example</a></span>
<br />Â <span class="sectionToc" >4.5 <a 
href="#x1-390004.5" id="QQ2-1-51">Interactivity</a></span>
<br /><span class="chapterToc" >5 <a 
href="#x1-400005" id="QQ2-1-52">A simple model</a></span>
<br />Â <span class="sectionToc" >5.1 <a 
href="#x1-410005.1" id="QQ2-1-53">ABC.ka</a></span>
<br />Â <span class="sectionToc" >5.2 <a 
href="#x1-420005.2" id="QQ2-1-54">Some runs</a></span>
<br /><span class="chapterToc" >6 <a 
href="#x1-430006" id="QQ2-1-56">Advanced concepts</a></span>
<br />Â <span class="sectionToc" >6.1 <a 
href="#x1-440006.1" id="QQ2-1-57">Perturbation language</a></span>
<br />Â Â <span class="subsectionToc" >6.1.1 <a 
href="#x1-450006.1.1" id="QQ2-1-59">Adding or deleting agents during a simulation</a></span>
<br />Â Â <span class="subsectionToc" >6.1.2 <a 
href="#x1-460006.1.2" id="QQ2-1-61">Get a snapshot of the mixture (to deï¬ne a new initial state)</a></span>
<br />Â Â <span class="subsectionToc" >6.1.3 <a 
href="#x1-470006.1.3" id="QQ2-1-62">Interrupt simulation</a></span>
<br />Â Â <span class="subsectionToc" >6.1.4 <a 
href="#x1-480006.1.4" id="QQ2-1-63">Changing the value of a token</a></span>
<br />Â Â <span class="subsectionToc" >6.1.5 <a 
href="#x1-490006.1.5" id="QQ2-1-64">Causality analysis</a></span>
<br />Â Â <span class="subsectionToc" >6.1.6 <a 
href="#x1-510006.1.6" id="QQ2-1-67">Flux maps</a></span>
<br />Â Â <span class="subsectionToc" >6.1.7 <a 
href="#x1-520006.1.7" id="QQ2-1-69">Updating kinetic rates on the ï¬‚y</a></span>
<br />Â Â <span class="subsectionToc" >6.1.8 <a 
href="#x1-530006.1.8" id="QQ2-1-70">Combining several eï¬€ects in a single perturbation</a></span>
<br />Â Â <span class="subsectionToc" >6.1.9 <a 
href="#x1-540006.1.9" id="QQ2-1-71">Printing values during a simulation</a></span>
<br />Â Â <span class="subsectionToc" >6.1.10 <a 
href="#x1-550006.1.10" id="QQ2-1-72">Add an entry in the output data</a></span>
<br />Â <span class="sectionToc" >6.2 <a 
href="#x1-560006.2" id="QQ2-1-73">Implicit signature</a></span>
                                                                                  

                                                                                  
<br />Â <span class="sectionToc" >6.3 <a 
href="#x1-570006.3" id="QQ2-1-74">Simulation packages</a></span>
<br />Â <span class="sectionToc" >6.4 <a 
href="#x1-580006.4" id="QQ2-1-75">Simulation parameters conï¬guration</a></span>
<br /><span class="chapterToc" >7 <a 
href="#x1-590007" id="QQ2-1-77">The <span 
class="ecss-1095">KaSa</span>Â static analyser</a></span>
<br />Â <span class="sectionToc" >7.1 <a 
href="#x1-600007.1" id="QQ2-1-78">General usage</a></span>
<br />Â <span class="sectionToc" >7.2 <a 
href="#x1-610007.2" id="QQ2-1-79">Graphical interface</a></span>
<br />Â Â <span class="subsectionToc" >7.2.1 <a 
href="#x1-620007.2.1" id="QQ2-1-80">Launching the interface</a></span>
<br />Â Â <span class="subsectionToc" >7.2.2 <a 
href="#x1-630007.2.2" id="QQ2-1-82">The areas of interest</a></span>
<br />Â Â <span class="subsectionToc" >7.2.3 <a 
href="#x1-640007.2.3" id="QQ2-1-83">The sub-tab <span 
class="ectt-1095">Actions</span></a></span>
<br />Â Â <span class="subsectionToc" >7.2.4 <a 
href="#x1-650007.2.4" id="QQ2-1-84">The sub-tab <span 
class="ectt-1095">Output</span></a></span>
<br />Â <span class="sectionToc" >7.3 <a 
href="#x1-660007.3" id="QQ2-1-86">Reachability analysis</a></span>
<br />Â <span class="sectionToc" >7.4 <a 
href="#x1-670007.4" id="QQ2-1-94">Local traces</a></span>
<br />Â <span class="sectionToc" >7.5 <a 
href="#x1-680007.5" id="QQ2-1-98">Contact map</a></span>
<br />Â <span class="sectionToc" >7.6 <a 
href="#x1-690007.6" id="QQ2-1-101">Inï¬‚uence map</a></span>
<br /><span class="chapterToc" >8 <a 
href="#x1-700008" id="QQ2-1-109">The <span 
class="ecss-1095">KaDE</span>Â ODEs generator</a></span>
<br />Â <span class="sectionToc" >8.1 <a 
href="#x1-710008.1" id="QQ2-1-110">General usage</a></span>
<br />Â <span class="sectionToc" >8.2 <a 
href="#x1-720008.2" id="QQ2-1-111">Graphical interface</a></span>
<br />Â Â <span class="subsectionToc" >8.2.1 <a 
href="#x1-730008.2.1" id="QQ2-1-112">Launching the interface</a></span>
<br />Â Â <span class="subsectionToc" >8.2.2 <a 
href="#x1-740008.2.2" id="QQ2-1-114">The areas of interest</a></span>
<br />Â Â <span class="subsectionToc" >8.2.3 <a 
href="#x1-750008.2.3" id="QQ2-1-115">The sub-tab <span 
class="ectt-1095">Data set</span></a></span>
<br />Â Â <span class="subsectionToc" >8.2.4 <a 
href="#x1-760008.2.4" id="QQ2-1-116">The sub-tab <span 
class="ectt-1095">Output</span></a></span>
<br />Â Â <span class="subsectionToc" >8.2.5 <a 
href="#x1-770008.2.5" id="QQ2-1-118">The sub-tab <span 
class="ectt-1095">Integration settings</span></a></span>
<br />Â Â <span class="subsectionToc" >8.2.6 <a 
href="#x1-780008.2.6" id="QQ2-1-120">The sub-tab <span 
class="ectt-1095">Debug</span></a></span>
<br />Â <span class="sectionToc" >8.3 <a 
href="#x1-790008.3" id="QQ2-1-122">Diï¬€erential semantics</a></span>
<br />Â Â <span class="subsectionToc" >8.3.1 <a 
href="#x1-800008.3.1" id="QQ2-1-123">From rules to reactions</a></span>
</div>
                                                                                  

                                                                                  
                                                                                  

                                                                                  
<h2 class="likechapterHead"><a 
 id="x1-2000"></a>List of Tables</h2><div class="tableofcontents"><span class="lotToc" >3.1Â <a 
href="#x1-160071">Agent signatureexpression</a></span><br /><span class="lotToc" >3.2Â <a 
href="#x1-200022">Kappa expressions</a></span><br /><span class="lotToc" >3.3Â <a 
href="#x1-230133">Token
expressions</a></span><br /><span class="lotToc" >3.4Â <a 
href="#x1-300064">Example of kinetic rates.</a></span><br /><span class="lotToc" >3.5Â <a 
href="#x1-310295">Rate expressions</a></span><br /><span class="lotToc" >3.6Â <a 
href="#x1-320036">Algebraic
expressions</a></span><br /><span class="lotToc" >3.7Â <a 
href="#x1-320047">Symbol usable in algebraic expressions</a></span><br /><span class="lotToc" >4.1Â <a 
href="#x1-360011">Command
line: main options</a></span><br /><span class="lotToc" >4.2Â <a 
href="#x1-370012">Command line: advanced options</a></span><br /><span class="lotToc" >6.1Â <a 
href="#x1-440091">Perturbation
expressions</a></span><br /><span class="lotToc" >6.2Â <a 
href="#x1-580022">User deï¬ned parameters</a></span><br />
</div>
                                                                                  

                                                                                  
<!--l. 97--><p class="noindent" >
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 1</span><br /><a 
 id="x1-30001"></a>Introduction</h2>
<div class="center" 
>
<!--l. 98--><p class="noindent" >
<!--l. 98--><p class="noindent" ><img 
src="Ka0x.png" alt="PIC" class="graphics" width="256.0748pt" height="136.57285pt" ><!--tex4ht:graphics  
name="Ka0x.png" src="img/KaSim-Logo.pdf"  
--></div>
<h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-40001.1"></a>Preamble</h3>
<!--l. 101--><p class="noindent" >This manual describes the usage of <span 
class="ecss-1095">KaSim</span>Â and <span 
class="ecss-1095">KaSa</span>, the latest implementation of Kappa, one
member of the growing family of rule-based languages. Rule-based modelling has attracted recent
attention in developing biological models that are concise, comprehensible, easily extensible, and
allows one to deal with the combinatorial complexity of multi-state and multi-component
biological molecules. Although this manual contains a self-contained description of Kappa, it is
<span 
class="ecti-1095">not </span>intended as a tutorial on rule-based modeling.
<!--l. 105--><p class="noindent" >To get an idea of how Kappa is used in a modeling context, the reader can consult
the following note <a 
href="http://www.research.ed.ac.uk/portal/files/16869853/Agile_Modelling_of_Cellular_Signalling_Invited_Paper_.pdf" >Agile modelling of cellular signalling (SOS&#x2019;08)</a>. A longer article,
expounding on causal analysis is also available: <a 
href="http://fontana.med.harvard.edu/www/Documents/WF/Papers/signaling.causality.pdf" >Rule-based modelling of cellular signalling
(CONCUR&#x2019;07)</a>. See also this tutorial: <a 
href="https://hal.archives-ouvertes.fr/hal-00692430" >Modelling epigenetic information maintenance: a Kappa
tutorial</a>.
<!--l. 107--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-50001.2"></a>The <span 
class="ecss-1095">KaSim</span>Â engine</h3>
<!--l. 108--><p class="noindent" ><span 
class="ecss-1095">KaSim</span>Â is an open source stochastic simulator of rule-based modelsÂ <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> written in Kappa.
The Kappa language describes site graphs and their local transformations. <span 
class="ecss-1095">KaSim</span>Â takes one or
several <a 
href="#x1-140003">Kappa ï¬les</a> as input and generates stochastic trajectories of various observables.
                                                                                  

                                                                                  
<span 
class="ecss-1095">KaSim</span>Â implements Danos <span 
class="ecti-1095">et al</span>&#x2019;s implicit state simulation algorithmÂ <span class="cite">[<span 
class="ecbx-1095">?</span>]</span> which adapts Gillespie&#x2019;s
algorithmÂ <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> to rule-based models.
<!--l. 110--><p class="noindent" >A <span 
class="ecti-1095">simulation event</span><a 
 id="dx1-5001"></a> corresponds to the application of a rewriting rule, contained in the Kappa
ï¬les, to the current graph<a 
 id="dx1-5002"></a> (also called a <span 
class="ecti-1095">mixture</span><a 
 id="dx1-5003"></a>). At each step, the next event is selected with a
probability which is proportional to the rate<a 
 id="dx1-5004"></a> of the rule it is an event of. If there are no
events, that is to say if none of the rules apply to the current state of the system, one
has a <span 
class="ecti-1095">deadlock</span>. Note that a given rule will in general apply in many diï¬€erent ways;
one says it has many instances. The <span 
class="ecti-1095">activity</span><a 
 id="dx1-5005"></a> of a rule is the number of its instances
in the current mixture<a 
 id="dx1-5006"></a> multiplied by its rate. The probability that the next event is
associated to a given rule is therefore proportional to the activity of the rule. Rule activities<a 
 id="dx1-5007"></a>
are updated at each step (see Fig.Â <a 
href="#x1-50081">1.1<!--tex4ht:ref: fig:event-loop --></a>). Importantly, the cost of a simulation event
is bounded by a constant that is independent of the size of the graph it is applied
toÂ <span class="cite">[<span 
class="ecbx-1095">?</span>]</span>.
<!--l. 120--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-50081"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 121--><p class="noindent" >

<!--l. 122--><p class="noindent" ><img 
src="img/event-loop.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 1.1: </span><span  
class="content">The event loop</span></div><!--tex4ht:label?: x1-50081 -->
</div>
                                                                                  

                                                                                  
<!--l. 126--><p class="noindent" ></div><hr class="endfigure">
<!--l. 128--><p class="noindent" >Note that <span 
class="ecss-1095">KaSim</span>Â can only render curves in the svg format. However, data outputs
given in a text format can be displayed using any standard plotting software such as
<a 
href="http://www.gnuplot.info/" >gnuplot</a>.
<h3 class="sectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-60001.3"></a>The <span 
class="ecss-1095">KaSa</span>Â static analyser</h3>
<!--l. 132--><p class="noindent" ><span 
class="ecss-1095">KaSa</span>Â is an open source static analyser tool of rule-based modelsÂ <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> written in Kappa.
<span 
class="ecss-1095">KaSa</span>Â takes one or several <a 
href="#x1-140003">Kappa ï¬les</a> as input and some command line options to toggle on/oï¬€
some speciï¬c static analysis. Currently, <span 
class="ecss-1095">KaSa</span>Â can compute the contact map and the inï¬‚uence
map. It can perform reachability analysis <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> as well. Other analyses including model reduction
<span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> will come soon.
<!--l. 134--><p class="noindent" >A graphical interface is proposed to navigate through the various options and utilities of <span 
class="ecss-1095">KaSa</span>.
The compilation of this interface requires <a 
href="https://forge.ocamlcore.org/projects/labltk/" >labltk</a> and, in particular, <a 
href="http://www.tcl.tk/" >tk-dev</a>.
<!--l. 136--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.4   </span> <a 
 id="x1-70001.4"></a>The <span 
class="ecss-1095">KaDE</span>Â ODEs generator</h3>
<!--l. 138--><p class="noindent" ><span 
class="ecss-1095">KaDE</span>Â is an open source tool to compile rule-based modelsÂ <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span> written in Kappa into
systems of ordinary diï¬€erential equations, or equivalently into reaction networks. It also supports
some model reduction techniques, that may reduce the dimension of the ODEs (or the number of
diï¬€erent bio-molecular species in reaction networks).
<!--l. 142--><p class="noindent" ><span 
class="ecss-1095">KaDE</span>Â takes one or several <a 
href="#x1-140003">Kappa ï¬les</a> as input and some command line options to select a
backend format, some semantics options, and some model reduction methods.
<!--l. 144--><p class="noindent" >A graphical interface is proposed to navigate through the various options and utilities of <span 
class="ecss-1095">KaDE</span>.
The compilation of this interface requires <a 
href="https://forge.ocamlcore.org/projects/labltk/" >labltk</a> and, in particular, <a 
href="http://www.tcl.tk/" >tk-dev</a>.
<!--l. 147--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.5   </span> <a 
 id="x1-80001.5"></a>Support</h3>
                                                                                  

                                                                                  
     <ul class="itemize1">
     <li class="itemize">Kappa language tutorials and downloads: <a 
href="http://kappalanguage.org" class="url" ><span 
class="ectt-1095">http://kappalanguage.org</span></a>
     </li>
     <li class="itemize">Bug           reports           should           be           posted           on           github:
     <a 
href="https://github.com/Kappa-Dev/KaSim/issues" class="url" ><span 
class="ectt-1095">https://github.com/Kappa-_Dev/KaSim/issues</span></a>
     </li>
     <li class="itemize">Questions       and       answers       on       the       kappa-user       mailing       list:
     <a 
href="http://groups.google.com/group/kappa-users" class="url" ><span 
class="ectt-1095">http://groups.google.com/group/kappa-_users</span></a>
     </li>
     <li class="itemize">Want to contribute to the project? <span 
class="ectt-1095">jean.krivine@irif.fr</span></li></ul>
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 2</span><br /><a 
 id="x1-90002"></a>Installation</h2>
<h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-100002.1"></a>Using precompiled binaries</h3>
<!--l. 158--><p class="noindent" >The easiest way to use <span 
class="ecss-1095">KaSim</span>Â and <span 
class="ecss-1095">KaSa</span>Â is to use pre-compiled versions available in the release
section on the github repository (<a 
href="https://github.com/Kappa-Dev/KaSim/releases" class="url" ><span 
class="ectt-1095">https://github.com/Kappa-_Dev/KaSim/releases</span></a>).
Download the version that corresponds to your operating system (Windows, Linux or
Mac OSX) and rename the downloaded ï¬le into <span 
class="ecss-1095">KaSim</span>Â and <span 
class="ecss-1095">KaSa</span>. Note that on Mac
OSX or Linux, it might be necessary to give executable permissions to <span 
class="ecss-1095">KaSim</span>Â and
<span 
class="ecss-1095">KaSa</span>. This can be done using the shell commands: <span 
class="ectt-1095">chmod u+x KaSim </span>and <span 
class="ectt-1095">chmod u+x</span>
<span 
class="ectt-1095">KaSa</span>
<!--l. 161--><p class="noindent" >To test whether your program does work, simply type <span 
class="ectt-1095">./KaSim --version </span>on a terminal, from
the directory that contains the binaries. If the version is displayed it means that the binaries are
indeed compatible with your OS. Otherwise you may need to compile <span 
class="ecss-1095">KaSim</span>Â from the sources
(see next Section).
<!--l. 163--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-110002.2"></a>Obtaining the sources</h3>
<!--l. 164--><p class="noindent" >To obtain <span 
class="ecss-1095">KaSim</span>/<span 
class="ecss-1095">KaSa</span>Â you can either use pre-compiled binaries (see previous section) or compile
the sources for your architecture by yourself.
<!--l. 168--><p class="noindent" >To do so, download the source code from <a 
href="https://github.com/Kappa-Dev/KaSim" class="url" ><span 
class="ectt-1095">https://github.com/Kappa-_Dev/KaSim</span></a>, make sure
you have a recent OCaml compiler (<span 
class="ecss-1095">KaSim</span>/<span 
class="ecss-1095">KaSa</span>Â currently requires Ocaml 4.02.3 to compile) as
well as <span 
class="ectt-1095">ocamlbuild</span>, <span 
class="ectt-1095">findlib </span>and the <span 
class="ectt-1095">yojson </span>library installed.
<!--l. 174--><p class="noindent" >You can check if it is the case from a terminal window by typing ï¬rst <span 
class="ectt-1095">ocamlfind ocamlopt -v</span>. If
it fails or prints a version number too old, then you need to install Ocaml Native compiler that
can be downloaded from <a 
href="http://caml.inria.fr/download.en.html" class="url" ><span 
class="ectt-1095">http://caml.inria.fr/download.en.html</span></a> and/or ï¬ndlib available at
<a 
href="http://projects.camlcity.org/projects/findlib.html" class="url" ><span 
class="ectt-1095">http://projects.camlcity.org/projects/findlib.html</span></a>.
<!--l. 181--><p class="noindent" >Then, type <span 
class="ectt-1095">ocamlfind query yojson</span>. The answer should be a path. If it is not, install yojson
using a package manager.
<!--l. 184--><p class="noindent" >Ocamlbuild is hosted on <a 
href="https://github.com/ocaml/ocamlbuild" class="url" ><span 
class="ectt-1095">https://github.com/ocaml/ocamlbuild</span></a>.
                                                                                  

                                                                                  
<!--l. 186--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-120002.3"></a>Compilation</h3>
<!--l. 187--><p class="noindent" >Once OCaml is safely installed, untar <span 
class="ecss-1095">KaSim</span>Â archive and compile following these few
steps:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">tar xzvf kasim.tar.gz -d Kappa</span>
     </li>
     <li class="itemize"><span 
class="ectt-1095">cd Kappa</span>
     </li>
     <li class="itemize"><span 
class="ectt-1095">make bin/KaSim</span>
     </li>
     <li class="itemize"><span 
class="ectt-1095">make bin/KaSa</span></li></ul>
<!--l. 194--><p class="noindent" >At the end of these steps you should see, in the <span 
class="ectt-1095">bin </span>directory of the <span 
class="ectt-1095">Kappa </span>directory, an
executable ï¬le named KaSim. In order to check the compilation went ï¬ne, simply type <span 
class="ectt-1095">bin/KaSim</span>
<span 
class="ectt-1095">--version</span>.
<!--l. 199--><p class="noindent" >If the tool <span 
class="ectt-1095">ocamlbuild </span>is not in your path, you may set the variable <span 
class="ectt-1095">OCAMLBINPATH </span>to point
to the location of the compiler by doing <span 
class="ectt-1095">make OCAMLBINPATH=&#x2019;the_correct_dir&#x2019;</span>
<span 
class="ectt-1095">bin/KaSim</span>.
<!--l. 203--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-130002.4"></a>Compilation of the graphical interface of KaSaÂ and KaDE</h3>
<!--l. 205--><p class="noindent" >The graphical interface of <span 
class="ecss-1095">KaSa</span>Â and <span 
class="ecss-1095">KaDE</span>Â requires <a 
href="http://www.tcl.tk/" >tk-dev</a> and <a 
href="https://forge.ocamlcore.org/projects/labltk/" >labltk</a>. By default, the
graphical interface is not compiled. The compilation of this interface can be toggled
on by using the following command: <span 
class="ectt-1095">make USE_TK=1 bin/KaSa </span>(or <span 
class="ectt-1095">make USE_TK=1</span>
<span 
class="ectt-1095">bin/KaDE</span>).
<!--l. 212--><p class="noindent" >Common compilation errors are the following:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-13002x1">The following error:
                                                                                  

                                                                                  
     <div class="verbatim" id="verbatim-1">
     /usr/bin/ld:Â cannotÂ findÂ -ltk
     Â <br />collect2:Â error:Â ldÂ returnedÂ 1Â exitÂ status
     Â <br />FileÂ &#x0022;caml_startup&#x0022;,Â lineÂ 1:
     Â <br />Error:Â ErrorÂ duringÂ linking
     Â <br />CommandÂ exitedÂ withÂ codeÂ 2.</div>
     <!--l. 222--><p class="nopar" >
     <!--l. 224--><p class="noindent" >occurs when the module <a 
href="http://www.tcl.tk/" >tk-dev</a> is not installed.
     </li>
     <li 
  class="enumerate" id="x1-13004x2">The following error:
                                                                                  

                                                                                  
     <div class="verbatim" id="verbatim-2">
     FileÂ &#x0022;_none_&#x0022;,Â lineÂ 1:
     Â <br />Error:Â CannotÂ findÂ fileÂ jpflib.cmxa
     Â <br />CommandÂ exitedÂ withÂ codeÂ 2.</div>
     <!--l. 231--><p class="nopar" >
     <!--l. 233--><p class="noindent" >occurs when ocaml cannot link the labltk library.
     <!--l. 235--><p class="noindent" >Please document the variable <span 
class="ectt-1095">LABLTKLIBREP </span>in the Makeï¬le.
     </li></ol>
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 3</span><br /><a 
 id="x1-140003"></a>The kappa language</h2>
<h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-150003.1"></a>General structure</h3>
<!--l. 242--><p class="noindent" >A model is represented in Kappa by a set of <span 
class="ecti-1095">Kappa File</span>. We use KF<a 
 id="dx1-15001"></a> to denote the union of the
ï¬les that are given as input (to either <span 
class="ecss-1095">KaSim</span>Â or <span 
class="ecss-1095">KaSa</span>).
<!--l. 246--><p class="noindent" >Each line of the KF<a 
 id="dx1-15002"></a> is interpreted as a <span 
class="ecti-1095">declaration</span><a 
 id="dx1-15003"></a> except if the line ends by theÂ <span 
class="tcrm-1095">'</span>
<!--l. 248--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ–</mo></math><span 
class="tcrm-1095">' </span>character.
Therefore, in order to write a declaration<a 
 id="dx1-15004"></a> on several lines, ends every by the last of the lines with a
<!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ–</mo></math>.
<!--l. 253--><p class="noindent" >Declarations can be: agent and token <span 
class="ecti-1095">signatures </span>(Sec.Â <a 
href="#x1-160003.2">3.2<!--tex4ht:ref: sec:sig --></a>), <span 
class="ecti-1095">rules</span><a 
 id="dx1-15005"></a> (Sec.Â <a 
href="#x1-230003.4">3.4<!--tex4ht:ref: sec:rules --></a>), <span 
class="ecti-1095">variables</span><a 
 id="dx1-15006"></a> (Sec.Â <a 
href="#x1-320003.5">3.5<!--tex4ht:ref: sec:var --></a>),
<span 
class="ecti-1095">initial conditions</span><a 
 id="dx1-15007"></a> (Sec.Â <a 
href="#x1-330003.6">3.6<!--tex4ht:ref: sec:init --></a>), <span 
class="ecti-1095">perturbations</span><a 
 id="dx1-15008"></a> (Sec.Â <a 
href="#x1-440006.1">6.1<!--tex4ht:ref: sec:mod --></a>) and <span 
class="ecti-1095">parameter conï¬gurations</span>
(Sec.Â <a 
href="#x1-580006.4">6.4<!--tex4ht:ref: sec:param --></a>).
<!--l. 260--><p class="noindent" >The KF<a 
 id="dx1-15009"></a>&#x2019;s structure is quite ï¬‚exible. Neither dividing into several sub-ï¬les nor the order of
declaration<a 
 id="dx1-15010"></a>s matters (to the exception of perturbations and variable declaration<a 
 id="dx1-15011"></a>s, see respectively
Sections <a 
href="#x1-440006.1">6.1<!--tex4ht:ref: sec:mod --></a> and <a 
href="#x1-320003.5">3.5<!--tex4ht:ref: sec:var --></a> for details).
<!--l. 266--><p class="noindent" >Comments<a 
 id="dx1-15012"></a> can be used either by inserting the marker <span 
class="ectt-1095"># </span>that tells <span 
class="ecss-1095">KaSim</span>Â to ignore the rest of the
line or by putting any text between the delimiters <span 
class="ectt-1095">/* </span>and <span 
class="ectt-1095">*/</span>. The combined use of
<!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ–</mo></math> and <span 
class="ectt-1095">#</span>
is an alternative way to write comments in the middle of a declaration<a 
 id="dx1-15013"></a>.
<!--l. 272--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-160003.2"></a>Agent and token signatures</h3>
<a 
 id="dx1-16001"></a>
<!--l. 274--><p class="noindent" >In Kappa there are two entities that can be used for representing biological elements: <span 
class="ecti-1095">agents</span><a 
 id="dx1-16002"></a> and
<span 
class="ecti-1095">tokens</span><a 
 id="dx1-16003"></a>. Agents are used to represent complex molecules that may bind to other molecules on
speciï¬c sites. Tokens are typically used to represent small particles such as ions, ATP, etc.
Tokens cannot bind to each other, they can only appear or disappear. In a given model,
agents always have a discrete number of instances while tokens may have a continuous
concentration.
<!--l. 283--><p class="noindent" >In order to use agents or tokens in a model, one needs to declare them ï¬rst. <span 
class="ecti-1095">Agent signatures</span><a 
 id="dx1-16004"></a>
constitute a form of typing information about the agents that are used in the model. It
contains information about the name and number of interaction sites the agent has, and
about their possible internal states. A signature<a 
 id="dx1-16005"></a> is declared in the KF<a 
 id="dx1-16006"></a> by the following
                                                                                  

                                                                                  
line:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%agent:  </span><span 
class="ecti-1095">signature_expression</span></li></ul>
<!--l. 290--><p class="noindent" >according to the grammar given TableÂ <a 
href="#x1-160071">3.1<!--tex4ht:ref: tab:sig --></a> where terminal symbols are written in (blue) typed font,
and <!--l. 292--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœ€</mi></math>
stands for the empty list. An identiï¬er <span 
class="ectt-1095">Id </span>can be any string generated by a regular expression of the
type <!--l. 294--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mi 
>-</mi><mi 
>z</mi><mspace width="1em" class="nbsp" /><mi 
>A</mi><mi 
>-</mi><mi 
>Z</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><msup><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mi 
>-</mi><mi 
>z</mi><mspace width="1em" class="nbsp" /><mi 
>A</mi><mi 
>-</mi><mi 
>Z</mi><mspace width="1em" class="nbsp" /><mn>0</mn><mi 
>-</mi><mn>9</mn><mspace width="1em" class="nbsp" /><mstyle 
class="text"><mtext  >_</mtext></mstyle><mspace width="1em" class="nbsp" /> <mo 
class="MathClass-bin">âˆ’</mo><mspace width="1em" class="nbsp" /><mo 
class="MathClass-bin">+</mo></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mo 
class="MathClass-bin">âˆ—</mo></mrow></msup 
></math>.
<div class="table">
<!--l. 297--><p class="noindent" ><a 
 id="x1-160071"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.1: </span><span  
class="content">Agent signatureexpression</span></div><!--tex4ht:label?: x1-160071 -->
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"><col 
id="TBL-2-2"><col 
id="TBL-2-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-1"  
class="td01"><span 
class="ecti-1095">signature_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-2-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-3"  
class="td10"> <span id="textcolor1"><span 
class="ectt-1095">Id</span></span><span id="textcolor2"><span 
class="ectt-1095">(</span></span><span 
class="ecti-1095">sig</span><span id="textcolor3"><span 
class="ectt-1095">)</span></span>                                                                                              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-1"  
class="td01"><span 
class="ecti-1095">sig                         </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-2-2-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-3"  
class="td10"> <span id="textcolor4"><span 
class="ectt-1095">Id</span></span>Â <span 
class="ecti-1095">internal_state_list</span><span id="textcolor5"><span 
class="ectt-1095">,</span></span>Â <span 
class="ecti-1095">sig </span><!--l. 307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo><mi 
>ğœ€</mi></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-1"  
class="td01"><span 
class="ecti-1095">internal_state_list     </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-2-3-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-3"  
class="td10"> <span id="textcolor6"><span 
class="ectt-1095">~Id</span></span>Â <span 
class="ecti-1095">internal_state_list </span><!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo><mi 
>ğœ€</mi></math>     </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<!--l. 317--><p class="noindent" >For instance the line: <!--l. 318-->
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-16008r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,y~u~p,z~0~1~2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Signature</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">of</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">agent</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span>
</div>
<!--l. 321--><p class="noindent" >will declare an agent <span 
class="ectt-1095">A </span>with 3 <span 
class="ecti-1095">(interaction) sites </span><span 
class="ectt-1095">x,y </span>and <span 
class="ectt-1095">z </span>with the site <span 
class="ectt-1095">y</span>
possessing two <span 
class="ecti-1095">internal states</span><a 
 id="dx1-16009"></a> <span 
class="ectt-1095">u </span>and <span 
class="ectt-1095">p </span>(for instance for the unphosphorylated
and phosphorylated forms of <span 
class="ectt-1095">y</span>) and the site <span 
class="ectt-1095">z </span>having three possible states
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>,
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math> and
<!--l. 326--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>. Note
that internal states<a 
 id="dx1-16010"></a> values are treated as untyped symbols by <span 
class="ecss-1095">KaSim</span>, so choosing a character or
an integer as internal state is purely a matter of convention.
<!--l. 330--><p class="noindent" >Token signature<a 
 id="dx1-16011"></a>s are declared using a statement of the form: <!--l. 332-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-16012r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%token:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">ca</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Signature</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">of</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">calcium</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">token</span>
</div>
<h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-170003.3"></a>Sited-graph pattern: Kappa expression</h3>
<!--l. 338--><p class="noindent" >The state of the system is represented in Kappa as a sited graph: a graph were edges speciï¬es a
site of the node they use. You must think as sites as resources. At most one edge of the graph can
use a site of a node (representing an agent in our case). We call this concept the <span 
class="ecti-1095">rigidity of</span>
<span 
class="ecti-1095">Kappa</span>.
<!--l. 344--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.3.1   </span> <a 
 id="x1-180003.3.1"></a>Graph syntax</h4>
<!--l. 345--><p class="noindent" >The ascii syntax we use to represent sited graphs follows the skeletons (describe formaly in
ï¬gÂ <a 
href="#x1-200022">3.2<!--tex4ht:ref: tab:patterns --></a>):
                                                                                  

                                                                                  
     <ul class="itemize1">
     <li class="itemize">we write the type of the agent and then its interface (the comma separeted list of the
     state of its sites) between parenthesis.
     </li>
     <li class="itemize">When the site is <span 
class="ecti-1095">free </span>(is not a member of a edge) you just write its name to represent
     its state. If it has a internal state, you write it after a &#x2019;~&#x2019;. For example, the graph
     TODO is written A(x,y~p,z~0)
     </li>
     <li class="itemize">When a site is part of an edge, you assign an arbitrary positive integer identiï¬er
     <!--l. 355--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>
     to this edge and you specify the appartenance of the site to this edge by writing
     site_name<!--l. 356--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-punc">!</mo><mi 
>n</mi></math>.
     The graph TODO can be reprensented as A(x!23,y~u!4,z~1), A(x!4,y~u!95,z~1), A(x!95,y~u!23,z~1).
     <!--l. 361--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-190003.3.1"></a><span 
class="ecbx-1095">Remark</span></span>
     Each link identiï¬er appears exactly twice of course. this is a consequence of the regidity of
     Kappa.</li></ul>
<!--l. 365--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.3.2   </span> <a 
 id="x1-200003.3.2"></a>Pattern syntax</h4>
<!--l. 366--><p class="noindent" >Kappa strength is to describe transformations by only mentionning (and storing) the relevant
part of the subgraph required for that transfor;ation to be possible. It plays a key role in resisting
combinatorial explosion when writing models. We use the <span 
class="ecti-1095">don&#x2019;t care, don&#x2019;t write </span>(DCDW)<a 
 id="dx1-20001"></a>
principle. If a transformation occurs independently of the state of a site of an agent, don&#x2019;t
mention it in the <span 
class="ecti-1095">pattern </span>to match. The pattern A(x,z) represents an agent of type A whose sites
x and z are free but the sites y and z can be in any internal state and the site y can be linked or
not to anything.
<!--l. 377--><p class="noindent" >If the link state of a site does not matter but the internal state does, an &#x2019;?&#x2019; has to be added after
the site name (and internal state). An agent A whose sites x and z are free, y is in state u and z
in state 2 is written A(x,y~u?,z~2).
<div class="table">
                                                                                  

                                                                                  
<!--l. 382--><p class="noindent" ><a 
 id="x1-200022"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.2: </span><span  
class="content">Kappa expressions</span></div><!--tex4ht:label?: x1-200022 -->
<div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"><col 
id="TBL-3-2"><col 
id="TBL-3-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-1-1"  
class="td01"><span 
class="ecti-1095">kappa_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-3-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-1-3"  
class="td10"> <span 
class="ecti-1095">agent_expression </span><span id="textcolor7"><span 
class="ectt-1095">,</span></span> <span 
class="ecti-1095">kappa_expression </span><!--l. 386--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo><mi 
>ğœ€</mi></math>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-2-1"  
class="td01"><span 
class="ecti-1095">agent_expression   </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-3-2-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-2-3"  
class="td10"> <span id="textcolor8"><span 
class="ectt-1095">Id</span></span><span id="textcolor9"><span 
class="ectt-1095">(</span></span><span 
class="ecti-1095">interface</span><span id="textcolor10"><span 
class="ectt-1095">)</span></span>                                                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-3-1"  
class="td01"><span 
class="ecti-1095">interface              </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-3-3-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-3-3"  
class="td10"> <span id="textcolor11"><span 
class="ectt-1095">Id</span></span> <span 
class="ecti-1095">internal_state link_state </span><span id="textcolor12"><span 
class="ectt-1095">,</span></span> <span 
class="ecti-1095">interface </span><!--l. 388--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo><mi 
>ğœ€</mi></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-4-1"  
class="td01"><span 
class="ecti-1095">internal_state       </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-3-4-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-4-3"  
class="td10"> <!--l. 389--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœ€</mi></math> | <span id="textcolor13"><span 
class="ectt-1095">~Id</span></span>                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-5-1"  
class="td01"><span 
class="ecti-1095">link_state            </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-3-5-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-5-3"  
class="td10"> <!--l. 390--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœ€</mi></math> | <span id="textcolor14"><span 
class="ectt-1095">!n</span></span> | <span id="textcolor15"><span 
class="ectt-1095">!_</span></span> | <span id="textcolor16"><span 
class="ectt-1095">?</span></span> | <span id="textcolor17"><span 
class="ectt-1095">!Id.Id</span></span>                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-6-1"  
class="td01">                 </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h4 class="subsectionHead"><span class="titlemark">3.3.3   </span> <a 
 id="x1-210003.3.3"></a>Link type</h4>
<!--l. 397--><p class="noindent" >In standard kappa, in order to require a site to be bound for an interaction to occur, one may use
the <span 
class="ecti-1095">semi-link</span><a 
 id="dx1-21001"></a> construct <span 
class="ectt-1095">!_ </span>which does not specify who the partner of the bond is. For instance
in the variable: <span class="lstinline"><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">\</span><span 
class="ectt-1095">var</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">ab</span><span 
class="ectt-1095">}</span><span 
class="ectt-1095">~</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y!_</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span></span> will count the number of <span 
class="ectt-1095">A</span>s and
<span 
class="ectt-1095">B</span>s connected to someone, including the limit case <span 
class="ectt-1095">A(x!1),B(y!1)</span>. It is sometimes
convenient to specify the <span 
class="ecti-1095">type</span><a 
 id="dx1-21002"></a> of the semi-link, in order to restrict the choice of the
binding partner. For instance the variable: <span class="lstinline"><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">\</span><span 
class="ectt-1095">var</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">ab</span><span 
class="ectt-1095">}</span><span 
class="ectt-1095">~</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!y</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y!x</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">!</span></span> will
count the number of <span 
class="ectt-1095">A</span>s whose site <span 
class="ectt-1095">x </span>is connected to a site <span 
class="ectt-1095">y </span>of <span 
class="ectt-1095">B</span>, plus the number
of <span 
class="ectt-1095">B</span>s whose site <span 
class="ectt-1095">y </span>is connected to a site <span 
class="ectt-1095">x </span>of <span 
class="ectt-1095">A</span>. Note that this still includes the case
<span 
class="ectt-1095">A(x!1),B(y!1)</span>.
<!--l. 414--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-220003.3.3"></a><span 
class="ecbx-1095">Remark</span></span>
Transformations on semi-links and links type induce side eï¬€ects (eï¬€ect on unmention
agents/unmentionned site of agent) and can even don&#x2019;t make sense at all. What would mean to
remove the link to A but not the link to B in the example above? Be carefull when you use
them.
<!--l. 420--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-230003.4"></a>Rules</h3>
<!--l. 422--><p class="noindent" >Once agents are declared, one may add to the KF<a 
 id="dx1-23001"></a> the rules<a 
 id="dx1-23002"></a> that describe their dynamics.
<!--l. 425--><p class="noindent" >There are 2 ways of speciï¬ng rules:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-23004x1">by giving two <span 
class="ecti-1095">kappa_expression</span>s. The ï¬rst one, called <span 
class="ecti-1095">left hand side</span><a 
 id="dx1-23005"></a> (LHS), represents
     what you need to apply the rule. The second, the <span 
class="ecti-1095">right hand side</span><a 
 id="dx1-23006"></a> (RHS), describes
     what you obtain once the rule is applied. In Kappa, the 2 are separeted by a <!--l. 432--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo></math>
     following the chemical intuition this notation comes from.
                                                                                  

                                                                                  
     </li>
     <li 
  class="enumerate" id="x1-23008x2">by giving one <span 
class="ecti-1095">kappa_expression </span>with edition. The kappa expression still represents the
     necessary context for the rule to apply but modiï¬cations are speciï¬ed locally inside
     the expression.</li></ol>
<!--l. 438--><p class="noindent" >Both are allowed in kappa and are described in the 2 next subsections.
<!--l. 440--><p class="noindent" >In any case, rule speciï¬cation is optionnaly preï¬xed by a rule name (written between <span 
class="tcrm-1095">'</span>) and
always followed by a rule rate. Rate expressions (which include algebraic expressions<a 
 id="dx1-23009"></a>) are given by
the grammars TableÂ <a 
href="#x1-310295">3.5<!--tex4ht:ref: tab:rates --></a> and TableÂ <a 
href="#x1-320036">3.6<!--tex4ht:ref: tab:alg --></a> (respectively) but can be thought of for now as positive
real numbers.
<!--l. 447--><p class="noindent" >A complete rule in the ï¬rst representation looks like:
     <ul class="itemize1">
     <li class="itemize"><span 
class="tctt-1095">'</span><span 
class="ectt-1095">rule name</span><span 
class="tctt-1095">' </span><span 
class="ecti-1095">kappa_expression </span><!--l. 452--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo></math>
     <span 
class="ecti-1095">kappa_expression </span><span 
class="ectt-1095">@ </span><span 
class="ecti-1095">rate</span></li></ul>
<!--l. 454--><p class="noindent" >One may also declare a <span 
class="ecti-1095">bi-directional rule</span><a 
 id="dx1-23010"></a> using the convention:
     <ul class="itemize1">
     <li class="itemize"><span 
class="tctt-1095">'</span><span 
class="ectt-1095">bi-rule</span><span 
class="tctt-1095">' </span><span 
class="ecti-1095">kappa_expression </span><!--l. 459--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†”</mo></math>
     <span 
class="ecti-1095">kappa_expression </span><span 
class="ectt-1095">@ </span><span 
class="ecti-1095">rate</span><!--l. 459--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
></mrow><mrow 
><mo 
class="MathClass-bin">+</mo></mrow></msup 
></math><span 
class="ecti-1095">,rate</span><!--l. 459--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo></mrow></msup 
></math></li></ul>
<!--l. 461--><p class="noindent" >The above declaration<a 
 id="dx1-23011"></a> is equivalent to writing, in addition of <span 
class="tctt-1095">'</span><span 
class="ectt-1095">my-rule</span><span 
class="tctt-1095">'</span>, another
rule named <span 
class="tctt-1095">'</span><span 
class="ectt-1095">my rule_op</span><span 
class="tctt-1095">' </span>which swaps left and right hand sides, and has rate
<span 
class="ecti-1095">rate</span><!--l. 464--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo></mrow></msup 
></math>.
<!--l. 466--><p class="noindent" >It is possible to mix agents and tokens in <span 
class="ecti-1095">hybrid rules</span><a 
 id="dx1-23012"></a> (which may also be bi-directional). A
hybrid rule has the following form:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ecti-1095">kappa_expression </span>| <span 
class="ecti-1095">token_expression </span><!--l. 472--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo></math>
     <span 
class="ecti-1095">kappa_expression </span>| <span 
class="ecti-1095">token_expression </span><span 
class="ectt-1095">@ </span><span 
class="ecti-1095">rate</span></li></ul>
<!--l. 474--><p class="noindent" >Token expressions are also given by the grammar in TableÂ <a 
href="#x1-230133">3.3<!--tex4ht:ref: tab:tokens --></a>. <div class="table">
                                                                                  

                                                                                  
<!--l. 477--><p class="noindent" ><a 
 id="x1-230133"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.3: </span><span  
class="content">Token expressions</span></div><!--tex4ht:label?: x1-230133 -->
<div class="tabular"> <table id="TBL-4" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1"><col 
id="TBL-4-2"><col 
id="TBL-4-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-1"  
class="td01"><span 
class="ecti-1095">token_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-3"  
class="td10"> <span 
class="ecti-1095">algebraic_expression</span><span id="textcolor18"><span 
class="ectt-1095">:</span></span><span 
class="ecti-1095">token_name      </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-1"  
class="td01">                </td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-2-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-3"  
class="td10"> | <span 
class="ecti-1095">token_expression </span><span id="textcolor19"><span 
class="ectt-1095">+</span></span>Â <span 
class="ecti-1095">token_expression</span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-1"  
class="td01">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-1"  
class="td01"><span 
class="ecti-1095">token_name         </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-4-4-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-3"  
class="td10"> <span id="textcolor20"><span 
class="ectt-1095">Id</span></span>                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-1"  
class="td01">                </td></tr></table></div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h4 class="subsectionHead"><span class="titlemark">3.4.1   </span> <a 
 id="x1-240003.4.1"></a>Chemical notation rules</h4>
<a 
 id="dx1-24001"></a>
<!--l. 490--><p class="noindent" >This is the more intuitive representation. Never the less, as the second paragraph will explain, it
is error prone. It also induce duplication of the unmodiï¬ed context between LHS and RHS which
can lead to even more errors when edition a posteriori on the left are not correctly reported on
the right.
<!--l. 496--><p class="noindent" >
<h5 class="likesubsubsectionHead"><a 
 id="x1-250003.4.1"></a>A simple rule</h5>
<!--l. 497--><p class="noindent" >With the signature<a 
 id="dx1-25001"></a> of <span 
class="ectt-1095">A </span>deï¬ned in the previous section, the line <!--l. 499-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-25002r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">dimerization</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 502--><p class="noindent" >declares a dimerization rule between two instances of agent <span 
class="ectt-1095">A </span>provided the second is
phosphorylated (say that is here the meaning of <span 
class="ectt-1095">p</span>) on site <span 
class="ectt-1095">y</span>).
<!--l. 506--><p class="noindent" >Remember that the identiï¬er <span 
class="ectt-1095">!1 </span>of the bound is arbitrary and that following (DCDW)<a 
 id="dx1-25003"></a>, the site <span 
class="ectt-1095">z</span>
of <span 
class="ectt-1095">A </span>is not mentioned in the expression because it has no inï¬‚uence on the triggering of this
rule.
<!--l. 511--><p class="noindent" >
<h5 class="likesubsubsectionHead"><a 
 id="x1-260003.4.1"></a>Degradation and synthesis</h5>
<!--l. 512--><p class="noindent" >In the right hand side of a rule, the k-th agent is supposed to correspond to the (transformed)
k-th agent of the left hand side. If you put more agent on the left, supernumerary agents are
deleted. If you put more on the right, agents are created.
<!--l. 517--><p class="noindent" >Sticking with <span 
class="ectt-1095">A</span>&#x2019;s signature<a 
 id="dx1-26001"></a>, one can express that an unphosphoralated <span 
class="ectt-1095">A </span>can collapse if not linked
to anyone (regardless of the state of z) by writing <!--l. 520-->
                                                                                  

                                                                                  
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-26002r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">destroy</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,y~u,z</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 524--><p class="noindent" >Similarly, the rule <!--l. 525-->
<div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-26003r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">building</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 528--><p class="noindent" >indicates that an agent <span 
class="ectt-1095">A </span>free on site <span 
class="ectt-1095">z</span>, no matter what its internal state is, may beget a new
copy of <span 
class="ectt-1095">A </span>bound to it via site <span 
class="ectt-1095">x</span>.
<!--l. 532--><p class="noindent" >Note that in the RHS, the interface of the new copy is not completely described. Following the
DCDW convention<a 
 id="dx1-26004"></a>, <span 
class="ecss-1095">KaSim</span>Â will then assume that the sites that are not mentioned
are created in the <span 
class="ecti-1095">default state</span><a 
 id="dx1-26005"></a>, ie they appear free of any bond and their internal
state (if any) is the ï¬rst of the list shown in the signature<a 
 id="dx1-26006"></a> (here state <span 
class="ectt-1095">u </span>for <span 
class="ectt-1095">y </span>and <span 
class="ectt-1095">0 </span>for
<span 
class="ectt-1095">z</span>).
<!--l. 540--><p class="noindent" >Determining which agents are kept (potentially transformed), which are deleted, which are
created is in fact a bit tricky. <span 
class="ecss-1095">KaSim</span>Â respects the <span 
class="ecti-1095">longest preï¬x convention</span><a 
 id="dx1-26007"></a> to determine which
agent in the RHS stems from an agent in the LHS. In a word, from a rule of the form
<!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">â€¦</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
> <mo 
class="MathClass-rel">â†’</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">â€¦</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
></math>, with
<!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>s and
<!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math>s being agents, one
computes the largest <!--l. 546--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi> <mo 
class="MathClass-rel">â‰¤</mo> <mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></math>
such that the agents <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">â€¦</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> are
pairwise consistent with <!--l. 547--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-op">â€¦</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>,
ie the <!--l. 548--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math>s
and <!--l. 548--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math>s
have the same name and the same sites. In which case we say that for all
<!--l. 549--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi> <mo 
class="MathClass-rel">â‰¤</mo> <mi 
>i</mi></math>,
<!--l. 549--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math> is <span 
class="ecti-1095">preserved </span>by the
transition and for all <!--l. 550--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>i</mi></math>,
<!--l. 550--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math> is <span 
class="ecti-1095">deleted </span>by the
transition and <!--l. 551--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math>
is <span 
class="ecti-1095">created </span>by the transition.
<!--l. 553--><p class="noindent" >This convention makes <!--l. 554-->
<div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-26008r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">deleting</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
                                                                                  

                                                                                  
</div>
<!--l. 557--><p class="noindent" >and <!--l. 558-->
<div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-26009r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">weird</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 561--><p class="noindent" >extremely diï¬€erent.
<!--l. 563--><p class="noindent" >The ï¬rst one removes the <span 
class="ectt-1095">A </span>agent in the mixture<a 
 id="dx1-26010"></a> that will match the second occurrence of <span 
class="ectt-1095">A </span>in
the rule (the one that used to be linked on <span 
class="ectt-1095">z</span>) and it leaves the other sites than <span 
class="ectt-1095">x </span>of the ï¬rst <span 
class="ectt-1095">A</span>
untouched. The second one will delete both <span 
class="ectt-1095">A</span>s and create a fresh new <span 
class="ectt-1095">A </span>with all its site free.
Side-eï¬€ects (explained right below) are dramatically diï¬€erent.
<!--l. 570--><p class="noindent" >
<h5 class="likesubsubsectionHead"><a 
 id="x1-270003.4.1"></a>Side eï¬€ects</h5>
<!--l. 572--><p class="noindent" >It may happen that the application of a rule has some <span 
class="ecti-1095">side eï¬€ects</span><a 
 id="dx1-27001"></a> on agents that are not
mentioned explicitly in the rule. Consider for instance the previous rule: <!--l. 575-->
<div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-27002r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">deleting</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 578--><p class="noindent" >The <span 
class="ectt-1095">A </span>in the graph that is matched to the second occurrence of <span 
class="ectt-1095">A </span>in the LHS will be deleted by
the rule. As a consequence all its sites will disappear together with the bonds that were pointing
to them. For instance, when applied to the graph
     <ul class="itemize1">
     <li class="itemize"><!--l. 583--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo></math><span 
class="ectt-1095">A(x!1,y~p,z~2),A(x!2,y~u,z~0!1),C(t!2)</span></li></ul>
<!--l. 583--><p class="noindent" >the above rule will result in a new graph <!--l. 584--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>G</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext class="texttt" mathvariant="monospace" >A(x!1,y~p,z~2),C(t)</mtext></mstyle></math>
where the site <span 
class="ectt-1095">t </span>of <span 
class="ectt-1095">C </span>is now free as side eï¬€ect.
<!--l. 587--><p class="noindent" ><span 
class="ecti-1095">Wildcard </span>symbols for link state <span 
class="ectt-1095">? </span>(for bound or not), <span 
class="ectt-1095">!_ </span>(for bound to someone), may also induce
side eï¬€ects when they are not preserved in the RHS of a rule, as in <!--l. 590-->
<div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-27003r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Disconnect</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
                                                                                  

                                                                                  
</div>
<!--l. 593--><p class="noindent" >or <!--l. 594-->
<div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-27004r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Force</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">bind</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">?)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">t</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">t!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 598--><p class="noindent" >Both these rule will cause <span 
class="ecss-1095">KaSim</span>Â to raise a warning at rule compilation time.
<!--l. 600--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.4.2   </span> <a 
 id="x1-280003.4.2"></a>Edit notation rules</h4>
<a 
 id="dx1-28001"></a>
<!--l. 602--><p class="noindent" >Near any modiï¬ed element, modiï¬cation is speciï¬ed. Created agents are preï¬xed by a
<!--l. 603--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">+</mo></math>. Degraded agents
are preï¬xed by a <!--l. 603--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ’</mo></math>.
Site modiï¬cation are described by writing the new (linking or internal) state after a
<!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ•</mo></math>. Therefore,
<!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ•</mo></math> alone means that the site
becomes free, <!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ•</mo><mo 
class="MathClass-punc">!</mo><mn>9</mn></math> means that the
site becomes part of link <!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>9</mn></math> and
<!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-bin">âˆ•</mo><mi 
>Ëœ</mi><mi 
>z</mi><mi 
>z</mi><mi 
>z</mi></math> means that the new internal
state of the site is <!--l. 607--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>z</mi><mi 
>z</mi><mi 
>z</mi></math>.
<!--l. 609--><p class="noindent" >Here are all the rules mentionned above (+1 extra) translated in this unambiguous notation:
<!--l. 611-->
<div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-28002r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">dimerization</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x/!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p/!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28003r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">destroy</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,y~u,z</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28004r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">building</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z/!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28005r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">deleting</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28006r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">weird</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">z!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28007r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Disconnect</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28008r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Force</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">bind</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">?</span><span 
class="ectt-1095">/!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">t/!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">gamma</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-28009r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">phos</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u/~p!1/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">modrate</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 622--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.4.3   </span> <a 
 id="x1-290003.4.3"></a>Hybrid rules</h4>
<!--l. 624--><p class="noindent" >Using Kappa <span 
class="ecti-1095">hybrid rules</span><a 
 id="dx1-29001"></a>, one may declare that an action has eï¬€ects on the concentration of
some particles of the system. For instance a rule may consume atp, calcium ions etc. It would be
                                                                                  

                                                                                  
a waste of memory and time to use discrete agents to represent such particles. Instead one may
declare tokens using declarations<a 
 id="dx1-29002"></a> of the form: <!--l. 630-->
<div class="lstlisting" id="listing-12"><span class="label"><a 
 id="x1-29003r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%token:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">atp</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-29004r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%token:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">adp</span>
</div>
<!--l. 634--><p class="noindent" >One may then use these tokens in conjunction with a classical rule using the hybrid format:
<!--l. 636-->
<div class="lstlisting" id="listing-13"><span class="label"><a 
 id="x1-29005r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">hybrid</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">rule</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">S</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0.2</span><span 
class="ectt-1095">:atp</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">S</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0.1</span><span 
class="ectt-1095">:adp</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 639--><p class="noindent" >When applied, the above rule will consume 0.2 <span 
class="ectt-1095">atp </span>token and produce 0.1 <span 
class="ectt-1095">adp </span>token. Note that as
speciï¬ed by the grammar given TableÂ <a 
href="#x1-230133">3.3<!--tex4ht:ref: tab:tokens --></a>, the number of consumed (and produced) tokens can be
given by a sum of the form:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ecit-1095">lhs </span><span 
class="ectt-1095">| a</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mn>1</mn></mrow></msub 
></math><span 
class="ectt-1095">:t</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
     <span 
class="ectt-1095">+ ... + a</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></math><span 
class="ectt-1095">:t</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></math>
     <!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo></math>
     <span 
class="ecit-1095">rhs </span><span 
class="ectt-1095">| a</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
></mrow><mrow 
><mn>1</mn></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math><span 
class="ectt-1095">:t</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
></mrow><mrow 
><mn>1</mn></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>
     <span 
class="ectt-1095">+ ... + a</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math><span 
class="ectt-1095">:t</span><!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
></mrow><mrow 
><mi 
>k</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>
     <span 
class="ectt-1095">@ r</span></li></ul>
<!--l. 644--><p class="noindent" >where each <!--l. 645--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>
is an arbitrary algebraic expression<a 
 id="dx1-29006"></a> (see TableÂ <a 
href="#x1-320036">3.6<!--tex4ht:ref: tab:alg --></a>) and each
<!--l. 646--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math> is a declared token. In the
above hybrid rule, calling <!--l. 647--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>
the evaluation of <!--l. 648--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> and
<!--l. 648--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>, the concentration of
token <!--l. 648--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> will decrease
from <!--l. 649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> and the
concentration of token <!--l. 649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>
will increase from <!--l. 650--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msubsup 
></math>.
Importantly, the activity<a 
 id="dx1-29007"></a> of a hybrid rule like the above one is still deï¬ned by
<!--l. 652--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="texttt" mathvariant="monospace" >|lhs|*r</mtext></mstyle></math>, where
<!--l. 652--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="texttt" mathvariant="monospace" >|lhs|</mtext></mstyle></math> is the
number of embeddings of the lhs of the rule in the mixture, and does not take into account the
concentration of the tokens it mentions. As we will see in the next section, it is however possible
to make its rate explicitly depend on the concentrations of the tokens using a <span 
class="ecti-1095">variable</span><a 
 id="dx1-29008"></a>
                                                                                  

                                                                                  
rate.
<!--l. 659--><p class="noindent" >Consuming <!--l. 659--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi></math> tokens is strickly
equivalent to produicing <!--l. 659--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">âˆ’</mo> <mi 
>k</mi></math>
tokens. So, all variation in amount of tokens can be written on the right hand side of rules. This is
what you do when you use tokens in edit notation: <!--l. 663-->
<div class="lstlisting" id="listing-14"><span class="label"><a 
 id="x1-29009r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">hybrid</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">rule</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">S</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u/~p!1/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y!1/</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">-0</span><span 
class="ectt-1095">.1)</span><span 
class="ectt-1095">:atp</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 667--><p class="noindent" >Also, speaking only about variation makes clear that the simulator does not check that the
consumed amount of token is available. It consumes it even if the quantity becomes then
negative!
<!--l. 671--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.4.4   </span> <a 
 id="x1-300003.4.4"></a>Rates</h4>
<!--l. 672--><p class="noindent" >As said earlier, Kappa rules are equipped with one or two <span 
class="ecti-1095">kinetic rate(s)</span><a 
 id="dx1-30001"></a>. A
rate is a real number, or an algebraic expression<a 
 id="dx1-30002"></a> evaluated as such, called the
<span 
class="ecti-1095">individual-based or stochastic rate constant</span><a 
 id="dx1-30003"></a>, it is the rate at which the corresponding
rule is applied per instance of the rule. Its dimension is the inverse of a time
<!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msup><mrow 
><mi 
>T</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">]</mo></mrow></math>.
<!--l. 674--><p class="noindent" >The stochastic rate is related to the <span 
class="ecti-1095">concentration-based rate constant</span><a 
 id="dx1-30004"></a>
<!--l. 674--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math> of the
rule of interest by the following relation: <table class="equation"><tr><td> <a 
 id="x1-30005r1"></a>
<!--l. 681--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                  <mi 
>k</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>Î³</mi><msup><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
mathvariant="bold-script">ğ’œ</mi><mspace width="3.0235pt" class="tmspace"/><mi 
>V</mi> </mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mrow 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow></msup 
>
</math></td><td class="eq-no">(3.1)</td></tr></table>
                                                                                  

                                                                                  
<!--l. 684--><p class="noindent" >where <!--l. 685--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math> is the volume where
the model is considered, <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">ğ’œ</mi> <mo 
class="MathClass-rel">=</mo> <mn>6</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn><mn>2</mn><mn>2</mn> <mo 
class="MathClass-bin">â‹…</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>2</mn><mn>3</mn></mrow></msup 
></math>
is Avogadro&#x2019; s number, <!--l. 687--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">â‰¥</mo> <mn>0</mn></math>
is the arity of the rule (ie 2 for a bimolecular rule).
<!--l. 689--><p class="noindent" >In a modeling context, the constant <!--l. 689--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
is typically expressed using <span 
class="ecti-1095">molars </span><!--l. 689--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>M</mi> <mo 
class="MathClass-punc">:</mo><mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="italic"><mi 
>m</mi></mstyle><mi 
>o</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi><mspace width="0.3em" class="thinspace"/><msup><mrow 
><mi 
>l</mi></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>
(or variants thereof such as <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î¼</mi><mi 
>M</mi></math>,
<!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi><mi 
>M</mi></math>),
and seconds or minutes. If we choose molars and seconds,
<!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>&#x2019; s unit
is <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mstyle mathvariant="italic"><mi 
>M</mi></mstyle></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-bin">âˆ’</mo><mi 
>a</mi></mrow></msup 
><msup><mrow 
><mstyle mathvariant="italic"><mi 
>s</mi></mstyle></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>, as
follows from the relation above.
<!--l. 693--><p class="noindent" >Concentration-based rates are usually favored for measurements and/or deterministic models, so
it is useful to know how to convert them into individual-based ones used by KaSim. Here are
typical volumes used in modeling:
     <ul class="itemize1">
     <li class="itemize">Mammalian cell: <!--l. 698--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>2</mn><mn>5</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn><mn>2</mn></mrow></msup 
><mi 
>l</mi></math>
     (<!--l. 698--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>l</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>3</mn></mrow></msup 
><msup><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
></math>),
     and <!--l. 698--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">ğ’œ</mi><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>3</mn><mn>5</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>1</mn><mn>2</mn></mrow></msup 
></math>.
     <!--l. 700--><p class="noindent" >A concentration of <!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>M</mi></math>
     in a mammalian cell volume corresponds to <!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>3</mn><mn>5</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>1</mn><mn>2</mn></mrow></msup 
></math>
     molecules; <!--l. 700--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>n</mi><mi 
>M</mi> <mo 
class="MathClass-rel">â‰ˆ</mo> <mn>1</mn><mn>3</mn><mn>5</mn><mn>0</mn></math>
     molecules per cell.
     </li>
     <li class="itemize">Yeast cell (haploid): <!--l. 703--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn><mn>4</mn></mrow></msup 
><mi 
>l</mi></math>,
     and <!--l. 703--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">ğ’œ</mi><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>4</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>1</mn><mn>0</mn></mrow></msup 
></math>.
     <!--l. 705--><p class="noindent" >A concentration of <!--l. 705--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>M</mi></math>
     in a yeast cell volume corresponds to <!--l. 705--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mo 
class="MathClass-punc">.</mo><mn>4</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>1</mn><mn>0</mn></mrow></msup 
></math>
     molecules; <!--l. 705--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>n</mi><mi 
>M</mi> <mo 
class="MathClass-rel">â‰ˆ</mo> <mn>2</mn><mn>4</mn></math>
     molecules per cell. The volume is doubled in a diploid cell.
     </li>
     <li class="itemize">E. Coli cell: <!--l. 707--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn><mn>5</mn></mrow></msup 
><mi 
>l</mi></math>,
     and <!--l. 707--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">ğ’œ</mi><mi 
>V</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>8</mn></mrow></msup 
></math>.
     <!--l. 709--><p class="noindent" >A concentration of <!--l. 709--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mi 
>M</mi></math>
     in a yeast cell volume corresponds to <!--l. 709--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>8</mn></mrow></msup 
></math>
     molecules; <!--l. 709--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>0</mn><mi 
>n</mi><mi 
>M</mi> <mo 
class="MathClass-rel">â‰ˆ</mo> <mn>1</mn></math>
     molecule per cell.</li></ul>
                                                                                  

                                                                                  
<!--l. 712--><p class="noindent" >The table below lists typical ranges for deterministic rate constants and their stochastic
counterparts assuming a mammalian cell volume.
<div class="table">
                                                                                  

                                                                                  
<!--l. 715--><p class="noindent" ><a 
 id="x1-300064"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.4: </span><span  
class="content">Example of kinetic rates.</span></div><!--tex4ht:label?: x1-300064 -->
<div class="tabular">
 <table id="TBL-5" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1"><col 
id="TBL-5-2"><col 
id="TBL-5-3"><col 
id="TBL-5-4"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-1-1"  
class="td01">process                   </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-1-2"  
class="td11"> <!--l. 720--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-1-3"  
class="td11"> <!--l. 720--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi></math> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-2-1"  
class="td01">general binding         </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-2-2"  
class="td11"> <!--l. 723--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>7</mn></mrow></msup 
> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>9</mn></mrow></msup 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-2-3"  
class="td11"> <!--l. 723--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>5</mn></mrow></msup 
> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>3</mn></mrow></msup 
></math>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-3-1"  
class="td01">general unbinding      </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-3-2"  
class="td11"> <!--l. 725--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>3</mn></mrow></msup 
> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-3-3"  
class="td11"> <!--l. 725--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>3</mn></mrow></msup 
> <mo 
class="MathClass-bin">âˆ’</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-4-1"  
class="td01">dephosphorylation      </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-4-2"  
class="td11"> 1                                                                                                                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-4-3"  
class="td11"> 1                                                                                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-5-1"  
class="td01">phosphorylation         </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-5-2"  
class="td11"> 0.1                                                                                                                    </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-5-3"  
class="td11"> 0.1                                                                                                                    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-6-1"  
class="td01">receptor dimerization  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-6-2"  
class="td11"> <!--l. 731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>6</mn></mrow></msup 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-6-3"  
class="td11"> <!--l. 731--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>6</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>6</mn></mrow></msup 
></math>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-7-1"  
class="td01">receptor dissociation   </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-7-2"  
class="td11"> <!--l. 733--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>6</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-5-7-3"  
class="td11"> <!--l. 733--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-punc">.</mo><mn>6</mn><mspace width="3.0235pt" class="tmspace"/><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">âˆ’</mo><mn>1</mn></mrow></msup 
></math>  </td>

</tr><tr  
 style="vertical-align:baseline;" id="TBL-5-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-5-8-1"  
class="td01">                   </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h4 class="subsectionHead"><span class="titlemark">3.4.5   </span> <a 
 id="x1-310003.4.5"></a>Ambiguous molecularity</h4>
<!--l. 741--><p class="noindent" >It is considered malpractice to use a Kappa rule of the form
<span 
class="ectt-1095">A(x),B(y)</span><!--l. 741--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo><mo 
class="MathClass-op">â€¦</mo><mspace width="0.3em" class="thinspace"/></math> <span 
class="ectt-1095">@</span>
<!--l. 741--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi></math> in a model
where this rule could be applied in a context where <span 
class="ectt-1095">A </span>and <span 
class="ectt-1095">B </span>are sometimes already connected and
sometimes disconnected. Indeed, this would lead to an inconsistency in the deï¬nition of the kinetic
rate <!--l. 741--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi></math>
which should have a volume dependency in the former case and no volume dependency in the
latter (see SectionÂ <a 
href="#x1-300003.4.4">3.4.4<!--tex4ht:ref: sec:kinetics --></a>).
<!--l. 743--><p class="noindent" >This sort of ambiguity should be resolved, if possible, by reï¬ning the ambiguous
rule into cases that are either exclusively unary or binary. Each reï¬nement having
a kinetic rate that is consistent with its molecularity. Note that in practice, for
models with a large number of agents, it is suï¬ƒcient to assume that the rule
<span 
class="ectt-1095">A(x),B(y)</span><!--l. 743--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo><mo 
class="MathClass-op">â€¦</mo><mspace width="0.3em" class="thinspace"/></math>
<span 
class="ectt-1095">@ </span><!--l. 743--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi></math> will
have only binary instances. In this case it suï¬ƒces to consider the approximate model:
<!--l. 744-->
<div class="lstlisting" id="listing-15"><span class="label"><a 
 id="x1-31001r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">assumed</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">binary</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">AB</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">...</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">ga_2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31002r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">unary</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">AB</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a!1,b!2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y,c!2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">...</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_1</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 749--><p class="noindent" >There are however systems where even enumerating unary cases becomes impossible or the
approximation on binary instances is wrong. As an alternative, one should use the kappa notation
for ambiguous rules:
     <ul class="itemize1">
     <li class="itemize"><span 
class="tctt-1095">'</span><span 
class="ectt-1095">my rule</span><span 
class="tctt-1095">' </span><span 
class="ecti-1095">kappa_expression </span><!--l. 754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">â†’</mo></math>
     <span 
class="ecti-1095">kappa_expression </span><span 
class="ectt-1095">@</span><!--l. 754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>Î³</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>k</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math></li></ul>
<!--l. 755--><p class="noindent" >which will tell <span 
class="ecss-1095">KaSim</span>Â to apply the above rule with a rate
<!--l. 755--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>Î³</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> for binary instances
and a rate <!--l. 756--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>k</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
for unary instances. The obtained model will behave exactly as a model in which the ambiguous
rule has been replaced by unambiguous reï¬nements. However the usage of such rule <span 
class="ecti-1095">slowdowns</span>
                                                                                  

                                                                                  
<span 
class="ecti-1095">simulation in a signiï¬cant manner </span>depending on various parameters (such as the presence of large
polymers in the model). We give below an example of a model utilizing binary/unary rates for
rules<span class="footnote-mark"><a 
href="Ka2.htm#fn1x4"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-31003f1"></a> .
<!--l. 765--><div class="lstinputlisting">
<a 
 id="x1-31004"></a>
<span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31005r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31006r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31007r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b,a</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31008r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31009r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">V</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31010r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">INF</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31011r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1.0</span><span 
class="ectt-1095">E-4/</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">V</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31012r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_off</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0.1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31013r9"></a><span 
class="ecrm-0600">9</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31014r10"></a><span 
class="ecrm-0600">10</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">}</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31015r11"></a><span 
class="ecrm-0600">11</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">}</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31016r12"></a><span 
class="ecrm-0600">12</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">}</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31017r13"></a><span 
class="ecrm-0600">13</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31018r14"></a><span 
class="ecrm-0600">14</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">..</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b!a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_off</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31019r15"></a><span 
class="ecrm-0600">15</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">..</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_off</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31020r16"></a><span 
class="ecrm-0600">16</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">..</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!b</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_off</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31021r17"></a><span 
class="ecrm-0600">17</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31022r18"></a><span 
class="ecrm-0600">18</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1000</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31023r19"></a><span 
class="ecrm-0600">19</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31024r20"></a><span 
class="ecrm-0600">20</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-31025r21"></a><span 
class="ecrm-0600">21</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">=</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">10000</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$STOP</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">snap</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">dot</span><span 
class="ectt-1095">&#x0022;</span>
</div>
<!--l. 767--><p class="noindent" >Notice at lines 10-12 the use of binary/unary notation for rules. As a result binding between
freely ï¬‚oating agents will occur at rate <span 
class="tctt-1095">'</span><span 
class="ectt-1095">k2</span><span 
class="tctt-1095">' </span>while binding between agents that are
part of the same complex will occur at rate <span 
class="tctt-1095">'</span><span 
class="ectt-1095">k1</span><span 
class="tctt-1095">'</span>. Line 21 contains a <span 
class="ecti-1095">perturbation </span>that
requires <span 
class="ecss-1095">KaSim</span>Â to stop the simulation after 10,000 events and output the list of molecular
species present in the ï¬nal mixture<a 
 id="dx1-31026"></a> as a dot ï¬le (see SectionÂ <a 
href="#x1-440006.1">6.1<!--tex4ht:ref: sec:mod --></a>) and that we give
FigureÂ <a 
href="#x1-310271">3.1<!--tex4ht:ref: fig:species --></a>.
<!--l. 777--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-310271"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 778--><p class="noindent" >

<!--l. 779--><p class="noindent" ><img 
src="generated_img/poly.png" alt="PIC"  
width="426.79134pt" height="121.39952pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 3.1: </span><span  
class="content">Final mixtureobtained after 10,000 events of simulation of the <span 
class="ectt-1095">poly.ka </span>model.
The inï¬nite rate for cycle closure allows one to obtain a large number of triangles.</span></div><!--tex4ht:label?: x1-310271 -->
</div>
                                                                                  

                                                                                  
<!--l. 784--><p class="noindent" ></div><hr class="endfigure">
<!--l. 786--><p class="noindent" >For rules with unary rates, one can also specify an <span 
class="ecti-1095">horizon</span>. For example in the rule
<!--l. 788-->
<div class="lstlisting" id="listing-16"><span class="label"><a 
 id="x1-31028r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">{</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">:5</span><span 
class="ectt-1095">}</span>
</div>
<!--l. 791--><p class="noindent" >the unary rate is applied only when the agents
<!--l. 791--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math> and
<!--l. 791--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math> are at
an horizon <!--l. 792--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math>
(or closer), of each other. Horizon is an algebraic expression but during simulation, it is always
truncated to a positive integer. This feature <span 
class="ecti-1095">can change in the future</span>.
<div class="table">
                                                                                  

                                                                                  
<!--l. 796--><p class="noindent" ><a 
 id="x1-310295"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.5: </span><span  
class="content">Rate expressions</span></div><!--tex4ht:label?: x1-310295 -->
<div class="tabular"> <table id="TBL-6" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1"><col 
id="TBL-6-2"><col 
id="TBL-6-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-1-1"  
class="td01"><span 
class="ecti-1095">rate_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-1-3"  
class="td10"> <span 
class="ecti-1095">algebraic_expression                                                         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-2-1"  
class="td01">               </td><td  style="text-align:center; white-space:nowrap;" id="TBL-6-2-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-2-3"  
class="td10"> | <span 
class="ecti-1095">algebraic_expression </span><span id="textcolor21"><span 
class="ectt-1095">{</span></span><span 
class="ecti-1095">algebraic_expression</span>:<span 
class="ecti-1095">algebraic_expression</span><span id="textcolor22"><span 
class="ectt-1095">}</span></span></td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h3 class="sectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-320003.5"></a>Variables</h3>
<!--l. 808--><p class="noindent" >In the KF<a 
 id="dx1-32001"></a> it is also possible to declare <span 
class="ecti-1095">variables</span><a 
 id="dx1-32002"></a> with the declaration:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%var: </span><span 
class="tctt-1095">'</span><span 
class="ectt-1095">var_name</span><span 
class="tctt-1095">'</span><span 
class="ectt-1095">Â  </span>(<span 
class="ecti-1095">algebraic_expression</span>)</li></ul>
<!--l. 812--><p class="noindent" >where <span 
class="ectt-1095">var_name </span>can be any string and <span 
class="ecti-1095">algebraic_expression </span>are deï¬ned TableÂ <a 
href="#x1-320036">3.6<!--tex4ht:ref: tab:alg --></a> (available
symbols for variable, constants and operators are given TableÂ <a 
href="#x1-320047">3.7<!--tex4ht:ref: tab:operators --></a>).
<div class="table">
                                                                                  

                                                                                  
<!--l. 815--><p class="noindent" ><a 
 id="x1-320036"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.6: </span><span  
class="content">Algebraic expressions</span></div><!--tex4ht:label?: x1-320036 -->
<div class="tabular"> <table id="TBL-7" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1"><col 
id="TBL-7-2"><col 
id="TBL-7-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-1-1"  
class="td01"><span 
class="ecti-1095">algebraic_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-7-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-1-3"  
class="td10"> <span id="textcolor23"><!--l. 819--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>â„</mi></math></span> <!--l. 819--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo></math> <span id="textcolor24"><span 
class="ectt-1095">variable</span></span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-2-1"  
class="td01">                   </td><td  style="text-align:center; white-space:nowrap;" id="TBL-7-2-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-2-3"  
class="td10"> <!--l. 820--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo></math> <span 
class="ecti-1095">algebraic_expression </span><span id="textcolor25"><span 
class="ectt-1095">binary_op</span></span> <span 
class="ecti-1095">algebraic_expression                                                          </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-3-1"  
class="td01">                   </td><td  style="text-align:center; white-space:nowrap;" id="TBL-7-3-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-3-3"  
class="td10"> <!--l. 821--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo></math> <span id="textcolor26"><span 
class="ectt-1095">unary_op</span></span> <span id="textcolor27"><span 
class="ectt-1095">(</span></span><span 
class="ecti-1095">algebraic_expression</span><span id="textcolor28"><span 
class="ectt-1095">)</span></span>                                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-4-1"  
class="td01">                   </td><td  style="text-align:center; white-space:nowrap;" id="TBL-7-4-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-4-3"  
class="td10"> <!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">âˆ£</mo></math> <span 
class="ecti-1095">boolean_expression </span><span 
class="ectt-1095">[?] </span><span 
class="ecti-1095">algebraic_expression </span><span 
class="ectt-1095">[:] </span><span 
class="ecti-1095">algebraic_expression                                     </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-5-1"  
class="td01">                   </td></tr></table>
</div> Last item of the list is an if-expression. <span 
class="ecti-1095">boolean_expression </span>are described in TableÂ <a 
href="#x1-440091">6.1<!--tex4ht:ref: tab:pert --></a>. Think
very carefully whether it is the correct think to do before using it. Mecanistic conditions have to
be expressed in rule bodies not in rule rates!
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<div class="table">
                                                                                  

                                                                                  
<!--l. 834--><p class="noindent" ><a 
 id="x1-320047"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 3.7: </span><span  
class="content">Symbol usable in algebraic expressions</span></div><!--tex4ht:label?: x1-320047 -->
<div class="tabular">
 <table id="TBL-8" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-8-1g"><col 
id="TBL-8-1"></colgroup><colgroup id="TBL-8-2g"><col 
id="TBL-8-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-8-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-1-1"  
class="td01"><span id="textcolor29"><span 
class="ectt-1095">variable</span></span>                                                                      </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-1-2"  
class="td10"> Interpretation                                                                                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-2-1"  
class="td01"><span 
class="ectt-1095">[E]                                                                            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-2-2"  
class="td10"> the total number of (productive) simulation events<a 
 id="dx1-32005"></a>                                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-3-1"  
class="td01">                                                                               </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-3-2"  
class="td10"> since the beginning of the simulation                                                                                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-4-1"  
class="td01"><span 
class="ectt-1095">[E-]                                                                           </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-4-2"  
class="td10"> the total number of null events<a 
 id="dx1-32006"></a>                                                                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-5-1"  
class="td01"><span 
class="ectt-1095">[Emax]                                                                         </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-5-2"  
class="td10"> the max (productive) event limit as set by <span 
class="ectt-1095">-l </span>(in <span 
class="ectt-1095">-u event </span>mode).                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-6-1"  
class="td01">                                                                               </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-6-2"  
class="td10"> Note that if unset <span 
class="ectt-1095">Emax</span><!--l. 845--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo> <mi 
>âˆ</mi></math></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-8-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-7-1"  
class="td01"><span 
class="ectt-1095">[T] </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-7-2"  
class="td10"> the bio-time of the simulation</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-8-1"  
class="td01"><span 
class="ectt-1095">[Tsim]                                                                         </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-8-2"  
class="td10"> the cpu-time since the beginning of the simulation                                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-9-1"  
class="td01"><span 
class="ectt-1095">[Tmax]                                                                         </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-9-2"  
class="td10"> the max (bio)-time limit as set by the option <span 
class="ectt-1095">-l</span>.                                                                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-10-1"  
class="td01">                                                                               </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-10-2"  
class="td10"> Note that if unset <span 
class="ectt-1095">Tmax</span><!--l. 848--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">=</mo> <mi 
>âˆ</mi></math></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-8-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-11-1"  
class="td01"><span 
class="ectt-1095">[pp] </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-11-2"  
class="td10"> the number of requested plotting interval set by the option <span 
class="ectt-1095">-p</span>.</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-12-1"  
class="td01"><span 
class="tctt-1095">'</span><span 
class="ectt-1095">v</span><span 
class="tctt-1095">'                                                                            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-12-2"  
class="td10"> the value of variable <span 
class="tctt-1095">'</span><span 
class="ectt-1095">v</span><span 
class="tctt-1095">' </span>(declared using the <span 
class="ectt-1095">%var: </span>statement)                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-13-1"  
class="td01"><span 
class="ectt-1095">|t|                                                                            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-13-2"  
class="td10"> the concentration of token <span 
class="ectt-1095">t                                                                        </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-14-1"  
class="td01"><span 
class="ectt-1095">|</span><span 
class="ecit-1095">kappa_expression</span><span 
class="ectt-1095">|                                                             </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-14-2"  
class="td10"> number of occurences of the pattern <span 
class="ecti-1095">kappa_expression                                                                         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-15-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-15-1"  
class="td01"><span 
class="ectt-1095">inf                                                                            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-15-2"  
class="td10"> symbol for <!--l. 854--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>âˆ</mi></math>       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-16-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-16-1"  
class="td01">                                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-17-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-17-1"  
class="td01"><span id="textcolor30"><span 
class="ectt-1095">unary/binary_op</span></span>                                                                </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-17-2"  
class="td10"> Interpretation                                                                                                                                   </td>

</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-18-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-18-1"  
class="td01"><span 
class="ectt-1095">[</span><!--l. 858--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi></math><span 
class="ectt-1095">] </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-18-2"  
class="td10"> usual mathematical functions and constants                                                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-19-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-19-1"  
class="td01">                                                                               </td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-19-2"  
class="td10"> with <!--l. 858--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi> <mo 
class="MathClass-rel">âˆˆ</mo><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>l</mi><mi 
>o</mi><mi 
>g</mi><mi 
>,</mi><mi 
>e</mi><mi 
>x</mi><mi 
>p</mi><mi 
>,</mi><mi 
>s</mi><mi 
>i</mi><mi 
>n</mi><mi 
>,</mi><mi 
>c</mi><mi 
>o</mi><mi 
>s</mi><mi 
>,</mi><mi 
>t</mi><mi 
>a</mi><mi 
>n</mi><mi 
>,</mi><mi 
>s</mi><mi 
>q</mi><mi 
>r</mi><mi 
>t</mi><mi 
>,</mi><mi 
>p</mi><mi 
>i</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-20-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-20-1"  
class="td01"><span 
class="ectt-1095">[int]                                                                          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-20-2"  
class="td10"> the ï¬‚oor function <!--l. 859--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>â„</mi><mo 
class="MathClass-rel">â†¦</mo><mrow ><mo 
class="MathClass-open">âŒŠ</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">âŒ‹</mo></mrow><mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>â„¤</mi></math>        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-21-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-21-1"  
class="td01"><span 
class="ectt-1095">+,-,*,/,^                                                                      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-21-2"  
class="td10"> basic mathematical operators (inï¬x notation)                                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-22-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-22-1"  
class="td01"><span 
class="ectt-1095">[mod]                                                                          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-22-2"  
class="td10"> the <span 
class="ecti-1095">modulo </span>operator (inï¬x notation)                                                                                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-23-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-23-1"  
class="td01"><span 
class="ectt-1095">[max]                                                                          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-23-2"  
class="td10"> the <span 
class="ecti-1095">maximum </span>of two values                                                                                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-24-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-24-1"  
class="td01"><span 
class="ectt-1095">[min]                                                                          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-8-24-2"  
class="td10"> the <span 
class="ecti-1095">minimum </span>of two values                                                                                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-8-25-"><td  style="text-align:left; white-space:nowrap;" id="TBL-8-25-1"  
class="td01">                                                                               </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<!--l. 871--><p class="noindent" >For instance the declaration<a 
 id="dx1-32007"></a>s <!--l. 872-->
<div class="lstlisting" id="listing-17"><span class="label"><a 
 id="x1-32008r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">homodimer</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-32009r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">aa</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">homodimer</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">/2</span>
</div>
<!--l. 876--><p class="noindent" >deï¬ne 2 variables, the ï¬rst one tracking the number of embeddings of <span 
class="ectt-1095">A(x!1),A(x!1) </span>in the
graph over time, while the second divides this value by 2: the number of automorphisms in
<span 
class="ectt-1095">A(x!1),A(x!1)</span>. Note that variables that are used in the expression of another variable must be
declared beforehand.
<!--l. 878--><p class="noindent" >It is also possible to use algebraic expressions<a 
 id="dx1-32010"></a> as kinetic rates<a 
 id="dx1-32011"></a> as in <!--l. 879-->
<div class="lstlisting" id="listing-18"><span class="label"><a 
 id="x1-32012r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_on</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1.0</span><span 
class="ectt-1095">E-6</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">molecule</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">second</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-32013r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">ab</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_on</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">/2</span>
</div>
<!--l. 884--><p class="noindent" ><span 
class="ecss-1095">KaSim</span>Â may output values of variables in the data ï¬le<a 
 id="dx1-32014"></a> (see option <span 
class="ectt-1095">-p </span>in ChapterÂ <a 
href="#x1-340004">4<!--tex4ht:ref: chap:cl --></a>) using plot do:
<!--l. 885-->
<div class="lstlisting" id="listing-19"><span class="label"><a 
 id="x1-32015r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%plot:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">var_name</span><span 
class="ectt-1095">&#x2019;</span>
</div>
<!--l. 888--><p class="noindent" >One may use the shortcut:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%obs: </span><span 
class="tctt-1095">'</span><span 
class="ectt-1095">var_name</span><span 
class="tctt-1095">'  </span><span 
class="ecti-1095">algebraic_expression</span></li></ul>
<!--l. 891--><p class="noindent" >to declare a variable and at the same time require it to be outputted in the data ï¬le<a 
 id="dx1-32016"></a>.
<h3 class="sectionHead"><span class="titlemark">3.6   </span> <a 
 id="x1-330003.6"></a>Initial conditions</h3>
<a 
 id="dx1-33001"></a>
<!--l. 895--><p class="noindent" >The initial mixture<a 
 id="dx1-33002"></a> to which rules in the KF<a 
 id="dx1-33003"></a> will be applied are declared as
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%init:  </span><span 
class="ecti-1095">algebraic_expression kappa_expression</span></li></ul>
                                                                                  

                                                                                  
<!--l. 899--><p class="noindent" >or
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%init:  </span><span 
class="ecti-1095">token_name </span><span 
class="ectt-1095">&#x003C;- </span><span 
class="ecti-1095">algebraic_expression</span></li></ul>
<!--l. 905--><p class="noindent" >where <span 
class="ecti-1095">algebraic_expression </span>is evaluated before initialization of the simulation (hence all token
and kappa expression values in the expression are evaluated to 0). This will add to the initial
state of the model <span 
class="ecti-1095">mult </span>copies of the graph described by the kappa expression. Again the
DCDW convention<a 
 id="dx1-33004"></a> allows us not to write the complete interface of added agents (the
remaining sites will be completed according to the agent&#x2019;s signature<a 
 id="dx1-33005"></a>). For instance:
<!--l. 906-->
<div class="lstlisting" id="listing-20"><span class="label"><a 
 id="x1-33006r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1000</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-33007r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-33008r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">ca2</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003C;-</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0.39</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">mM</span>
</div>
<!--l. 911--><p class="noindent" >will add 1000 instances of <span 
class="ectt-1095">A </span>in its default state <span 
class="ectt-1095">A(x,y~u,z~0)</span>, 1000 instances of <span 
class="ectt-1095">A </span>in
state <span 
class="ectt-1095">A(x,y~p,z~0) </span>and a concentration of 0.39 mM of calcium ions. Recall that the
concentration of calcium can be observed during simulation using <span 
class="ectt-1095">|ca2+|</span>. As any other
declaration<a 
 id="dx1-33009"></a>, <span 
class="ectt-1095">%init </span>can be used multiple times, and agents will add up to the initial
state.
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 4</span><br /><a 
 id="x1-340004"></a>The command line</h2>
<h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-350004.1"></a>General usage</h3>
<!--l. 918--><p class="noindent" >From a terminal window, <span 
class="ecss-1095">KaSim</span>Â can be invoked by typing
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim file_1 ... file_n [option] </span></li></ul>
<!--l. 920--><p class="noindent" >where <span 
class="ectt-1095">file_i </span>are the input Kappa ï¬les containing the rules, initial conditions and
observables (see ChapterÂ <a 
href="#x1-140003">3<!--tex4ht:ref: chap:kappa --></a>). A simulation can generate several ï¬les that are described below.
You should really take advantage of the option <span 
class="ectt-1095">-d </span>so that they all ends in a distinct
directory.
<!--l. 927--><p class="noindent" >In any case, a log called <span 
class="ectt-1095">inputs.ka </span>is generated. This is a valid kappa ï¬les such that <span 
class="ectt-1095">KaSim</span>
<span 
class="ectt-1095">inputs.ka </span>reruns exactly the simulation just ran outputing the exact same outputs (using the
same pseudo random numbers!). First line of this ï¬le contains an <span 
class="ectt-1095">uuid </span>that is also present in any
ï¬le output during the same run.
<!--l. 933--><p class="noindent" >TablesÂ <a 
href="#x1-360011">4.1<!--tex4ht:ref: tab:options --></a> and <a 
href="#x1-370012">4.2<!--tex4ht:ref: tab:add-options --></a> summarize all the options that can be given to the simulator.
<!--l. 936--><p class="noindent" >Basically, one can specify an upper bound and a plot period either in simulated or bio-time
(arbitrary time unit), or in number of events. Note that bio-time is computed using Gillespie<span 
class="tcrm-1095">'</span>s
formula for time advance (see Fig.Â <a 
href="#x1-50081">1.1<!--tex4ht:ref: fig:event-loop --></a>) and should not be confused with CPU-time (it<span 
class="tcrm-1095">'</span>s not even
proportional).
<!--l. 947--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-360004.2"></a>Main options</h3>
<!--l. 949--><p class="noindent" >TableÂ <a 
href="#x1-360011">4.1<!--tex4ht:ref: tab:options --></a> summarizes the main options that are accessible through the command line. Options
that expects an argument are preceded by a single dash, options that do not need any argument
start with a double dash.
<!--l. 954--><p class="noindent" >Two key options are the plot period <span 
class="ectt-1095">-p </span>(how often you want a line in the data ï¬le) and the limit
<span 
class="ectt-1095">-l </span>of simulation. These quantities can expressed in simulated time (the default) or in number of
event (using <span 
class="ectt-1095">-u event</span>).
<div class="table">
                                                                                  

                                                                                  
<!--l. 959--><p class="noindent" ><a 
 id="x1-360011"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 4.1: </span><span  
class="content">Command line: main options</span></div><!--tex4ht:label?: x1-360011 -->
<div class="tabular"> <table id="TBL-9" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-9-1g"><col 
id="TBL-9-1"></colgroup><colgroup id="TBL-9-2g"><col 
id="TBL-9-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-1-1"  
class="td11"> Argument                                                                                                                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-1-2"  
class="td11"> Description                                                                                                                                                                                                                                                                                                            </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-2-1"  
class="td11"> <span 
class="ectt-1095">-u </span><!--l. 965--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>u</mi><mi 
>n</mi><mi 
>i</mi><mi 
>t</mi></math>         </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-2-2"  
class="td11"> unit of options (time/event)                                                                                                                                                                                                                                                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-3-1"  
class="td11"> <span 
class="ectt-1095">-l </span><!--l. 966--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>a</mi><mi 
>x</mi></math>         </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-3-2"  
class="td11"> Terminates simulation after <!--l. 966--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>a</mi><mi 
>x</mi> <mo 
class="MathClass-rel">â‰¥</mo> <mn>0</mn></math> <!--l. 966--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>u</mi><mi 
>n</mi><mi 
>i</mi><mi 
>t</mi></math>                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-4-1"  
class="td11"> <span 
class="ectt-1095">-initial </span><!--l. 967--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>i</mi><mi 
>n</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-4-2"  
class="td11"> starts the simulation at <!--l. 967--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>i</mi><mi 
>n</mi></math> <!--l. 967--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>u</mi><mi 
>n</mi><mi 
>i</mi><mi 
>t</mi></math> (data outputs convienience only)  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-5-1"  
class="td11"> <span 
class="ectt-1095">-p </span><!--l. 968--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>         </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-5-2"  
class="td11"> plot a line in the data ï¬le every <!--l. 968--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> <!--l. 968--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>u</mi><mi 
>n</mi><mi 
>i</mi><mi 
>t</mi></math>                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-6-1"  
class="td11"> <span 
class="ectt-1095">-o </span><span 
class="ecti-1095">ï¬le                                                                                                                      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-6-2"  
class="td11"> Set the name of data ï¬le to <span 
class="ecti-1095">ï¬le                                                                                                                                                                                                                                                                </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-7-1"  
class="td11">                                                                                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-7-2"  
class="td11"> Use the extension to determine format (&#x2019;.tsv&#x2019;, &#x2019;.svg&#x2019; or csv else)                                                                                                                                                                                                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-8-1"  
class="td11"> <span 
class="ectt-1095">-i </span><span 
class="ecti-1095">ï¬le                                                                                                                      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-8-2"  
class="td11"> Interpret <span 
class="ecti-1095">ï¬le </span>as an input ï¬lename                                                                                                                                                                                                                                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-9-1"  
class="td11">                                                                                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-9-2"  
class="td11"> (for compatibility with <span 
class="ecss-1095">KaSim</span>&#x003C;= 3 and ï¬lenames starting by -)                                                                                                                                                                                                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-9-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-10-1"  
class="td11"> <span 
class="ectt-1095">-d </span><span 
class="ecti-1095">dir                                                                                                                      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-9-10-2"  
class="td11"> Output any produced ï¬le to the directory <span 
class="ecti-1095">dir                                                                                                                                                                                                                                               </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-9-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-9-11-1"  
class="td11">                                                                                       </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-370004.3"></a>Advanced options</h3>
<!--l. 981--><p class="noindent" >TableÂ <a 
href="#x1-370012">4.2<!--tex4ht:ref: tab:add-options --></a> summarizes the advanced options that are accessible through the command
line.
<div class="table">
                                                                                  

                                                                                  
<!--l. 983--><p class="noindent" ><a 
 id="x1-370012"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 4.2: </span><span  
class="content">Command line: advanced options</span></div><!--tex4ht:label?: x1-370012 -->
<div class="tabular"> <table id="TBL-10" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-10-1g"><col 
id="TBL-10-1"></colgroup><colgroup id="TBL-10-2g"><col 
id="TBL-10-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-1-1"  
class="td11"> Argument                                                                                                                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-1-2"  
class="td11"> Description                                                                                                                                                                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-2-1"  
class="td11">  <span 
class="ectt-1095">-rescale </span><!--l. 989--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-2-2"  
class="td11"> Multiply each initial quantity by <!--l. 989--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math>              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-3-1"  
class="td11">  <span 
class="ectt-1095">--no-log                                                                              </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-3-2"  
class="td11"> Do not generate a reproductability ï¬le                                                                                                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-4-1"  
class="td11">  <span 
class="ectt-1095">-log </span><span 
class="ecit-1095">file                                                                             </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-4-2"  
class="td11"> Specify the name of the reproductability ï¬le                                                                                                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-5-1"  
class="td11">                                                                                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-5-2"  
class="td11"> (default â€œinputsâ€)                                                                                                                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-6-1"  
class="td11">  <span 
class="ectt-1095">-seed </span><!--l. 993--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-6-2"  
class="td11"> Seeds the pseudo-random number generator <!--l. 993--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn></math>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-7-1"  
class="td11">  <span 
class="ectt-1095">-rescale </span><!--l. 994--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-7-2"  
class="td11"> Multiply each initial quantity by <!--l. 994--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math>              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-8-1"  
class="td11">  <span 
class="ectt-1095">-make-sim </span><span 
class="ecti-1095">sim_ï¬le                                                                                                     </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-8-2"  
class="td11"> makes a simulation package out of the input kappa ï¬les                                                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-9-1"  
class="td11">  <span 
class="ectt-1095">-load-sim </span><span 
class="ecti-1095">sim_ï¬le                                                                                                     </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-9-2"  
class="td11"> use simulation package <span 
class="ecti-1095">sim_ï¬le </span>as input                                                                                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-10-1"  
class="td11">  <span 
class="ectt-1095">--gluttony                                                                            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-10-2"  
class="td11"> simulation mode that is memory intensive                                                                                                                           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-11-1"  
class="td11">                                                                                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-11-2"  
class="td11"> but that speeds up simulation time                                                                                                                                    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-12-1"  
class="td11">  <span 
class="ectt-1095">-mode batch                                                                           </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-12-2"  
class="td11"> Set non interactive mode (never halt waiting for an user                                                                                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-13-1"  
class="td11">                                                                                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-13-2"  
class="td11"> action but assume default (data loosing) answer)                                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-10-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-14-1"  
class="td11">  <span 
class="ectt-1095">-mode interactive                                                                     </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-10-14-2"  
class="td11"> Launch the toplevel just after model initialisation                                                                                                                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-10-15-"><td  style="text-align:left; white-space:nowrap;" id="TBL-10-15-1"  
class="td11">                                                                                        </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<h3 class="sectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-380004.4"></a>Example</h3>
<!--l. 1008--><p class="noindent" >The command
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim model.ka -u event -l 1000000 -p 1000 -o model.out</span></li></ul>
<!--l. 1012--><p class="noindent" >will generate a ï¬le <span 
class="ectt-1095">model.out </span>containing the trajectories of the observables deï¬ned in the
kappa ï¬le <span 
class="ectt-1095">model.ka</span>. A measure will be taken every 1000 events in ï¬le <span 
class="ectt-1095">model.out</span>. The
command
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim init.ka rules.ka obs.ka mod.ka -l 1.5 -p 0.0015</span></li></ul>
<!--l. 1016--><p class="noindent" >will generate a ï¬le <span 
class="ectt-1095">data.csv </span>(default name) containing 1000 data points of a simulation of 1.5
(arbitrary) time units of the model. Note that the input Kappa ï¬le is split in four ï¬les containing,
for instance, the initial conditions, <span 
class="ectt-1095">init.ka</span>, the rule set, <span 
class="ectt-1095">rules.ka</span>, the observables, <span 
class="ectt-1095">obs.ka</span>, and
the perturbations, <span 
class="ectt-1095">pert.ka </span>(see ChapterÂ <a 
href="#x1-140003">3<!--tex4ht:ref: chap:kappa --></a> for details).
<!--l. 1018--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-390004.5"></a>Interactivity</h3>
<!--l. 1019--><p class="noindent" >Simulations are interuptible by sending a <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">SIGINT</span></span></span> to the simulator. (Easiest way to send a <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">SIGINT</span></span></span>
to a process is to press Ctrl-c in the terminal window it runs into.)
<!--l. 1023--><p class="noindent" >In batch mode, this stops the simulation. In other circonstances, it launches a toplevel in which
you can either type
     <ul class="itemize1">
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">$RUN</span></span></span> (optionnaly followed by a pause condition) to resume simulation or
     </li>
     <li class="itemize">any of the <span 
class="ecti-1095">eï¬€ect </span>described in <a 
href="#x1-440006.1">6.1<!--tex4ht:ref: sec:mod --></a> to trigger it immediatly.</li></ul>
<!--l. 1032--><p class="noindent" >A pause condition is a boolean expression (also described in <a 
href="#x1-440006.1">6.1<!--tex4ht:ref: sec:mod --></a>) under which the simulator will
stop and fall back in the toplevel in order to allow a new interactive session.
                                                                                  

                                                                                  
<!--l. 1036--><p class="noindent" >The option <span 
class="ectt-1095">-mode interactive </span>â€œinterrupts automaticaly the simulationâ€ (and launches the
toplevel) just after the initialization of the simulation.
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 5</span><br /><a 
 id="x1-400005"></a>A simple model</h2>
<!--l. 1042--><p class="noindent" >We describe below the content of a simple Kappa model and give examples of some typical
run<span class="footnote-mark"><a 
href="Ka3.htm#fn1x6"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-40001f1"></a> .
<h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-410005.1"></a>ABC.ka</h3>
<!--l. 1045-->
<div class="lstlisting" id="listing-21"><span class="label"><a 
 id="x1-41001r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">###</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Signatures</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41002r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Declaration</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">of</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">agent</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41003r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Declaration</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">of</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41004r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u~p,x2~u~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Declaration</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">of</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">with</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">2</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">modifiable</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">sites</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41005r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">###</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Rules</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41006r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">on_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">binds</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41007r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">..</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">off_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">AB</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">dissociation</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41008r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">ab</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c!2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u!2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">on_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">AB</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">binds</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41009r9"></a><span 
class="ecrm-0600">9</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">mod</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">x1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">mod_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">ABC</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">modifies</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">x1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41010r10"></a><span 
class="ecrm-0600">10</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~u!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">on_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">binds</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">on</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">x2</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41011r11"></a><span 
class="ecrm-0600">11</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">mod</span><span 
class="ectt-1095">â£</span><span 
class="ectt-1095">x2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~u!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">mod_rate</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">modifies</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">x2</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41012r12"></a><span 
class="ecrm-0600">12</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">###</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Variables</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41013r13"></a><span 
class="ecrm-0600">13</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">on_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1.0</span><span 
class="ectt-1095">E-4</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">molecule</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">second</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41014r14"></a><span 
class="ecrm-0600">14</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">off_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0.1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">second</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41015r15"></a><span 
class="ecrm-0600">15</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">mod_rate</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">per</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">second</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41016r16"></a><span 
class="ecrm-0600">16</span></span><span 
class="ectt-1095">%obs:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">AB</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!x</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41017r17"></a><span 
class="ecrm-0600">17</span></span><span 
class="ectt-1095">%obs:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cuu</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u,x2~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41018r18"></a><span 
class="ecrm-0600">18</span></span><span 
class="ectt-1095">%obs:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpu</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41019r19"></a><span 
class="ecrm-0600">19</span></span><span 
class="ectt-1095">%obs:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p,x2~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41020r20"></a><span 
class="ecrm-0600">20</span></span><span 
class="ectt-1095">#</span><span 
class="ectt-1095">###</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Initial</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">conditions</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41021r21"></a><span 
class="ecrm-0600">21</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1000</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-41022r22"></a><span 
class="ecrm-0600">22</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">10000</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">()</span>
</div>
<!--l. 1070--><p class="noindent" >Line 1-4 of this KF<a 
 id="dx1-41023"></a> contains signature<a 
 id="dx1-41024"></a> declarations<a 
 id="dx1-41025"></a><a 
 id="dx1-41026"></a>. Agents of type <span 
class="ectt-1095">C </span>have 2 sites <span 
class="ectt-1095">x1 </span>and <span 
class="ectt-1095">x2 </span>whose
internal state may be <span 
class="ectt-1095">u</span>(nphosphorylated) or <span 
class="ectt-1095">p</span>(hosphorylated). Recall that the default state of
these sites is <span 
class="ectt-1095">u </span>(the ï¬rst one). Line 8, rule <span 
class="tctt-1095">'</span><span 
class="ectt-1095">ab.c</span><span 
class="tctt-1095">' </span>binds an <span 
class="ectt-1095">A </span>connected to someone on
site <span 
class="ectt-1095">x </span>(link type <span 
class="ectt-1095">!_</span>) to a <span 
class="ectt-1095">C</span>. Note that the only rule that binds an agent to <span 
class="ectt-1095">x </span>of <span 
class="ectt-1095">A </span>is
<span 
class="tctt-1095">'</span><span 
class="ectt-1095">a.b</span><span 
class="tctt-1095">' </span>at line 6. Hence the use of <span 
class="ectt-1095">!_ </span>is a commodity and the rule could be replaced by
<!--l. 1071-->
<div class="lstlisting" id="listing-22"><span class="label"><a 
 id="x1-41027r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">alt_ab</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">c</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">...</span>
</div>
<!--l. 1074--><p class="noindent" >There are two main points to notice about this model: <span 
class="ectt-1095">A </span>can modify both sites of <span 
class="ectt-1095">C </span>once it is
bound to them. However, only an <span 
class="ectt-1095">A </span>bound to a <span 
class="ectt-1095">B </span>can connect on <span 
class="ectt-1095">x1 </span>and only a free <span 
class="ectt-1095">A </span>can
connect on <span 
class="ectt-1095">x2</span>. Note also that <span 
class="ectt-1095">x2 </span>is available for connection only when <span 
class="ectt-1095">x1 </span>is already
modiï¬ed.
<!--l. 1076--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-420005.2"></a>Some runs</h3>
                                                                                  

                                                                                  
<!--l. 1077--><p class="noindent" >We try ï¬rst a coarse simulation of <!--l. 1077--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>0</mn><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mn>0</mn><mn>0</mn></math>
events (10 times the number of agents in the initial system).
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim ABC.ka -u event -l 100000 -p 1000 -o abc.csv</span></li></ul>
<!--l. 1082--><p class="noindent" >Plotting the content of the <span 
class="ectt-1095">abc.csv </span>ï¬le one notices that nothing of signiï¬cant interest
happen to the observables after 250s. So we can now specify a meaningful time limit by
running
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim ABC.ka -l 250 -p 0.25 -o abc.out</span></li></ul>
<!--l. 1087--><p class="noindent" >which produces the data points whose rendering is given in Fig.Â <a 
href="#x1-420011">5.1<!--tex4ht:ref: fig:abc --></a>. <hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-420011"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1089--><p class="noindent" >

<!--l. 1090--><p class="noindent" ><img 
src="generated_img/plot-abc.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 5.1: </span><span  
class="content">Simulation of the ABC model: population of unmodiï¬ed <span 
class="ectt-1095">C</span>s (observable <span 
class="ectt-1095">Cuu</span>
in red) drops rapidly and is replaced, in a ï¬rst step by simply modiï¬ed <span 
class="ectt-1095">C</span>s (observable <span 
class="ectt-1095">Cpu</span>
in blue) which are in turn replaced by doubly modiï¬ed <span 
class="ectt-1095">C</span>s (observable <span 
class="ectt-1095">Cpp </span>in red). Note
that the population of <span 
class="ectt-1095">AB </span>complexes (observable <span 
class="ectt-1095">AB </span>in black) stabilizes slightly below 400
individuals after about 20s.</span></div><!--tex4ht:label?: x1-420011 -->
</div>
                                                                                  

                                                                                  
<!--l. 1094--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1095--><p class="noindent" >We will use this model as a running example for the next chapter, in order to illustrate various
advanced concepts.
                                                                                  

                                                                                  
<!--l. 1097--><p class="noindent" >
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 6</span><br /><a 
 id="x1-430006"></a>Advanced concepts</h2>
<h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-440006.1"></a>Perturbation language</h3>
<!--l. 1101--><p class="noindent" >It is possible to trigger a <span 
class="ecti-1095">perturbation</span><a 
 id="dx1-44001"></a> of the simulation when a <span 
class="ecti-1095">precondition</span><a 
 id="dx1-44002"></a> (depending on the
variables<a 
 id="dx1-44003"></a> of the model) is satisï¬ed.
<!--l. 1105--><p class="noindent" >By default, a perturbation is applied as soon as its precondition is satisï¬ed and then discarded.
Such perturbation is called <span 
class="ecti-1095">&#x0022;one shot&#x0022;</span><a 
 id="dx1-44004"></a>. It is however possible to re-apply the same perturbation
each time its precondition is satisï¬ed and until a certain condition is met, using the <span 
class="ectt-1095">repeat ...</span>
<span 
class="ectt-1095">until </span>constructors.
<!--l. 1112--><p class="noindent" >When the precondition of several perturbations are satisï¬ed at the same time. Perturbations are
triggered in the order in which they have been declared in the KF<a 
 id="dx1-44005"></a>. A perturbation can only be
ï¬red once per event loop.
<!--l. 1117--><p class="noindent" >Basic perturbations are obtained using the declaration <a 
 id="dx1-44006"></a>:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%mod: </span><span 
class="ecti-1095">boolean_expression </span><span 
class="ectt-1095">do </span><span 
class="ecti-1095">eï¬€ect_list</span></li></ul>
<!--l. 1121--><p class="noindent" >and may be applied repeatedly using:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%mod: repeat </span><span 
class="ecti-1095">boolean_expression </span><span 
class="ectt-1095">do </span><span 
class="ecti-1095">eï¬€ect_list </span><span 
class="ectt-1095">until </span><span 
class="ecti-1095">boolean_expression</span></li></ul>
<!--l. 1125--><p class="noindent" >where <span 
class="ecti-1095">boolean_expression </span>and <span 
class="ecti-1095">eï¬€ect_list</span><a 
 id="dx1-44007"></a> are deï¬ned by the grammar
given TableÂ <a 
href="#x1-440091">6.1<!--tex4ht:ref: tab:pert --></a> (the operator <span 
class="ectt-1095">rel </span>can be any usual binary relation in
<!--l. 1125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-rel">&#x003E;</mo></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
algebraic expressions<a 
 id="dx1-44008"></a> are deï¬ned TableÂ <a 
href="#x1-320036">3.6<!--tex4ht:ref: tab:alg --></a>).
<div class="table">
                                                                                  

                                                                                  
<!--l. 1127--><p class="noindent" ><a 
 id="x1-440091"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 6.1: </span><span  
class="content">Perturbation expressions</span></div><!--tex4ht:label?: x1-440091 -->
<div class="tabular"> <table id="TBL-11" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-11-1g"><col 
id="TBL-11-1"><col 
id="TBL-11-2"><col 
id="TBL-11-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-11-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-1-1"  
class="td01"><span 
class="ecti-1095">perturbation_expression  </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-1-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-1-3"  
class="td10"> <span id="textcolor31"><span 
class="ectt-1095">%mod:</span></span> <span 
class="ecti-1095">perturbation                                                                                                                                 </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-2-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-2-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-2-3"  
class="td10"> | <span id="textcolor32"><span 
class="ectt-1095">%mod:</span></span> <span id="textcolor33"><span 
class="ectt-1095">repeat</span></span> <span 
class="ecti-1095">perturbation </span><span id="textcolor34"><span 
class="ectt-1095">until</span></span> <span 
class="ecti-1095">boolean_expression                                                                                     </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-3-1"  
class="td01">                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-4-1"  
class="td01"><span 
class="ecti-1095">perturbation</span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-4-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-4-3"  
class="td10"> <span 
class="ecti-1095">boolean_expression </span><span id="textcolor35"><span 
class="ectt-1095">do</span></span> <span 
class="ecti-1095">eï¬€ect_list                                                                                                                </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-5-1"  
class="td01">                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-6-1"  
class="td01"><span 
class="ecti-1095">boolean_expression</span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-6-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-6-3"  
class="td10"> <span 
class="ecti-1095">algebraic_expression</span><a 
 id="dx1-44010"></a> <span id="textcolor36"><span 
class="ectt-1095">rel</span></span> <span 
class="ecti-1095">algebraic_expression                                                                                               </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-7-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-7-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-7-3"  
class="td10"> | (<span 
class="ecti-1095">boolean_expression </span><span id="textcolor37"><span 
class="ectt-1095">||</span></span> <span 
class="ecti-1095">boolean_expression</span>)                                                                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-8-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-8-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-8-3"  
class="td10"> | (<span 
class="ecti-1095">boolean_expression </span><span id="textcolor38"><span 
class="ectt-1095">&#x0026;&#x0026;</span></span> <span 
class="ecti-1095">boolean_expression</span>)                                                                                                       </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-9-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-9-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-9-3"  
class="td10"> | <span id="textcolor39"><span 
class="ectt-1095">[not]</span></span> <span 
class="ecti-1095">boolean_expression                                                                                                                       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-10-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-10-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-10-3"  
class="td10"> | <span id="textcolor40"><span 
class="ectt-1095">[true]</span></span> | <span id="textcolor41"><span 
class="ectt-1095">[false]</span></span>                                                                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-11-1"  
class="td01">                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-12-1"  
class="td01"><span 
class="ecti-1095">eï¬€ect_list                    </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-12-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-12-3"  
class="td10"> <span 
class="ecti-1095">eï¬€ect </span><span id="textcolor42"><span 
class="ectt-1095">;</span></span> <span 
class="ecti-1095">eï¬€ect_list </span>| <span 
class="ecti-1095">eï¬€ect                                                                                                                         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-13-1"  
class="td01">                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-11-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-14-1"  
class="td01"><span 
class="ecti-1095">eï¬€ect</span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-14-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-14-3"  
class="td10"> <span id="textcolor43"><span 
class="ectt-1095">$ADD</span></span> <span 
class="ecti-1095">algebraic_expression agent_expression                                                                                                  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-15-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-15-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-15-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-15-3"  
class="td10"> | <span id="textcolor44"><span 
class="ectt-1095">$DEL</span></span> <span 
class="ecti-1095">algebraic_expression agent_expression                                                                                                </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-16-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-16-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-16-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-16-3"  
class="td10"> | <span 
class="ecti-1095">token_name </span><span id="textcolor45"><span 
class="ectt-1095">&#x003C;-</span></span> <span 
class="ecti-1095">algebraic_expression                                                                                                         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-17-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-17-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-17-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-17-3"  
class="td10"> | <span id="textcolor46"><span 
class="ectt-1095">$SNAPSHOT</span></span> <span 
class="ecti-1095">string_expression                                                                                                                   </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-18-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-18-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-18-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-18-3"  
class="td10"> | <span id="textcolor47"><span 
class="ectt-1095">$STOP</span></span> <span 
class="ecti-1095">string_expression                                                                                                                        </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-19-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-19-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-19-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-19-3"  
class="td10"> | <span id="textcolor48"><span 
class="ectt-1095">$FLUX</span></span> <span 
class="ecti-1095">string_expression boolean                                                                                                               </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-20-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-20-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-20-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-20-3"  
class="td10"> | <span id="textcolor49"><span 
class="ectt-1095">$TRACK </span><span 
class="tctt-1095">'</span><span 
class="ectt-1095">var_name</span><span 
class="tctt-1095">'</span></span> <span 
class="ecti-1095">boolean                                                                                                                    </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-21-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-21-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-21-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-21-3"  
class="td10"> | <span id="textcolor50"><span 
class="ectt-1095">$UPDATE </span><span 
class="tctt-1095">'</span><span 
class="ectt-1095">var_name</span><span 
class="tctt-1095">'</span></span> <span 
class="ecti-1095">algebraic_expression                                                                                                  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-22-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-22-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-22-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-22-3"  
class="td10"> | <span id="textcolor51"><span 
class="ectt-1095">$PLOTENTRY</span></span>                                                                                             </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-23-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-23-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-23-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-23-3"  
class="td10"> | <span id="textcolor52"><span 
class="ectt-1095">$PRINT</span></span> <span 
class="ecti-1095">string_expression </span><span id="textcolor53"><span 
class="ectt-1095">&#x003C;</span></span><span 
class="ecti-1095">string_expression</span><span id="textcolor54"><span 
class="ectt-1095">&#x003E;</span></span>                                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-24-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-24-1"  
class="td01">                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-25-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-25-1"  
class="td01"><span 
class="ecti-1095">string_expression          </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-25-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-25-3"  
class="td10"> <span id="textcolor55"><!--l. 1152--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœ€</mi></math></span> | <span id="textcolor56"><span 
class="ectt-1095">&#x0022;string&#x0022; . </span></span> <span 
class="ecti-1095">string_expression</span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-26-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-26-1"  
class="td01">                      </td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-26-2"  
class="td11">     </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-26-3"  
class="td10"> | <span 
class="ecti-1095">algebraic_expression</span><span id="textcolor57"> <span 
class="ectt-1095">. </span></span> <span 
class="ecti-1095">string_expression                                                                                                  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-27-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-27-1"  
class="td01">                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-11-28-"><td  style="text-align:left; white-space:nowrap;" id="TBL-11-28-1"  
class="td01"><span 
class="ecti-1095">boolean                       </span></td><td  style="text-align:center; white-space:nowrap;" id="TBL-11-28-2"  
class="td11"> ::=  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-11-28-3"  
class="td10"> <span id="textcolor58"><span 
class="ectt-1095">[true]</span></span> | <span id="textcolor59"><span 
class="ectt-1095">[false]</span></span>                                                                                          </td></tr></table>
</div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
<!--l. 1159--><p class="noindent" >A example of boolean expression used as a precondition is <!--l. 1160-->
<div class="lstlisting" id="listing-23"><span class="label"><a 
 id="x1-44011r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">([</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;10</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0026;&#x0026;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">v1</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">/</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">v2</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">...</span>
</div>
<!--l. 1164--><p class="noindent" >It indicate the wish to trigger a perturbation whenever the simulation time has passed 10 time
units and the ratio of variables <span 
class="ectt-1095">v1 </span>over <span 
class="ectt-1095">v2 </span>is above 1. Recall that the perturbations are &#x0022;one shot&#x0022;
interventions on the simulation. Possible interventions are described in the following sections
using examples.
<!--l. 1170--><p class="noindent" ><span 
class="ecbx-1095">Note on time dependent preconditions: </span><br 
class="newline" />Consider a perturbation of the form:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">%mod: </span><span 
class="ecti-1095">f</span><span 
class="ectt-1095">(t)=</span><span 
class="ecti-1095">x </span><span 
class="ectt-1095">do </span><!--l. 1174--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-op">â€¦</mo><mspace width="0.3em" class="thinspace"/></math></li></ul>
<!--l. 1175--><p class="noindent" >where <!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> is an algebraic expression
dependent on time and <!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
an arbitrary algebraic expression. Having in mind the simulation
algorithm implemented by <span 
class="ecss-1095">KaSim</span>, at the beginning of an event loop, both
<!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> and
<!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> will be
evaluated. It is very unlikely (in general with a probability equal to 0) that both values coincide.
Currently <span 
class="ecss-1095">KaSim</span>Â is not equipped with a solver able to detect that in the past of the current state, there
was a <!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi></math>
that made the precondition hold, unless the equation is trivial to solve. Therefore the only time
dependent precondition with an equality test that is allowed in <span 
class="ecss-1095">KaSim</span>Â has to be of the form
<!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>T</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo></mstyle><mi 
>n</mi></math> with
<!--l. 1175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi> <mo 
class="MathClass-rel">âˆˆ</mo> <mi 
>â„•</mi></math>. For
instance: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]=10</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$STOP</span></span> will interrupt the simulation after exactly 10 time
units.
<h4 class="subsectionHead"><span class="titlemark">6.1.1   </span> <a 
 id="x1-450006.1.1"></a>Adding or deleting agents during a simulation</h4>
<!--l. 1181--><p class="noindent" >Continuing with the ABC model, the perturbation eï¬€ect<a 
 id="dx1-45001"></a>: <span class="lstinline"><span 
class="ectt-1095">$ADD</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x1~p</span><span 
class="ectt-1095">)</span></span> will add
<!--l. 1183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi> <mo 
class="MathClass-rel">â‰¥</mo> <mn>0</mn></math>
instances of <span 
class="ectt-1095">C </span>with <span 
class="ectt-1095">x1 </span>already in state <span 
class="ectt-1095">p </span>(and the rest of its interface in the default state as
                                                                                  

                                                                                  
speciï¬ed line 4 of ABC.ka). Also the perturbation eï¬€ect<a 
 id="dx1-45002"></a>: <span class="lstinline"><span 
class="ectt-1095">$DEL</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">B</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_</span><span 
class="ectt-1095">)</span></span> will remove <span 
class="ecti-1095">all</span>
<span 
class="ectt-1095">B</span>s connected to some agent from the mixture<a 
 id="dx1-45003"></a>.
<!--l. 1187--><p class="noindent" >There are various ways one can use perturbations to study more deeply a given kappa model. A
basic illustration is the use of a simple perturbation to let a system equilibrate before starting a
real simulation. For instance, as can be seen from the curve given in Fig.Â <a 
href="#x1-420011">5.1<!--tex4ht:ref: fig:abc --></a>, the number of AB
complexes is arbitrarily set to 0 in the initial state (all <span 
class="ectt-1095">A</span>s are disconnected from <span 
class="ectt-1095">B</span>s in the initial
mixture<a 
 id="dx1-45004"></a>). In order to avoid this, one can modify the kappa ï¬le the following way: we set the initial
concentration of <span 
class="ectt-1095">C </span>to 0 by deleting line 22. Now we introduce <span 
class="ectt-1095">C</span>s after 25 t.u using the
perturbation: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]=25</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$ADD</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">10000</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">C</span><span 
class="ectt-1095">()</span></span>
<!--l. 1190--><p class="noindent" >The modiï¬ed kappa ï¬le is available in the source repository, in the <span 
class="ectt-1095">model/ </span>directory (ï¬le
<span 
class="ectt-1095">abc-pert.ka</span>). Running again a simulation (a bit longer) by entering in the command
line:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim ABC-pert.ka -l 300 -p 0.3 -o abc2.out</span></li></ul>
<!--l. 1196--><p class="noindent" >one obtains the curve given in Fig.Â <a 
href="#x1-450051">6.1<!--tex4ht:ref: fig:abc2 --></a>.
<!--l. 1198--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-450051"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1199--><p class="noindent" >

<!--l. 1200--><p class="noindent" ><img 
src="generated_img/plot-abc2.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 6.1: </span><span  
class="content">Simulation of the ABC model with a perturbation: for t&#x003C;25s, only <span 
class="tctt-1095">'</span><span 
class="ectt-1095">a.b</span><span 
class="tctt-1095">' </span>and
<span 
class="tctt-1095">'</span><span 
class="ectt-1095">a..b</span><span 
class="tctt-1095">' </span>rules may apply. This enables the concentration of <span 
class="tctt-1095">'</span><span 
class="ectt-1095">AB</span><span 
class="tctt-1095">' </span>complexes to go to steady
state, before introducing fresh <span 
class="ectt-1095">C</span>s at t=25s.</span></div><!--tex4ht:label?: x1-450051 -->
</div>
                                                                                  

                                                                                  
<!--l. 1204--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">6.1.2   </span> <a 
 id="x1-460006.1.2"></a>Get a snapshot of the mixture (to deï¬ne a new initial state)</h4>
<!--l. 1208--><p class="noindent" >A snapshot is an instant photography of the current state of the mixture (a dump of the state at
a given moment in the simulation).
<!--l. 1210--><p class="noindent" >In the previous example, we let the system evolve for some time without its main reactant <span 
class="ectt-1095">C </span>in
order to let other reactants go to a less arbitrary initial state. One may object that this way of
proceeding is CPU-time consuming if one has to do this at each simulation. An alternative is to
use the <span 
class="ectt-1095">$SNAPSHOT </span>primitive that allows a user to export a snapshot of the mixture<a 
 id="dx1-46001"></a>
at a given time point as a new (piece of) kappa ï¬le. For instance, the declaration<a 
 id="dx1-46002"></a>:
<span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">/</span><span 
class="ectt-1095">([</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]+[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">])</span><span 
class="ectt-1095">&#x003E;0</span><span 
class="ectt-1095">.9</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$SNAPSHOT</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">prefix</span><span 
class="ectt-1095">&#x0022;</span></span> will ask <span 
class="ecss-1095">KaSim</span>Â to export the mixture<a 
 id="dx1-46003"></a> the
ï¬rst time the percentage of null events reaches 90%. The exported ï¬le will be named
<span 
class="ectt-1095">prefix_</span><!--l. 1213--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math><span 
class="ectt-1095">.ka</span>
where <!--l. 1213--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>
is the event number at which the snapshot was taken. One may also use a <span 
class="ecti-1095">string_expression </span>to
construct any preï¬x using local variables.
<!--l. 1215--><p class="noindent" >One may omit to deï¬ne a preï¬x and simply type: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">/</span><span 
class="ectt-1095">([</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]+[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">])</span><span 
class="ectt-1095">&#x003E;0</span><span 
class="ectt-1095">.9</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$SNAPSHOT</span></span> in
which case the default preï¬x <span 
class="ectt-1095">snap.ka </span>will be used for naming snapshots.
<!--l. 1219--><p class="noindent" >If the name already exists a counter will be appended at the end of the ï¬le to prevent overwriting.
Snapshots can be performed multiple times, for instance every 1000 events, using the declaration<a 
 id="dx1-46004"></a>:
<!--l. 1223-->
<div class="lstlisting" id="listing-24"><span class="label"><a 
 id="x1-46005r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">repeat</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">([</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">mod</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1000)</span><span 
class="ectt-1095">=0</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$SNAPSHOT</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">abc</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">ka</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">until</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span>
</div>
<!--l. 1226--><p class="noindent" >which results in <span 
class="ecss-1095">KaSim</span>Â producing a snapshot every 1000 (productive) events until the simulation
ends.
<!--l. 1228--><p class="noindent" >Note that instead of producing kappa ï¬les, one may use snapshot perturbations to produce an
image of the mixture<a 
 id="dx1-46006"></a> in the dot/html format using the parameter by specifying the extention in
the name skeleton (<span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">/</span><span 
class="ectt-1095">([</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]+[</span><span 
class="ectt-1095">E-</span><span 
class="ectt-1095">])</span><span 
class="ectt-1095">&#x003E;0</span><span 
class="ectt-1095">.9</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$SNAPSHOT</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">snap</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">dot</span><span 
class="ectt-1095">&#x0022;</span></span>).
<!--l. 1230--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.3   </span> <a 
 id="x1-470006.1.3"></a>Interrupt simulation</h4>
                                                                                  

                                                                                  
<!--l. 1231--><p class="noindent" >The perturbation <span 
class="ectt-1095">$STOP &#x0022;final_state.ka&#x0022; </span>will terminate the simulation whenever its
precondition is satisï¬ed and produce a snapshot of the last mixture<a 
 id="dx1-47001"></a>.
<!--l. 1235--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.4   </span> <a 
 id="x1-480006.1.4"></a>Changing the value of a token</h4>
<!--l. 1236--><p class="noindent" >The concentration of any token can be reset on the ï¬‚y using a perturbation. For instance the
declaration<a 
 id="dx1-48001"></a>: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">repeat</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">(|</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">&#x003C;100</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003C;-</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">|*2)</span><span 
class="ectt-1095">until</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span></span> will double the
concentration of token <span 
class="ectt-1095">a </span>each time it gets below 100.
<!--l. 1240--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.5   </span> <a 
 id="x1-490006.1.5"></a>Causality analysis</h4>
<!--l. 1242--><p class="noindent" >In our ABC example, adding the instruction: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span></span> will
askÂ <span 
class="ecss-1095">KaSim</span>Â to turn on causality analysis<a 
 id="dx1-49001"></a> for the observable <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">' </span>since the beginning of the
simulation, and display the causal explanation of every new occurrence of <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">'</span>, until the end of
the simulation. The explanation, that we call a <span 
class="ecti-1095">causal ï¬‚ow</span><a 
 id="dx1-49002"></a>, is a set of rule application
ordered by causality and displayed as a graph using dot format. In this graph, an edge
<span 
class="ectt-1095">r</span><!--l. 1244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">â†’</mo></math> <span 
class="ectt-1095">r</span><span 
class="tctt-1095">' </span>between two
rule applications <!--l. 1244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="texttt" mathvariant="monospace" >r</mtext></mstyle></math>
and <!--l. 1244--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="texttt" mathvariant="monospace" >'r'</mtext></mstyle></math>
indicates that the ï¬rst rule application has used, in the simulation, some sites that were
modiï¬ed by the application of the former. We show Fig.Â <a 
href="#x1-490032">6.2<!--tex4ht:ref: fig:cflow --></a> an example of such causal
ï¬‚ow.
<!--l. 1246--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-490032"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1247--><p class="noindent" >

<!--l. 1248--><p class="noindent" ><img 
src="generated_img/cflow.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 6.2: </span><span  
class="content">Causal ï¬‚ow for the observable <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">' </span>of the ABC model. Plain arrows represent
causal dependency, dotted arrows show asymmetric conï¬‚ict between rule occurrences. Here
the <span 
class="tctt-1095">'</span><span 
class="ectt-1095">ab.c</span><span 
class="tctt-1095">' </span>rule has to occur before the <span 
class="tctt-1095">'</span><span 
class="ectt-1095">a.b</span><span 
class="tctt-1095">' </span>rule. Red observable indicate that the last
rule allowed one to observe a new instance of <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">'</span>.</span></div><!--tex4ht:label?: x1-490032 -->
</div>
                                                                                  

                                                                                  
<!--l. 1252--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1254--><p class="noindent" >Causality analysis of the observable <span 
class="ectt-1095">Cpp </span>can be turned oï¬€ at any time using a declaration<a 
 id="dx1-49004"></a> of the
form: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;25</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span></span>
<!--l. 1257--><p class="noindent" >Each time <span 
class="ecss-1095">KaSim</span>Â detects a new occurrence of the observable that is being tracked, it will dump
it&#x2019;s causal past as a graph using the dot format (see Fig.Â <a 
href="#x1-490032">6.2<!--tex4ht:ref: fig:cflow --></a> above). The name of
the ï¬le in which the causal ï¬‚ow is stored can be set using the <span 
class="ectt-1095">%def </span>instruction (see
SectionÂ <a 
href="#x1-580006.4">6.4<!--tex4ht:ref: sec:param --></a>).
<h5 class="likesubsubsectionHead"><a 
 id="x1-500006.1.5"></a>Compressing causal ï¬‚ows.</h5>
<!--l. 1261--><p class="noindent" >In general pure causal ï¬‚ows<a 
 id="dx1-50001"></a> will contain a lot of information that modelers may
not wish to consider. Indeed in classical ï¬‚ows, causality (represented by an edge
between to rule applications in the graph) is purely local. Therefore a sequence
<!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>b</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>c</mi></math> only implies that an
instance of rule <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math> caused
an instance of rule <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
which in turn created an instance of the observable
<!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>. However it does
not imply that <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math> was
&#x0022;necessary&#x0022; for <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math> to occur
(for instance <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math> might have
been possible before <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
but not after, and <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> would
be simply re-enabling <!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>).
It is possible to tell <span 
class="ecss-1095">KaSim</span>Â to retain only events that are more strongly related to the
observable using two compression techniques (see Ref.Â <span class="cite">[<span 
class="ecbx-1095">?</span>]</span> for formal details). Intuitively,
in a <span 
class="ecti-1095">weakly </span>compressed causal<a 
 id="dx1-50002"></a> ï¬‚ow one has the additional property that if an event
<!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>e</mi></math>
is a (possibly indirect) cause of the observable, then preventing
<!--l. 1261--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>e</mi></math> from
occurring would have prevented the rest of the causal ï¬‚ow to occur (ie it is not possible to
reconstruct a computation trace containing the observable with the events that remain in
the causal ï¬‚ow). A <span 
class="ecti-1095">strongly </span>compressed causal ï¬‚ow enjoys the same property with an
additional level of compression obtained by considering diï¬€erent instances of the same
rule to be indistinguishable<a 
 id="dx1-50003"></a>. Note that causal ï¬‚ow compressions may be memory and
computation demanding. For large systems it may be safer to start with weak compressions
only.
<!--l. 1263--><p class="noindent" >The type of compression can be set using the <span 
class="ectt-1095">%def </span>instruction (see SectionÂ <a 
href="#x1-580006.4">6.4<!--tex4ht:ref: sec:param --></a>). For instance:
                                                                                  

                                                                                  
<span class="lstinline"><span 
class="ectt-1095">%def:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">displayCompression</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">none</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">weak</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">strong</span><span 
class="ectt-1095">&#x0022;</span></span> will ask <span 
class="ecss-1095">KaSim</span>Â to output 3 versions of each
computed causal ï¬‚ow, with all possible degrees of compressions. Each causal ï¬‚ow is outputted into a ï¬le
<span 
class="ectt-1095">[filename][Type]_</span><!--l. 1265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math><span 
class="ectt-1095">.dot</span>
where <span 
class="ectt-1095">filename </span>is the default name for causal ï¬‚ows which can be redeï¬ned using the parameter
<span 
class="ectt-1095">cflowFileName</span>, <span 
class="ectt-1095">Type </span>is the type of compression (either nothing or <span 
class="ectt-1095">Strongly</span>, or <span 
class="ectt-1095">Weakly</span>) and
<!--l. 1265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math> is
the identiï¬er of the causal ï¬‚ow. For each compression type a summary ï¬le, named
<span 
class="ectt-1095">[filename][Type]Summary.dat</span>, is also produced. It allows to map each compressed causal ï¬‚ow
to the identiï¬er of its uncompressed version (row <span 
class="ectt-1095">#id</span>), together with the production time
<!--l. 1265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math> and event
number <!--l. 1265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math> at
which the observable was produced. It also contains information about the size of the causal
ï¬‚ow.
<!--l. 1267--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.6   </span> <a 
 id="x1-510006.1.6"></a>Flux maps</h4>
<!--l. 1269--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-510013"></a>
                                                                                  

                                                                                  

<!--l. 1271--><p class="noindent" ><img 
src="generated_img/flux.png" alt="PIC"  
width="426.79134pt" height="367.47713pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 6.3: </span><span  
class="content">Flux map of the <span 
class="ectt-1095">abc.ka </span>model, taken from t=0 to t=20 time units. The <span 
class="ectt-1095">A</span>
releasing rules <span 
class="ectt-1095">a..b </span>and <span 
class="ectt-1095">mod x2 </span>are contributing very little to the activity of <span 
class="ectt-1095">a.c </span>which is
a sign of an excess of free <span 
class="ectt-1095">A</span>s in the system at this time interval.</span></div><!--tex4ht:label?: x1-510013 -->
                                                                                  

                                                                                  
<!--l. 1274--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1276--><p class="noindent" >The <span 
class="ecti-1095">ï¬‚ux map</span><a 
 id="dx1-51002"></a> is a powerful observation that tracks, on the ï¬‚y, the inï¬‚uence that rule applications
have on each others. It is dynamically generated and tracks eï¬€ective impacts (positive or
negative) a every rule application. The ï¬‚ux map can be computed using declaration<a 
 id="dx1-51003"></a>s of the form:
<!--l. 1277-->
<div class="lstlisting" id="listing-25"><span class="label"><a 
 id="x1-51004r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$FLUX</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">flux</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">dot</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-51005r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;20</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$FLUX</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">flux</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">dot</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span>
</div>
<!--l. 1281--><p class="noindent" >The resulting <span 
class="ecti-1095">ï¬‚ux map </span>is a graph where a positive edge between rules
<!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> and
<!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math> (in green) indicates an overall
positive contribution of <!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math>
over <!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>. Said otherwise,
the sum of <!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> applications
increased the activity<a 
 id="dx1-51006"></a> of <!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.
Conversely, a negative edge (in red) will indicate that
<!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> had an overall negative
impact on the activity<a 
 id="dx1-51007"></a> of <!--l. 1281--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.
Note that the importance of the ï¬‚ux between two rules can be observed by looking at the label on
the edges that indicate the overall activity transfer (positive or negative) between the rules. The
above declaration<a 
 id="dx1-51008"></a> produce a ï¬‚ux map that is shown Fig.Â <a 
href="#x1-510013">6.3<!--tex4ht:ref: fig:flux --></a>. Note that ï¬‚ux may vary during
time, therefore the time or event limit of the simulation is of importance and will likely change
the aspect of the produced map.
<h4 class="subsectionHead"><span class="titlemark">6.1.7   </span> <a 
 id="x1-520006.1.7"></a>Updating kinetic rates on the ï¬‚y</h4>
<!--l. 1286--><p class="noindent" >Any variable between simple quotes can be updated during a simulation using a declaration<a 
 id="dx1-52001"></a> of the
form: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">500</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$UPDATE</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_on</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">0.0</span></span>
<!--l. 1289--><p class="noindent" >This perturbation will be applied whenever the observable <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">' </span>will become greater than
500. Its eï¬€ect will be to set the on rate of all binding rules to 0. Note that according
to the grammar given TableÂ <a 
href="#x1-440091">6.1<!--tex4ht:ref: tab:pert --></a>, one may use any algebraic expression<a 
 id="dx1-52002"></a> as the new
value of the variable. For instance: <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">500</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$UPDATE</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_on</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">k_on</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">/100</span></span>
will cause the on rate of all rules to decrease a hunderd fold. Note that it is possible
to override the kinetic rate of a speciï¬c rule: in our ABC example, the declaration<a 
 id="dx1-52003"></a>:
<span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">500</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$UPDATE</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">b</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">inf</span></span> will set the kinetic rate of rule <span 
class="tctt-1095">'</span><span 
class="ectt-1095">a.b</span><span 
class="tctt-1095">'</span>Â to
inï¬nity.
                                                                                  

                                                                                  
<!--l. 1295--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.8   </span> <a 
 id="x1-530006.1.8"></a>Combining several eï¬€ects in a single perturbation</h4>
<!--l. 1296--><p class="noindent" >As an example, consider the computation of causal ï¬‚ows between
<!--l. 1296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>0</mn></math> and
<!--l. 1296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mn>0</mn></math> using
the declarations: <!--l. 1297-->
<div class="lstlisting" id="listing-26"><span class="label"><a 
 id="x1-53001r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;10</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-53002r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;20</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span>
</div>
<!--l. 1302--><p class="noindent" >The above declaration will ask <span 
class="ecss-1095">KaSim</span>Â to analyze each new occurrence of <span 
class="tcrm-1095">'</span>Cpp<span 
class="tcrm-1095">' </span>in that time interval.
If <!--l. 1302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>
new instances took place, then <span 
class="ecss-1095">KaSim</span>Â will have to compute
<!--l. 1302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math> causal
ï¬‚ows. One may want to bound the number of computed ï¬‚ows to a certain value, say 10.
One may do so using the combination of perturbations and variables given below:
<!--l. 1303-->
<div class="lstlisting" id="listing-27"><span class="label"><a 
 id="x1-53003r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%var:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-53004r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;10</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">true</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$UPDATE</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-53005r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;20</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">||</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0026;&#x0026;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">9)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$TRACK</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Cpp</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span>
</div>
<!--l. 1308--><p class="noindent" >The ï¬rst line is a declaration of an <!--l. 1308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
variable that is initially set to 0. Note that the second line is a perturbation that contains two
simultaneous eï¬€ects, the ï¬rst one triggering causality analysis and the second one updating the value
of variable <!--l. 1308--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
to the current value of variable <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">'</span>. The last line stops causality analysis whenever time is greater
than 20 or when 10 new observables have been found (the diï¬€erence between the current value of <span 
class="tctt-1095">'</span><span 
class="ectt-1095">Cpp</span><span 
class="tctt-1095">'</span>
and <!--l. 1309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>.
<!--l. 1311--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.9   </span> <a 
 id="x1-540006.1.9"></a>Printing values during a simulation</h4>
<!--l. 1312--><p class="noindent" >The eï¬€ect <span 
class="ectt-1095">$PRINT </span><span 
class="ecit-1095">string_expression </span><span 
class="ectt-1095">&#x003C;</span><span 
class="ecit-1095">string_expression</span><span 
class="ectt-1095">&#x003E; </span>enables one to output values
during a computation to
                                                                                  

                                                                                  
     <ul class="itemize1">
     <li class="itemize">standard output if the ï¬rst <span 
class="ecti-1095">string_expression </span>is empty
     </li>
     <li class="itemize">to to the ï¬le speciï¬ed by the ï¬rst <span 
class="ecti-1095">string_expression </span>else</li></ul>
<!--l. 1319--><p class="noindent" >For instance: <!--l. 1320-->
<div class="lstlisting" id="listing-28"><span class="label"><a 
 id="x1-54001r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">repeat</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">\</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-54002r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">&#x003C;0</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$PRINT</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">token_</span><span 
class="ectt-1095">&#x0022;.[</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">].&#x0022;.</span><span 
class="ectt-1095">dat</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x003C;</span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Token</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">is:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">|</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x0022;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">at</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">time</span><span 
class="ectt-1095">=&#x0022;.</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">T</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">&#x003E;</span><span 
class="ectt-1095">\</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-54003r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">until</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span>
</div>
<!--l. 1325--><p class="noindent" >will ask <span 
class="ecss-1095">KaSim</span>Â to output the value of token <span 
class="ectt-1095">A </span>in a ï¬le
&#x0022;token_<!--l. 1326--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>.dat&#x0022;
which changes at each new productive event, each time its value gets below 0.
<!--l. 1329--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">6.1.10   </span> <a 
 id="x1-550006.1.10"></a>Add an entry in the output data</h4>
<!--l. 1330--><p class="noindent" >The eï¬€ect <span 
class="ectt-1095">$PLOTENTRY </span>outputs a line with the current value of observables in the data ï¬le. For
example, <span class="lstinline"><span 
class="ectt-1095">%mod:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">repeat</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">mod</span><span 
class="ectt-1095">]</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">10</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">=</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">0</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">do</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">$PLOTENTRY</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">until</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">[</span><span 
class="ectt-1095">false</span><span 
class="ectt-1095">]</span></span> will store the value
of observables every 10 productive events.
<!--l. 1334--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-560006.2"></a>Implicit signature</h3>
<!--l. 1335--><p class="noindent" ><span 
class="ecss-1095">KaSim</span>Â permits users in a hurry to avoid writing agent signatures explicitly using the option
<span 
class="ectt-1095">--implicit-signature </span>of the command line. The signature is then deduced using information
gathered in the KF<a 
 id="dx1-56001"></a>. Note that it is not recommended to use the DCDW convention for
introduced agents in conjunction with the <span 
class="ectt-1095">--implicit-signature </span>option unless the default
state of all sites is mentioned in the <span 
class="ectt-1095">%init </span>declaration<a 
 id="dx1-56002"></a>s or in the rules that create
agents.
                                                                                  

                                                                                  
<!--l. 1337--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-570006.3"></a>Simulation packages</h3>
<!--l. 1339--><p class="noindent" >The simulation algorithm that is implemented in <span 
class="ecss-1095">KaSim</span>Â requires an initialization phase whose complexity is
proportional to <!--l. 1339--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi> <mo 
class="MathClass-bin">âˆ—</mo> <mi 
>G</mi></math>
where <!--l. 1339--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi></math> is the cardinal
of the rule set and <!--l. 1339--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>
the size of the initial mixture<a 
 id="dx1-57001"></a>. Thus for large systems, initialization may take a while. Whenever a
user wishes to run several simulations of the <span 
class="ecti-1095">same </span>kappa model, it is possible to skip this
initialization phase by creating a <span 
class="ecti-1095">simulation package</span><a 
 id="dx1-57002"></a>. For instance:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim abc.ka -l </span><!--l. 1342--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>
     <span 
class="ectt-1095">-make-sim abc.kasim</span></li></ul>
<!--l. 1343--><p class="noindent" >will generate a standard simulation of the <span 
class="ectt-1095">abc.ka </span>model, but in addition, will create the
simulation package <span 
class="ectt-1095">abc.kasim </span>(.kasim extension is not mandatory). This package is a binary
ï¬le, ie not human readable, that can be used as input of a new simulation using the
command:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSim -load-sim abc.kasim -l </span><!--l. 1346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math></li></ul>
<!--l. 1347--><p class="noindent" >Note that this simulation is now run for <!--l. 1347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
time units instead of <!--l. 1347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>.
Importantly, simulation packages can only be given as input to the <span 
class="ecti-1095">same </span><span 
class="ecss-1095">KaSim</span>Â that produced it.
As a consequence, recompiling the code, or obtaining diï¬€erent binaries, will cause the simulation
package to become useless.
<!--l. 1349--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">6.4   </span> <a 
 id="x1-580006.4"></a>Simulation parameters conï¬guration</h3>
<!--l. 1351--><p class="noindent" >In the KF<a 
 id="dx1-58001"></a> (usually in a dedicated ï¬le) one may use expressions of the form:
                                                                                  

                                                                                  
<div class="math-display"><!--l. 1352--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mrow 
>
                    <mi 
>%</mi><mi 
>d</mi><mi 
>e</mi><mi 
>f</mi><mi 
>:</mi> <mi 
>&#x0022;</mi><mi 
>p</mi><mi 
>a</mi><mi 
>r</mi><mi 
>a</mi><mi 
>m</mi><mi 
>e</mi><mi 
>t</mi><mi 
>e</mi><mi 
>r</mi><mi 
>_</mi><mi 
>n</mi><mi 
>a</mi><mi 
>m</mi><mi 
>e</mi><mi 
>&#x0022;</mi> <mi 
>&#x0022;</mi><mi 
>p</mi><mi 
>a</mi><mi 
>r</mi><mi 
>a</mi><mi 
>m</mi><mi 
>e</mi><mi 
>t</mi><mi 
>e</mi><mi 
>r</mi><mi 
>_</mi><mi 
>v</mi><mi 
>a</mi><mi 
>l</mi><mi 
>u</mi><mi 
>e</mi><mi 
>&#x0022;</mi>
</mrow></math></div>
<!--l. 1354--><p class="nopar" > where tunable parameters are described tableÂ <a 
href="#x1-580022">6.2<!--tex4ht:ref: tab:parameters --></a> (default values are given ï¬rst in the possible
values column). <div class="table">
                                                                                  

                                                                                  
<!--l. 1357--><p class="noindent" ><a 
 id="x1-580022"></a><hr class="float"><div class="float" 
>
                                                                                  

                                                                                  
 <div class="caption" 
><span class="id">TableÂ 6.2: </span><span  
class="content">User deï¬ned parameters</span></div><!--tex4ht:label?: x1-580022 -->
<div class="tabular"> <table id="TBL-12" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-12-1g"><col 
id="TBL-12-1"></colgroup><colgroup id="TBL-12-2g"><col 
id="TBL-12-2"></colgroup><colgroup id="TBL-12-3g"><col 
id="TBL-12-3"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-12-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-1-1"  
class="td11"> parameter                    </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-1-2"  
class="td11"> possible values                    </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-1-3"  
class="td11"> description                         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-2-1"  
class="td11"> <span 
class="ecti-1095">Simulation                   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-2-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-2-3"  
class="td11">                          </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-3-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;maxConsecutiveClash&#x0022; </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-3-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;2&#x0022; </span>or any integer </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-3-3"  
class="td11"> <span 
class="ecrm-1000">number of consecutive clashes</span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-4-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-4-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-4-3"  
class="td11"> <span 
class="ecrm-1000">before giving up                      </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-5-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-5-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-5-3"  
class="td11"> <span 
class="ecrm-1000">square approximation               </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-6-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;T0&#x0022;                  </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-6-2"  
class="td11"> ï¬‚oat                                 </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-6-3"  
class="td11"> <span 
class="ecrm-1000">simulation starting time           </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-7-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-7-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-7-3"  
class="td11"> <span 
class="ecrm-1000">(outputs convienience only)       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-8-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;seed&#x0022;                </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-8-2"  
class="td11"> any positive integer             </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-8-3"  
class="td11"> <span 
class="ecrm-1000">pseudo-random number            </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-9-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-9-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-9-3"  
class="td11"> <span 
class="ecrm-1000">generator seed                        </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-10-1"  
class="td11"> <span 
class="ecti-1095">Outputs                       </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-10-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-10-3"  
class="td11">                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-11-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;traceFileName&#x0022;       </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-11-2"  
class="td11"> string                                </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-11-3"  
class="td11"> <span 
class="ecrm-1000">outputs simulation trace           </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-12-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-12-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-12-3"  
class="td11"> <span 
class="ecrm-1000">in the given ï¬le                       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-13-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;outputFileName&#x0022;      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-13-2"  
class="td11"> string                                </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-13-3"  
class="td11"> <span 
class="ecrm-1000">data ï¬le name                        </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-14-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;plotPeriod&#x0022;          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-14-2"  
class="td11"> number then optionally        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-14-3"  
class="td11"> <span 
class="ecrm-1000">interval between                      </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-15-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-15-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-15-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;events&#x0022;                 </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-15-3"  
class="td11"> plot lines                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-16-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-16-1"  
class="td11"> <span 
class="ecti-1095">Causality analysis          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-16-2"  
class="td11"> <span 
class="ecbx-1095">Deprecated                   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-16-3"  
class="td11"> Please use KaStor                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-17-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-17-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;displayCompression&#x0022;  </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-17-2"  
class="td11"> any combination of              </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-17-3"  
class="td11"> <span 
class="ecrm-1000">type of compression                 </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-18-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-18-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-18-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;none&#x0022;, &#x0022;strong&#x0022;, &#x0022;weak&#x0022; </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-18-3"  
class="td11">                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-19-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-19-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;cflowFileName&#x0022;       </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-19-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;cflow&#x0022;</span>, any string             </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-19-3"  
class="td11"> <span 
class="ecrm-1000">ï¬le name preï¬x for causal ï¬‚ows  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-20-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-20-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;dotCflows&#x0022;           </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-20-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;no&#x0022;, &#x0022;html&#x0022;             </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-20-3"  
class="td11"> <span 
class="ecrm-1000">generate causal ï¬‚ows in html     </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-21-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-21-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-21-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;yes&#x0022;, &#x0022;dot&#x0022;             </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-21-3"  
class="td11"> <span 
class="ecrm-1000">generate causal ï¬‚ows in dot       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-22-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-22-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-22-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;json&#x0022;                   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-22-3"  
class="td11"> <span 
class="ecrm-1000">generate causal ï¬‚ows in json      </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-12-23-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-23-1"  
class="td11"> <span 
class="ecti-1095">Pretty printing              </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-23-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-23-3"  
class="td11">                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-24-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-24-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;dumpIfDeadlocked&#x0022;    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-24-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;no&#x0022;,&#x0022;yes&#x0022;               </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-24-3"  
class="td11"> <span 
class="ecrm-1000">Snapshot when simulation         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-25-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-25-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-25-2"  
class="td11">                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-25-3"  
class="td11"> <span 
class="ecrm-1000">is stalled                                </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-26-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-26-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;colorDot&#x0022;            </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-26-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;no&#x0022;, &#x0022;yes&#x0022;              </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-26-3"  
class="td11"> <span 
class="ecrm-1000">use colors in dot format ï¬les      </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-27-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-27-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;progressBarSymbol&#x0022;   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-27-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;#&#x0022; </span>or any character            </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-27-3"  
class="td11"> <span 
class="ecrm-1000">symbol for the progress bar       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-28-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-28-1"  
class="td11"> <span 
class="ectt-1095">&#x0022;progressBarSize&#x0022;     </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-28-2"  
class="td11"> <span 
class="ectt-1095">&#x0022;60&#x0022; </span>or any integer              </td><td  style="text-align:left; white-space:nowrap;" id="TBL-12-28-3"  
class="td11"> <span 
class="ecrm-1000">length of the progress bar         </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-12-29-"><td  style="text-align:left; white-space:nowrap;" id="TBL-12-29-1"  
class="td11">                       </td></tr></table></div>
                                                                                  

                                                                                  
</div><hr class="endfloat" />
</div>
                                                                                  

                                                                                  
<!--l. 1393--><p class="noindent" >
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 7</span><br /><a 
 id="x1-590007"></a>The <span 
class="ecss-1095">KaSa</span>Â static analyser</h2>
<h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-600007.1"></a>General usage</h3>
<!--l. 1397--><p class="noindent" >From a terminal window, <span 
class="ecss-1095">KaSa</span>Â can be invoked by typing
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSa file_1 ... file_n [option]</span></li></ul>
<!--l. 1401--><p class="noindent" >where <span 
class="ectt-1095">file_i </span>are the input Kappa ï¬les containing the rules, initial conditions and observables
(see ChapterÂ <a 
href="#x1-140003">3<!--tex4ht:ref: chap:kappa --></a>).
<!--l. 1403--><p class="noindent" >All the options are summarised as follows:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-3">
GeneralÂ options
Â <br />Â Â --helpÂ Â Â Â Â Â Â Â Â Â Â Â VerboseÂ help
Â <br />Â Â Â -hÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â ShortÂ help
Â <br />Â Â --versionÂ Â Â Â Â Â Â Â Â ShowÂ versionÂ number
Â <br />Â Â --guiÂ Â Â Â Â Â Â Â Â Â Â Â Â GUIÂ toÂ select
Â <br />Â Â --(no-)expertÂ Â Â Â Â ExpertÂ modeÂ (moreÂ options)
Â <br />
Â <br />Actions
Â <br />Â Â --do-all
Â <br />Â Â Â Â Â Â launchÂ everything
Â <br />Â Â --reset-all
Â <br />Â Â Â Â Â Â launchÂ nothing
Â <br />Â Â --(no-)compute-contact-mapÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â computeÂ theÂ contactÂ map
Â <br />Â Â --(no-)compute-influence-mapÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â computeÂ theÂ influenceÂ map
Â <br />Â Â --(no-)compute-ODE-flow-of-informationÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ flowÂ ofÂ informationÂ inÂ theÂ ODE
Â <br />Â Â Â Â Â Â semantics
Â <br />Â Â --(no-)compute-stochastic-flow-of-informationÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ flowÂ ofÂ informationÂ inÂ theÂ stochastic
Â <br />Â Â Â Â Â Â semantics
Â <br />Â Â --(no-)compute-reachability-analysisÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ statesÂ ofÂ agentÂ sites
Â <br />Â Â --(no-)compute-symmetriesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â LookÂ upÂ forÂ pairsÂ ofÂ symmetricÂ sites
Â <br />Â Â --(no-)compute-local-tracesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ theÂ localÂ tracesÂ ofÂ interestingÂ partsÂ ofÂ agentÂ interfaces
Â <br />Â Â --(no-)compute-separating-transitionsÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ theÂ transitionsÂ thatÂ separatesÂ stronglyÂ connectedÂ setÂ of
Â <br />Â Â Â Â Â Â configurations
Â <br />
Â <br />Output
Â <br />Â Â --output-directoryÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â DefaultÂ repositoryÂ forÂ outputs
Â <br />Â Â --output-contact-map-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ contactÂ mapÂ fileÂ inÂ thisÂ directory
                                                                                  

                                                                                  
Â <br />Â Â --output-contact-mapÂ &#x003C;name&#x003E;Â Â Â (default:Â contact)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ theÂ contactÂ mapÂ output
Â <br />Â Â --output-influence-map-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ influenceÂ mapÂ fileÂ inÂ thisÂ directory
Â <br />Â Â --output-influence-mapÂ &#x003C;name&#x003E;Â Â Â (default:Â influence)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ theÂ influenceÂ map
Â <br />Â Â --influence-map-formatÂ DOTÂ |Â DIMÂ |Â HTML
Â <br />Â (default:Â DOT)
Â <br />Â Â Â Â Â Â TuneÂ theÂ outputÂ formatÂ forÂ theÂ influenceÂ map
Â <br />Â Â --output-local-traces-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ filesÂ aboutÂ localÂ tracesÂ inÂ thisÂ directory
Â <br />Â Â --local-traces-formatÂ DOTÂ |Â HTML
Â <br />Â (default:Â DOT)
Â <br />Â Â Â Â Â Â TuneÂ theÂ outputÂ formatÂ forÂ theÂ localÂ transitionÂ systems
Â <br />Â Â --output-log-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ logÂ filesÂ inÂ thisÂ directory
Â <br />
Â <br />ReachabilityÂ analysis
Â <br />Â Â --(no-)compute-reachability-analysisÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ statesÂ ofÂ agentÂ sites
Â <br />Â Â --enable-every-domain
Â <br />Â Â Â Â Â Â enableÂ everyÂ abstractÂ domain
Â <br />Â Â --disable-every-domain
Â <br />Â Â Â Â Â Â disableÂ everyÂ abstractÂ domain
Â <br />Â Â --contact-map-domainÂ staticÂ |Â dynamic
Â <br />Â (default:Â dynamic)
Â <br />Â Â Â Â Â Â contactÂ mapÂ domainÂ isÂ usedÂ toÂ over-approximateÂ side-effects
Â <br />Â Â --(no-)views-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â enableÂ localÂ viewsÂ analysis
Â <br />Â Â --(no-)double-bonds-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â enableÂ doubleÂ bondsÂ analysis
Â <br />Â Â --(no-)sites-across-bonds-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â enableÂ theÂ analysisÂ ofÂ theÂ relationÂ amongÂ theÂ statesÂ ofÂ sitesÂ in
Â <br />Â Â Â Â Â Â connectedÂ agents
Â <br />Â Â --verbosity-level-for-reachability-analysisÂ MuteÂ |Â LowÂ |Â MediumÂ |Â HighÂ |
Â <br />Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Full
Â <br />Â (default:Â Low)
Â <br />Â Â Â Â Â Â TuneÂ theÂ verbosityÂ levelÂ forÂ theÂ reachabilityÂ analysis
Â <br />Â Â --output-mode-for-reachability-analysisÂ rawÂ |Â kappaÂ |Â english
Â <br />Â (default:Â kappa)
Â <br />Â Â Â Â Â Â post-processÂ relationÂ andÂ outputÂ theÂ resultÂ inÂ theÂ chosenÂ format
                                                                                  

                                                                                  
Â <br />
Â <br />TraceÂ analysis
Â <br />Â Â --(no-)compute-local-tracesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ theÂ localÂ tracesÂ ofÂ interestingÂ partsÂ ofÂ agentÂ interfaces
Â <br />Â Â --(no-)show-rule-names-in-local-tracesÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â AnnotateÂ eachÂ transitionÂ withÂ theÂ nameÂ ofÂ theÂ rulesÂ inÂ trace
Â <br />Â Â Â Â Â Â abstraction
Â <br />Â Â --(no-)use-macrotransitions-in-local-tracesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â UseÂ macrotransitionsÂ toÂ getÂ aÂ compactÂ traceÂ upÂ toÂ changeÂ ofÂ the
Â <br />Â Â Â Â Â Â interleavingÂ orderÂ ofÂ commutingÂ microtransitions
Â <br />Â Â --(no-)ignore-trivial-losangesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â DoÂ notÂ useÂ macrotransitionsÂ forÂ simplifyingÂ trivialÂ losanges
Â <br />Â Â --(no-)compute-separating-transitionsÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ theÂ transitionsÂ thatÂ separatesÂ stronglyÂ connectedÂ setÂ of
Â <br />Â Â Â Â Â Â configurations
Â <br />Â Â --output-local-traces-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ filesÂ aboutÂ localÂ tracesÂ inÂ thisÂ directory
Â <br />Â Â --local-traces-formatÂ DOTÂ |Â HTML
Â <br />Â (default:Â DOT)
Â <br />Â Â Â Â Â Â TuneÂ theÂ outputÂ formatÂ forÂ theÂ localÂ transitionÂ systems
Â <br />
Â <br />ContactÂ map
Â <br />Â Â --(no-)compute-contact-mapÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â computeÂ theÂ contactÂ map
Â <br />Â Â --output-contact-map-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ contactÂ mapÂ fileÂ inÂ thisÂ directory
Â <br />Â Â --output-contact-mapÂ &#x003C;name&#x003E;Â Â Â (default:Â contact)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ theÂ contactÂ mapÂ output
Â <br />Â Â --contact-map-accuracy-levelÂ LowÂ |Â High
Â <br />Â (default:Â Low)
Â <br />Â Â Â Â Â Â TuneÂ theÂ accuracyÂ levelÂ ofÂ theÂ contactÂ map
Â <br />Â Â --(no-)pure-contactÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â showÂ inÂ theÂ contactÂ mapÂ onlyÂ theÂ sitesÂ withÂ aÂ bindingÂ state
Â <br />
Â <br />InfluenceÂ map
Â <br />Â Â --(no-)compute-influence-mapÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â computeÂ theÂ influenceÂ map
Â <br />Â Â --influence-map-accuracy-levelÂ IndirectÂ |Â DirectÂ |Â Realisable
Â <br />Â (default:Â Direct)
Â <br />Â Â Â Â Â Â TuneÂ theÂ accuracyÂ levelÂ ofÂ theÂ influenceÂ map
Â <br />Â Â --output-influence-map-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
                                                                                  

                                                                                  
Â <br />Â Â Â Â Â Â putÂ theÂ influenceÂ mapÂ fileÂ inÂ thisÂ directory
Â <br />Â Â --output-influence-mapÂ &#x003C;name&#x003E;Â Â Â (default:Â influence)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ theÂ influenceÂ map
Â <br />Â Â --influence-map-formatÂ DOTÂ |Â DIMÂ |Â HTML
Â <br />Â (default:Â DOT)
Â <br />Â Â Â Â Â Â TuneÂ theÂ outputÂ formatÂ forÂ theÂ influenceÂ map
Â <br />
Â <br />FlowÂ ofÂ information
Â <br />Â Â --(no-)compute-ODE-flow-of-informationÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ flowÂ ofÂ informationÂ inÂ theÂ ODE
Â <br />Â Â Â Â Â Â semantics
Â <br />Â Â --(no-)compute-stochastic-flow-of-informationÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â ComputeÂ anÂ approximationÂ ofÂ theÂ flowÂ ofÂ informationÂ inÂ theÂ stochastic
Â <br />Â Â Â Â Â Â semantics
Â <br />
Â <br />DebuggingÂ information
Â <br />Â Â --output-log-directoryÂ &#x003C;name&#x003E;Â Â Â (default:Â output)
Â <br />Â Â Â Â Â Â putÂ theÂ logÂ filesÂ inÂ thisÂ directory
Â <br />Â Â --(no-)debugÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â dumpÂ debuggingÂ information
Â <br />Â Â --(no-)unsafe-modeÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â exceptionsÂ areÂ gatheredÂ atÂ theÂ endÂ ofÂ theÂ computation,Â insteadÂ of
Â <br />Â Â Â Â Â Â haltingÂ it
Â <br />Â Â --(no-)print-efficiencyÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â promptÂ CPUÂ timeÂ andÂ variousÂ datas
Â <br />
Â <br />(57Â options)</div>
<!--l. 149--><p class="nopar" >
<!--l. 1406--><p class="noindent" >Order in options matters, since they can be used to toggle on/oï¬€ some functionalities or to
assign a value to some environment variables. The options are interpreted from left to
right.
<!--l. 1409--><p class="noindent" >More options are available in the OCaml ï¬le <span 
class="ectt-1095">KaSa_rep/config/config.ml </span>and can be tuned
before compilation.
<!--l. 1411--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-610007.2"></a>Graphical interface</h3>
                                                                                  

                                                                                  
<!--l. 1413--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.2.1   </span> <a 
 id="x1-620007.2.1"></a>Launching the interface</h4>
<!--l. 1415--><p class="noindent" >The graphical interface can be launched by typing
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaSa</span></li></ul>
<!--l. 1418--><p class="noindent" >without any option.
<!--l. 1420--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-620011"></a>
                                                                                  

                                                                                  

<!--l. 1422--><p class="noindent" ><img 
src="img/kasa_0.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.1: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Actions</span></span></div><!--tex4ht:label?: x1-620011 -->
                                                                                  

                                                                                  
<!--l. 1425--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">7.2.2   </span> <a 
 id="x1-630007.2.2"></a>The areas of interest</h4>
<!--l. 1429--><p class="noindent" >There are ï¬ve diï¬€erent areas of importance in the graphical interface:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-63002x1">On the top left of the window, a button allows for the selection between the Normal
     and the Expert mode (other modes may be available if activated at compilation). In
     expert mode, more options are available in the graphical interface.
     </li>
     <li 
  class="enumerate" id="x1-63004x2">On the top center/right, some button allows for the selection of the tab. There are
     currently six sub-tabs available: <span 
class="ectt-1095">Actions</span>, <span 
class="ectt-1095">Output</span>, <span 
class="ectt-1095">Reachability analysis</span>, <span 
class="ectt-1095">Trace</span>
     <span 
class="ectt-1095">analysis</span>, <span 
class="ectt-1095">Contact map</span>, <span 
class="ectt-1095">Influence map</span>.
     </li>
     <li 
  class="enumerate" id="x1-63006x3">Center: The options of the selected sub-tab are displayed and can be tuned.
     <!--l. 1437--><p class="noindent" >Contextual help is provided when the mouse is hovered over an element.
     <!--l. 1439--><p class="noindent" >The interface will store the options that are checked or ï¬lled and the order in which
     they have been selected. When launched, the analysis interprets these options in the
     order they have been entered.
     <!--l. 1442--><p class="noindent" >Some options appear in several sub-tabs. They denote the same option and share the
     same value.
     </li>
     <li 
  class="enumerate" id="x1-63008x4">File selector: The ï¬le selector can be used to upload as many kappa ï¬les as desired.
     The button &#x2019;<span 
class="ectt-1095">Clear</span>&#x2019; can be used to reset the selection of ï¬les.
     </li>
     <li 
  class="enumerate" id="x1-63010x5">Bottom: Some buttons are available. The button &#x2019;<span 
class="ectt-1095">Quit</span>&#x2019; can be used to leave the
     interface. The button &#x2019;<span 
class="ectt-1095">Reset to default</span>&#x2019; tunes all the options to their default value.
     The button &#x2019;<span 
class="ectt-1095">Import options</span>&#x2019; can be used to restore the value of the options as saved
     during a previous session of the graphical interfaces. The button &#x2019;<span 
class="ectt-1095">Save options</span>&#x2019; can
     be used to save the value of the options for a further session. The button &#x2019;<span 
class="ectt-1095">Launch</span>
     <span 
class="ectt-1095">analyze</span>&#x2019; launch <span 
class="ecss-1095">KaSa</span>Â with the current options.
     <!--l. 1447--><p class="noindent" >Importantly, options are saved automatically under various occasions. Thus, it is
     possible to restore the value of the options before the last reset, before the last quit,
     or before the last analysis.</li></ol>
                                                                                  

                                                                                  
<!--l. 1451--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.2.3   </span> <a 
 id="x1-640007.2.3"></a>The sub-tab <span 
class="ectt-1095">Actions</span></h4>
<!--l. 1453--><p class="noindent" >The sub-tab <span 
class="ectt-1095">Actions </span>(see Fig.Â <a 
href="#x1-620011">7.1<!--tex4ht:ref: fig:kasa:0 --></a>) contains the main actions which can be performed.
     <ul class="itemize1">
     <li class="itemize">The button <span 
class="ectt-1095">--do-all </span>activates all the functionalities.
     </li>
     <li class="itemize">The button <span 
class="ectt-1095">--reset-all </span>inactivates all the functionalities.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--compute-contact-map </span>can be used to (des)activate the computation of
     the contact map.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--compute-influence-map </span>can be used to (des)activate the computation
     of the inï¬‚uence map.
     </li>
     <li class="itemize">The  option  <span 
class="ectt-1095">--compute-reachability-analysis </span>can  be  used  to  (des)activate  the
     computation of the reachability analysis.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--compute-local-traces </span>can be used to (des)activate the computation
     of the trace analysis.</li></ul>
<!--l. 1464--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.2.4   </span> <a 
 id="x1-650007.2.4"></a>The sub-tab <span 
class="ectt-1095">Output</span></h4>
<!--l. 1466--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-650012"></a>
                                                                                  

                                                                                  

<!--l. 1468--><p class="noindent" ><img 
src="img/kasa_1.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.2: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">output</span></span></div><!--tex4ht:label?: x1-650012 -->
                                                                                  

                                                                                  
<!--l. 1471--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1474--><p class="noindent" >The sub-tab <span 
class="ectt-1095">Ouput </span>(see Fig.Â <a 
href="#x1-650012">7.2<!--tex4ht:ref: fig:kasa:1 --></a>) contains the names of the output ï¬les and their format.
     <ul class="itemize1">
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-directory </span>can be used to set the repository where output ï¬le
     are written. <span 
class="ecss-1095">KaSa</span>Â will create this repository, if it does not exist.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-contact-map-directory </span>can be used to set the reporitory where
     the output ï¬le for the contact map is written, if a contact map is requested. <span 
class="ecss-1095">KaSa</span>Â will
     create this repository, if it does not exist.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-contact-map </span>contains the name of the ï¬le for the contact map. If
     the ï¬le name does not end by it, the proper extension will be added to the ï¬le name.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-influence-map-directory </span>can be used to set the reporitory
     where the output ï¬le for the inï¬‚uence map is written, if an inï¬‚uence map is requested.
     <span 
class="ecss-1095">KaSa</span>Â will create this repository, if it does not exist.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-influence-map </span>contains the name of the ï¬le for the inï¬‚uence
     map. If the ï¬le name does not end by it, the proper extension will be added to the
     ï¬le name.
     </li>
     <li class="itemize">The format for the inï¬‚uence map can be chosen among <span 
class="ectt-1095">DOT </span>and <span 
class="ectt-1095">HTML </span>thanks to the
     option <span 
class="ectt-1095">--influence-map-format</span>.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-local-traces-directory </span>can be used to set the reporitory where
     the output ï¬le for the result of trace analysis is written, if this analysis is requested.
     <span 
class="ecss-1095">KaSa</span>Â will create this repository, if it does not exist.
     </li>
     <li class="itemize">The format for the local traces can be chosen among <span 
class="ectt-1095">DOT </span>and <span 
class="ectt-1095">HTML </span>thanks to the
     option <span 
class="ectt-1095">--local-traces-format</span>.
     </li></ul>
<!--l. 1489--><p class="noindent" >When a ï¬le already exists, it is overwritten without any warning.
                                                                                  

                                                                                  
<h3 class="sectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-660007.3"></a>Reachability analysis</h3>
<!--l. 1493--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660013"></a>
                                                                                  

                                                                                  

<!--l. 1495--><p class="noindent" ><img 
src="img/kasa_2.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.3: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Reachability_analysis</span></span></div><!--tex4ht:label?: x1-660013 -->
                                                                                  

                                                                                  
<!--l. 1498--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1500--><p class="noindent" >Reachability analysis aimed at detecting statically properties about the bio-molecular species that
can be formed in a model. Knowing whether, or not, a given bio-molecular species, can be formed
in a model is an undecidable problem <span class="cite">[<span 
class="ecbx-1095">?</span>]</span>. Thus, our analysis is approximate. Indeed, it computes
an over-approximation of the set of the bio-molecular species that can be reached from the initial
state of the model, by applying an unbounded number of computation steps. As formalized in
<span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span>, the abstraction consists in:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-66003x1">ï¬rstly, ignoring the number of occurrences of bio-molecular species (we assume that
     whenever a bio-molecular species can be formed, then it can be formed as many time
     as it could be necessary),
     </li>
     <li 
  class="enumerate" id="x1-66005x2">secondly, abstracting a bio-molecular species by the set of its properties.</li></ol>
<!--l. 1506--><p class="noindent" >The analysis takes into account also the chemical species that may be introduced in a
perturbation.
<!--l. 1508--><p class="noindent" >The classes of properties of interest are encoded in so called abstract domains, which can be
independently enabled/disabled. The whole analysis can be understood as a mutual recursion
between smaller analyses (one per abstract domain), that communicates information between
each other at each step of the analysis. We took the same scheme of collaboration between
abstract domains as in <span class="cite">[<span 
class="ecbx-1095">?</span>]</span>.
<!--l. 1512--><p class="noindent" >As an example, we consider the following model: <!--l. 1513-->
<div class="lstlisting" id="listing-29"><span class="label"><a 
 id="x1-66006r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66007r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66008r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66009r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66010r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66011r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66012r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66013r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">E/R</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">E</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66014r9"></a><span 
class="ecrm-0600">9</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!_,c!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66015r10"></a><span 
class="ecrm-0600">10</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">R/R</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66016r11"></a><span 
class="ecrm-0600">11</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">int</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr!2,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">c!1,cr,n!2</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66017r12"></a><span 
class="ecrm-0600">12</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">R/int</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">cr!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">n!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">cr</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-66018r13"></a><span 
class="ecrm-0600">13</span></span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">obs</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c,cr!_,n!_</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">R</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x,c,cr,n</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span>
</div>
<!--l. 1529--><p class="noindent" >Typing the following instruction:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-4">
KaSaÂ reachability.kaÂ --reset-allÂ --compute-reachability-analysis</div>
<!--l. 1532--><p class="nopar" >
<!--l. 1534--><p class="noindent" >will perform the reachability analysis on the model <span 
class="ectt-1095">reachability.ka</span>.
<!--l. 1536--><p class="noindent" >We obtain the following result:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-5">
KappaÂ StaticÂ AnalyzerÂ (03078c3)Â (withoutÂ TkÂ interface)
Â <br />AnalysisÂ launchedÂ atÂ 2017/05/28Â 20:53:28Â (GMT+0)Â on
Â <br />testing-gce-72eb6219-036a-4830-9e48-c1699a3d1ba2
Â <br />ParsingÂ ../kappa/reachability.ka...
Â <br />done
Â <br />Compiling...
Â <br />ReachabilityÂ analysis...
Â <br />
Â <br />------------------------------------------------------------
Â <br />*Â ThereÂ areÂ someÂ nonÂ applyableÂ rules
Â <br />------------------------------------------------------------
Â <br />ruleÂ obsÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 13,
Â <br />charactersÂ 5-39:)Â willÂ neverÂ beÂ applied.
Â <br />------------------------------------------------------------
Â <br />everyÂ agentÂ mayÂ occurÂ inÂ theÂ model
Â <br />
Â <br />------------------------------------------------------------
Â <br />*Â NonÂ relationalÂ properties:
Â <br />------------------------------------------------------------
Â <br />E()Â =&#x003E;Â [Â E(x)Â vÂ E(x!R.x)Â ]
Â <br />R()Â =&#x003E;Â [Â R(c)Â vÂ R(c!R.c)Â ]
Â <br />R()Â =&#x003E;Â [Â R(n)Â vÂ R(n!R.cr)Â ]
Â <br />R()Â =&#x003E;Â [Â R(cr)Â vÂ R(cr!R.n)Â ]
Â <br />R()Â =&#x003E;Â [Â R(x)Â vÂ R(x!E.x)Â ]
Â <br />
Â <br />------------------------------------------------------------
Â <br />*Â RelationalÂ properties:
Â <br />------------------------------------------------------------
Â <br />R()Â =&#x003E;
Â <br />Â Â Â [
Â <br />Â Â R(c,cr,n,x!E.x)
Â <br />vÂ R(c!R.c,cr!R.n,n,x!E.x)
Â <br />vÂ R(c!R.c,cr,n,x!E.x)
Â <br />vÂ R(c!R.c,cr,n!R.cr,x!E.x)
Â <br />vÂ R(c,cr,n,x)
Â <br />Â Â Â ]
Â <br />------------------------------------------------------------
                                                                                  

                                                                                  
Â <br />*Â PropertiesÂ inÂ connectedÂ agents
Â <br />------------------------------------------------------------
Â <br />R(c!1),R(c!1)Â =&#x003E;
Â <br />[
Â <br />Â Â R(c!1,cr!R.n),R(c!1,cr)
Â <br />vÂ R(c!1,cr),R(c!1,cr)
Â <br />vÂ R(c!1,cr),R(c!1,cr!R.n)
Â <br />]
Â <br />R(c!1),R(c!1)Â =&#x003E;
Â <br />[
Â <br />Â Â R(c!1,n!R.cr),R(c!1,n)
Â <br />vÂ R(c!1,n),R(c!1,n)
Â <br />vÂ R(c!1,n),R(c!1,n!R.cr)
Â <br />]
Â <br />------------------------------------------------------------
Â <br />*Â PropertiesÂ ofÂ pairsÂ ofÂ bonds
Â <br />------------------------------------------------------------
Â <br />R(c!R.c,cr!R.n)Â =&#x003E;Â R(c!1,cr!2),R(c!1,n!2)
Â <br />R(c!R.c,n!R.cr)Â =&#x003E;Â R(c!1,n!2),R(c!1,cr!2)
Â <br />executionÂ finishedÂ withoutÂ anyÂ exception</div>
<!--l. 59--><p class="nopar" >
<!--l. 1541--><p class="noindent" >This result is displayed in the standard output, and it is made of six parts.
<!--l. 1543--><p class="noindent" >The ï¬rst two parts provide an enumeration of dead rules and dead agents. The next parts display
what we call reï¬nement lemmas. A reï¬nement lemma is made of a precondition (on
the left of the implication symbol) that is a site graph, and a postcondition (on the
right of the implication symbol) that is a list of site graphs. Each site graph in the
post-condition is a reï¬nement of the precondition (the position of agent matters: the
<!--l. 1545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>-th agent in the precondition
corresponds to the <!--l. 1545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>-th
agent in each site graph in the postcondition, but site graphs in a postcondition may have more
agents than the site graph in the corresponding precondition). The meaning of a reï¬nement
lemma is that every embedding between its precondition into a reachable state can be
reï¬ned/extended into an embedding from one site graph in its postcondition into the same
reachable state. This way, a reï¬nement lemma provides an enumeration of all the potential
contexts for the precondition.
<!--l. 1549--><p class="noindent" >We now detail the six diï¬€erent parts:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ecbx-1095">Detection of dead rules. </span>A rule is called dead, if there is no trace starting from the
                                                                                  

                                                                                  
     initial state in which this rule is applied. The analysis reports the list of the rules it
     has detected to be dead. Due to the over-approximation, it may happen that a dead
     rule is not discovered by the analysis. Yet, every rule that is reported as dead, is dead
     indeed.
     <!--l. 1553--><p class="noindent" >In our example, we notice that the rule â€˜<span 
class="ectt-1095">obs</span>&#x2019; can never be trigered.
     </li>
     <li class="itemize"><span 
class="ecbx-1095">Detection of dead agents. </span>An agent is called dead, if there is no trace starting from
     the initial state with at least one state in which this agent occurs. The analysis reports
     the list of the agents it has detected to be dead. Due to the over-approximation, it
     may happen that a dead agent is not discovered by the analysis. Yet, every agent that
     is reported as dead, is dead indeed.
     <!--l. 1557--><p class="noindent" >In our example, there are no dead agent.
     </li>
     <li class="itemize"><span 
class="ecbx-1095">Non-relational  properties. </span>The  analysis  detects  for  each  kind  of  site,  the  set
     of states this site can take. Due to the over-approximation, the analysis reports a
     super-set of the set of the potential states. Yet, we are sure that a given site only take
     states within this set.
     <!--l. 1562--><p class="noindent" >In our example, the site <span 
class="ectt-1095">cr </span>of <span 
class="ectt-1095">R </span>may be free, or bound to the site <span 
class="ectt-1095">n </span>of an agent <span 
class="ectt-1095">R</span>.
     </li>
     <li class="itemize"><span 
class="ecbx-1095">Relational properties. </span>The analysis detects some relationships among the states
     of packs of sites within each agent, hence capturing potential valuations for local
     views <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span>. Due to the over-approximation of the analysis, the analysis may fail
     in discovering a relationship. But each relationship that is found by the analysis, is
     satisï¬ed.
     <!--l. 1568--><p class="noindent" >In our example, the states of the sites <span 
class="ectt-1095">c</span>, <span 
class="ectt-1095">cr</span>, <span 
class="ectt-1095">n</span>, and <span 
class="ectt-1095">x </span>of <span 
class="ectt-1095">R </span>are entangled with a relational
     property (othewise, we would have <!--l. 1568--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>5</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     elements in the post-condition).
     </li>
     <li class="itemize"><span 
class="ecbx-1095">Properties in connected agent. </span>When two agents are connected, there may be a
     relation among the states of theirs respective sites. This abstraction <span class="cite">[<span 
class="ecbx-1095">?</span>]</span> collects for
     each kind of bonds, the relation between the state of one site in the ï¬rst agent and
     the state of one site in the second agent. Due to the over-approximation, the analysis
     reports a super-set of the set of the potential pairs of states.
     <!--l. 1574--><p class="noindent" >This abstraction aimed at capturing information about protein transportation. It is
     quite common to model the location of a protein as the internal state of a ï¬ctitious
     site. With such an encoding, it might be important to ensure that two connected
                                                                                  

                                                                                  
     proteins, are always located in the same location. This abstraction focuses on this
     kind of properties.
     </li>
     <li class="itemize"><span 
class="ecbx-1095">Properties of pairs of bonds.</span>
     <!--l. 1579--><p class="noindent" >It might be interesting to know whether a protein can be bound to another protein
     twice simultaneously, and whether a protein can be bound to two instances of a same
     protein simultaneously. This abstraction <span class="cite">[<span 
class="ecbx-1095">?</span>]</span> captures this kind of constraint. It can
     be used to prove that some proteins do not polymerize.
     <!--l. 1581--><p class="noindent" >In our example, when a <span 
class="ectt-1095">R </span>has its sites <span 
class="ectt-1095">cr </span>and <span 
class="ectt-1095">c </span>bound, they are necessarily bound to
     the same instance of <span 
class="ectt-1095">R</span>. The same statement holds for the sites <span 
class="ectt-1095">cr </span>and <span 
class="ectt-1095">n</span>.</li></ul>
<!--l. 1587--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660194"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-6">
KappaÂ StaticÂ AnalyzerÂ (03078c3)Â (withoutÂ TkÂ interface)
Â <br />AnalysisÂ launchedÂ atÂ 2017/05/28Â 20:53:28Â (GMT+0)Â on
Â <br />testing-gce-72eb6219-036a-4830-9e48-c1699a3d1ba2
Â <br />ParsingÂ ../kappa/reachability.ka...
Â <br />done
Â <br />Compiling...
Â <br />ReachabilityÂ analysis...
Â <br />executionÂ finishedÂ withoutÂ anyÂ exception</div>
<!--l. 10--><p class="nopar" >
<br /><div class="caption" 
><span class="id">FigureÂ 7.4: </span><span  
class="content">Reachability analysis of the model <span 
class="ectt-1095">reachbility.ka </span>with verbosity level â€œMuteâ€.</span></div><!--tex4ht:label?: x1-660194 -->
                                                                                  

                                                                                  
<!--l. 1591--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1597--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660205"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-7">
ApplyingÂ ruleÂ obsÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 13,Â characters
Â <br />5-39:):
Â <br />theÂ preconditionÂ isÂ notÂ satisfiedÂ yet</div>
<!--l. 5--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.5: </span><span  
class="content">Reachability analysis: one rule that cannot be applied yet, according to the
bio-molecular species already constructed.</span></div><!--tex4ht:label?: x1-660205 -->
                                                                                  

                                                                                  
<!--l. 1601--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1603--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660216"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-8">
ApplyingÂ ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,Â characters
Â <br />5-35:):
Â <br />theÂ preconditionÂ isÂ satisfied</div>
<!--l. 5--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.6: </span><span  
class="content">Reachability analysis: one rule successfully applied</span></div><!--tex4ht:label?: x1-660216 -->
                                                                                  

                                                                                  
<!--l. 1607--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1609--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660227"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-9">
ViewsÂ inÂ initialÂ state:
Â <br />
Â <br />E(x!free)
Â <br />--
Â <br />ViewsÂ inÂ initialÂ state:
Â <br />
Â <br />R(x!free,c!free,cr!free,n!free)</div>
<!--l. 9--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.7: </span><span  
class="content">Reachability analysis: extensional description of initial states.</span></div><!--tex4ht:label?: x1-660227 -->
                                                                                  

                                                                                  
<!--l. 1613--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1615--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660238"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-10">
ApplyingÂ ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,Â characters
Â <br />5-35:):
Â <br />theÂ preconditionÂ isÂ satisfied
Â <br />
Â <br />ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,Â characters
Â <br />5-35:)Â isÂ appliedÂ forÂ theÂ firstÂ time
Â <br />
Â <br />UpdatingÂ theÂ viewsÂ forÂ E(x!)
Â <br />
Â <br />E(x!R@x)
Â <br />
Â <br />
Â <br />UpdatingÂ theÂ viewsÂ forÂ R(x!,c!,cr!,n!)
Â <br />
Â <br />R(x!E@x,c!free,cr!free,n!free)
Â <br /></div>
<!--l. 19--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.8: </span><span  
class="content">Reachability analysis: extensional description of the new patterns created when
applying a rule.</span></div><!--tex4ht:label?: x1-660238 -->
                                                                                  

                                                                                  
<!--l. 1619--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1621--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-660249"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-11">
ApplyingÂ ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,Â characters
Â <br />5-35:):
Â <br />theÂ preconditionÂ isÂ satisfied
Â <br />
Â <br />ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,Â characters
Â <br />5-35:)Â isÂ appliedÂ forÂ theÂ firstÂ time
Â <br />(ruleÂ E/RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â line
Â <br />8,Â charactersÂ 5-39:))Â shouldÂ beÂ investigated
Â <br />
Â <br />(ruleÂ E/RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â line
Â <br />8,Â charactersÂ 5-39:))Â shouldÂ beÂ investigated
Â <br />
Â <br />
Â <br />UpdatingÂ theÂ viewsÂ forÂ E(x!)
Â <br />
Â <br />E(x!R@x)
Â <br />
Â <br />
Â <br />UpdatingÂ theÂ viewsÂ forÂ R(x!,c!,cr!,n!)
Â <br />
Â <br />R(x!E@x,c!free,cr!free,n!free)
Â <br />
Â <br />(ruleÂ E.RÂ (FileÂ &#x0022;../kappa/reachability.ka&#x0022;,Â lineÂ 7,
Â <br />charactersÂ 5-35:))Â shouldÂ beÂ investigated
Â <br /></div>
<!--l. 27--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.9: </span><span  
class="content">Reachability analysis: discovering new patterns force the analysis to apply
some rules again, until reaching a ï¬x-point.</span></div><!--tex4ht:label?: x1-660249 -->
                                                                                  

                                                                                  
<!--l. 1625--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1627--><p class="noindent" >Now we describe the options that are available on this sub-tab.
<!--l. 1629--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--compute-reachability-analysis</span></span></span> can be used to switch on/oï¬€ then reachability
analysis.
<!--l. 1631--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--enable-every-domain</span></span></span> can be used to switch on every abstract domain,
whereas the option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--disable-every-domain</span></span></span> can be used to switch oï¬€ every abstract
domain.
<!--l. 1633--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--contact-map-domain</span></span></span> impacts the way side-eï¬€ects are handled with during the
analysis. In <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">static</span></span></span> mode, we consider that every bond that occurs syntactically in initial state, in
the rhs of a rule, or in a introduction directive of a perturbation, may be released by side-eï¬€ects.
In <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">dynamic</span></span></span> mode, only the bond that has been encountered so far during the analysis are
considered.
<!--l. 1636--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--views-domain</span></span></span> can be used to switch on/oï¬€ the views domains that combine the
non-relational analysis and the relational analysis.
<!--l. 1638--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--double-bonds-domain</span></span></span> can be used to switch on/oï¬€ the analysis of potential double
bonds between between proteins.
<!--l. 1640--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--site-across-bonds-domain</span></span></span> can be used to switch on/oï¬€ the analysis of the
relations among the states of the sites in connected proteins.
<!--l. 1643--><p class="noindent" >It is possible to get more details about the computation of the analysis by tuning the verbosity
level of the view analysis:
     <ul class="itemize1">
     <li class="itemize">With the option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--verbosity-level-for-reachability-analysis</span><span 
class="ectt-1095">Â Mute</span></span></span>, nothing is
     displayed. Even the result of the analysis is omitted (eg.Â see Fig.Â <a 
href="#x1-660194">7.4<!--tex4ht:ref: fig:reachability_mute --></a>).
     </li>
     <li class="itemize">With  the  option  <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--verbosity-level-for-reachability-analysis</span><span 
class="ectt-1095">Â Low</span></span></span>,  only  the
     result of the analysis is displayed (by default).
     </li>
     <li class="itemize">With  the  option  <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--verbosity-level-for-reachability-analysis</span><span 
class="ectt-1095">Â Medium</span></span></span>,  the
     analysis also describes which rules are applied and in which order.
     <!--l. 1651--><p class="noindent" >When trying to apply a rule, the analysis may detect that the rule cannot be applied
     yet because the precondition is not satisï¬ed at the current state of the iteration
     (eg.Â see Fig.Â <a 
href="#x1-660205">7.5<!--tex4ht:ref: fig:reachability_medium_ko --></a>). Otherwise, the analysis can apply the rule and update the state of
     the iteration accordingly (eg.Â see Fig.Â <a 
href="#x1-660216">7.6<!--tex4ht:ref: fig:reachability_medium_ok --></a>).
     </li>
                                                                                  

                                                                                  
     <li class="itemize">With   the   option   <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--verbosity-level-for-reachability-analysis</span><span 
class="ectt-1095">Â High</span></span></span>,   the
     analysis also describes which patterns are discovered.
     <!--l. 1657--><p class="noindent" >In particular, at the beginning of the iteration, the analysis prompts the patterns of
     interest that occur in initial state (eg.Â see Fig.Â <a 
href="#x1-660227">7.7<!--tex4ht:ref: fig:reachability_high_init --></a>). Then, each time a rule is applied
     successfully, the analysis shows which new patterns have been discovered (eg.Â see
     Fig.Â <a 
href="#x1-660238">7.8<!--tex4ht:ref: fig:reachability_high_rule --></a>).
     </li>
     <li class="itemize">When new patterns are discovered, then, it is necessary to apply again any rule that
     may operate over these patterns.
     <!--l. 1662--><p class="noindent" >With   the   option   <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--verbosity-level-for-reachability-analysis</span><span 
class="ectt-1095">Â Full</span></span></span>,   the
     analysis also describes which rules are awaken by the discovery of a new pattern (see
     Fig.Â <a 
href="#x1-660249">7.9<!--tex4ht:ref: fig:reachability_full --></a>).
     </li></ul>
<!--l. 1666--><p class="noindent" >The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--output-mode-for-reachability-analysis</span></span></span> can be used to tune the
output of the analysis. The default mode is <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">kappa</span></span></span>. In mode, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">raw</span></span></span>, patterns of interest are
displayed extensionally. In mode, <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">english</span></span></span>, properties of interest are explained in English.
The option <span class="obeylines-h"><span class="verb"><span 
class="ectt-1095">--use-natural-language</span></span></span> can be used to switch on/oï¬€ the translation of
properties in natural language: when the option is disabled, each relationship is described in
extension.
<h3 class="sectionHead"><span class="titlemark">7.4   </span> <a 
 id="x1-670007.4"></a>Local traces</h3>
<!--l. 1675--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6700110"></a>
                                                                                  

                                                                                  

<!--l. 1677--><p class="noindent" ><img 
src="img/kasa_3.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.10: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Trace analysis</span></span></div><!--tex4ht:label?: x1-6700110 -->
                                                                                  

                                                                                  
<!--l. 1680--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1682--><p class="noindent" >Trace analysis is a reï¬nement of reachability analysis that additionaly explains how one agent can
go from a given view to another one, following a path that we call a local trace. Thus the set of
the local traces for a given agent can be described as a transition system among the views for a
given agent: in this transition system, the nodes are local views; introduction arrows correspond
to either initial states, or creation rules; transitions denote a potential conformation change
of an agent, from one local views to another one, due to the application of a given
rule.
<!--l. 1685--><p class="noindent" >We consider the following example: <!--l. 1686-->
<div class="lstlisting" id="listing-30"><span class="label"><a 
 id="x1-67002r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67003r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">1</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">K</span><span 
class="ectt-1095">()</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67004r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67005r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a1</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67006r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b1</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,b1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,b1~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67007r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a1-</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,b1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~u,b1~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67008r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b1-</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b1~p,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b1~u,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67009r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a2</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">tab:siga2~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a2~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67010r9"></a><span 
class="ecrm-0600">9</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">a2-</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a2~p,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a2~u,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67011r10"></a><span 
class="ecrm-0600">10</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b2</span><span 
class="ectt-1095">+</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a2~p,b2~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a2~p,b2~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67012r11"></a><span 
class="ecrm-0600">11</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">b2-</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b2~p,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">b2~u,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67013r12"></a><span 
class="ecrm-0600">12</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">.</span><span 
class="ectt-1095">K</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,a2~p,b1~p,b2~p,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,a2~p,b1~p,b2~p,g!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-67014r13"></a><span 
class="ecrm-0600">13</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">P/K</span><span 
class="ectt-1095">&#x2019;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,a2~p,b1~p,b2~p,g!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x!1</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">P</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">a1~p,a2~p,b1~p,b2~p,g</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">,K</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span>
</div>
<!--l. 1702--><p class="noindent" >Typing the following instruction:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-12">
KaSaÂ protein2x2.kaÂ --reset-allÂ --compute-local-traces</div>
<!--l. 1706--><p class="nopar" >
<!--l. 1708--><p class="noindent" >will perform the trace analysis on the model <span 
class="ectt-1095">protein2x2ka</span>, and produce two dot format ï¬les
<span 
class="ectt-1095">Agent_trace_K_x^.dot </span>and <span 
class="ectt-1095">Agent_trace.P.a1_.a2_.b1_.b2_.g^.dot</span>. The output
repository can be changed thanks to the command line options <span 
class="ectt-1095">--output-directory </span>and
<span 
class="ectt-1095">--output-local-trace-directory</span>. Moreover, ï¬le names is made of the preï¬x <span 
class="ectt-1095">Agent_trace</span>,
followed by the kind of protein and the list of the sites of interest (the symbol â€˜<span 
class="ectt-1095">^</span>&#x2019; denotes a
binding state, and the symbol â€˜<span 
class="ectt-1095">_</span>&#x2019; an internal state).
<!--l. 1711--><p class="noindent" >The transition system that describes the local traces for the agents of kind
<!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi></math> is descrided in
Figure <a 
href="#x1-6701511">7.11<!--tex4ht:ref: fig:trace-raw --></a>. We notice that the nodes of this transition system are labelled with the states of the sites of
<!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi></math>. The internal state
of a site <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is denoted
as <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi><mo 
class="MathClass-rel">âˆ¼</mo><mi 
>u</mi></math> (meaning that
the site <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> has state
<!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>u</mi></math>, whereas the binding
state of a site <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is
denoted as <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi><mo 
class="MathClass-punc">!</mo><mstyle 
class="text"><mtext class="textit" mathvariant="italic" >free</mtext></mstyle></math>, when
the site is free, and as <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi><mo 
class="MathClass-punc">!</mo><mi 
>K</mi><mi 
>@</mi><mi 
>x</mi></math>
when the site <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is bound
to the site <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> of a given
agent of kind <!--l. 1711--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>.
<!--l. 1713--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6701511"></a>
                                                                                  

                                                                                  

<!--l. 1715--><p class="noindent" ><img 
src="generated_img/trace_raw.png" alt="PIC"  
width="284.52756pt" height="150.689pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.11: </span><span  
class="content">Local traces for the <span 
class="ectt-1095">protein2x2.ka </span>model deï¬ned in SectionÂ <a 
href="#x1-670007.4">7.4<!--tex4ht:ref: sec:local-traces --></a></span></div><!--tex4ht:label?: x1-6701511 -->
                                                                                  

                                                                                  
<!--l. 1718--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1720--><p class="noindent" >We notice that the transition system that is given in Fig.Â <a 
href="#x1-6701511">7.11<!--tex4ht:ref: fig:trace-raw --></a> contains too many nodes. We can
coarse-grain this transition system thanks to the following option:
<div class="center" 
>
<!--l. 1721--><p class="noindent" >
<!--l. 1722--><p class="noindent" ><span 
class="ectt-1095">--use-macrotransitions-in-local-traces</span>.</div>
<!--l. 1724--><p class="noindent" >Typing the following instruction:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-13">
KaSaÂ protein2x2.kaÂ --reset-allÂ --compute-local-traces
Â <br />Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â --use-macrotransitions-in-local-traces</div>
<!--l. 1729--><p class="nopar" >
<!--l. 1731--><p class="noindent" >will perform the trace analysis on the model <span 
class="ectt-1095">protein2x2ka</span>, and produce two dot format ï¬les
<span 
class="ectt-1095">Agent_trace_K_x^.dot </span>and <span 
class="ectt-1095">Agent_trace.P.a1_.a2_.b1_.b2_.g^.dot</span>. The name of the output
repository can be changed thanks to the command line options <span 
class="ectt-1095">--output-directory </span>and
<span 
class="ectt-1095">--output-local-trace-directory</span>. This time, the ï¬les describe a coarse-graining of the
corresponding transition systems.
<!--l. 1735--><p class="noindent" >For instance, the coarse-grained transition system for the local traces of the proteins of kind
<!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi></math>, is given
in FigureÂ <a 
href="#x1-6701612">7.12<!--tex4ht:ref: fig:trace-macro --></a>. This coarse-grained transition system is a compact implicit encoding of the transition
system in FigureÂ <a 
href="#x1-6701511">7.11<!--tex4ht:ref: fig:trace-raw --></a>. It is obtained by exploiting the fact that locally, the behavior of the pair of
states <!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> and
<!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> is independent from the
behavior of the pair of states <!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
and <!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>,
until these four sites are phosphorylated, so that the site
<!--l. 1735--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi></math> can
get bound.
<!--l. 1738--><p class="noindent" >More formally, in that transition system, some states are microstates (in a
microstate, the state of each site is documented); some others are macrostates: (in
a macrostate, the states of only a subset of site is documented). Thus a macrostate
<!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
></math>
can be seen intensionally as a part of a local view, but also extensionnaly as the set
<!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
of the local views they are a subpart of. A microstate
<!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math> can be described by any sequence
<!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math> of macrostates prodiding
that the intersection <!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-op"> â‹‚</mo>
 <!--nolimits--><mi 
>Î³</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math> of the
extensional denotation <!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Î³</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math> of these
macrostates <!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></math>, is equal to the
singleton <!--l. 1739--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>v</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>; moreover a transition
between two microstates <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>
and <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></math>
can be described by any transition between one macro state
                                                                                  

                                                                                  
<!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
></math> and another one
<!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi><msup><mrow 
></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
></math>, provided that there exists
a sequence of macrostate <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
such that the sequence <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
denotes the microstate <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>
and the sequence <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>v</mi><msup><mrow 
></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></mrow><mrow 
><mi 
>â™¯</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow><mrow 
><mi 
>â™¯</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math> denotes
the microstate <!--l. 1740--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></math>.
<!--l. 1742--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6701612"></a>
                                                                                  

                                                                                  

<!--l. 1744--><p class="noindent" ><img 
src="generated_img/trace_macro.png" alt="PIC"  
width="284.52756pt" height="111.59323pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.12: </span><span  
class="content">Local traces for the <span 
class="ectt-1095">protein2x2.ka </span>model deï¬ned in SectionÂ <a 
href="#x1-670007.4">7.4<!--tex4ht:ref: sec:local-traces --></a></span></div><!--tex4ht:label?: x1-6701612 -->
                                                                                  

                                                                                  
<!--l. 1747--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1749--><p class="noindent" >Such coarse-grained transition system can be geometrically interpreted as a simplicial complex
<span class="cite">[<span 
class="ecbx-1095">?</span>]</span>.
<!--l. 1751--><p class="noindent" >As a microstate could be decomposed into several sequences of macrostates (including the trivial
sequence containing only the microstate itself), the system may jump spontaneously (by using a
<!--l. 1751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ğœ€</mi></math>
transition) from one representation to another representation. This corresponds to the
intersection between several simplexes in the corresponding simpliï¬cial complex.
<!--l. 1753--><p class="noindent" >Although the semantics of a coarse-grainged transition system is fully deï¬ned by its labelled
transitions, it is useful to annotate the graph by some information about the relation between the
denotation of each macrostate. By default, we use hypertlinks to relate each macrostate
<!--l. 1753--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>
(including each microstate) to the set of its immediate subparts
<!--l. 1754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></math>. In such a
hyperlink, <!--l. 1754--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>
is connected via a dotted arrow, whereas each immediate subpart is connected via a dashed
arrow.
<!--l. 1756--><p class="noindent" >More options are available in expert mode, but they are not documented yet.
<h3 class="sectionHead"><span class="titlemark">7.5   </span> <a 
 id="x1-680007.5"></a>Contact map</h3>
<!--l. 1760--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6800113"></a>
                                                                                  

                                                                                  

<!--l. 1762--><p class="noindent" ><img 
src="img/kasa_4.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.13: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Contact map</span></span></div><!--tex4ht:label?: x1-6800113 -->
                                                                                  

                                                                                  
<!--l. 1765--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1767--><p class="noindent" >The contact map of a model is an object that may help modelers checking the consistency of the
rule set they use. The contact map is <span 
class="ecti-1095">statically </span>computed and does not depend on kinetic rates
nor initial conditions.
<!--l. 1770--><p class="noindent" >Typing the following instruction:
<!--l. 1772--><p class="noindent" ><span 
class="ectt-1095">KaSa abc.ka â€“reset-all â€“compute-contact-map</span>
<!--l. 1774--><p class="noindent" >will produce a dot format ï¬le named <span 
class="ectt-1095">contact.dot</span>. The name of the output ï¬le and the
directory can be changed thanks to the command line options <span 
class="ectt-1095">--output-contact-map </span>and
<span 
class="ectt-1095">--output-directory</span>. The directory is assumed to exist. The ï¬le will be overwritten if it exists.
All the options related to the computation of the contact map can be accessed on the sub-tab
<span 
class="ectt-1095">Contact map </span>of the graphical interface (see Fig.Â <a 
href="#x1-6900115">7.15<!--tex4ht:ref: fig:kasa:4 --></a>).
<!--l. 1782--><p class="noindent" >The contact map summarises the diï¬€erent types of agent, their interface and the potential
binding between sites. It is an over approximation, thus if the contact map indicates a potential
bond, it does not mean that it is always possible to reach a state in which two sites of these
kinds are bound, but if the contact map indicates no bond between two sites, it means
that it is NOT possible to reach a state in which two sites of these kinds are bound
together.
<!--l. 1785--><p class="noindent" >The contact map for the <span 
class="ectt-1095">abc.ka </span>model deï¬ned in ChapterÂ <a 
href="#x1-400005">5<!--tex4ht:ref: chap:abc --></a> is given in
FigureÂ <a 
href="#x1-6800214">7.14<!--tex4ht:ref: fig:abc-contact --></a>. On this map, we notice that there are three kinds of agent, namely
<!--l. 1785--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math>,
<!--l. 1785--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math>, and
<!--l. 1785--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi></math>. Agents of
kind <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math> have
two sites <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>,
that bear no internal state (they appear in yellow only), agents of kind
<!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math> have one
site <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>,
that bears no internal state (they appear in yellow only), and agents of kind
<!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi></math> have two
sites <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
and <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
with both a binding state and an internal state (they appear both in yellow and in green). We
notice that when a site can bear both an internal state and a binding state, they are considered as
two diï¬€erent sites in the contact map. Additionally, the contact map indicates that sites
<!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> of the agents of kind
<!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math> can be bound to the
site <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> of an agent of
                                                                                  

                                                                                  
kind <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi></math> and that sites
<!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math> of the agents of
kind <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math> can be bound
to the agents of kind <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi></math>
either on the site <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>, or
on the site <!--l. 1786--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>.
<!--l. 1788--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6800214"></a>
                                                                                  

                                                                                  

<!--l. 1790--><p class="noindent" ><img 
src="generated_img/abc_contact.png" alt="PIC"  
width="227.62204pt" height="124.38681pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.14: </span><span  
class="content">Contact Map for the <span 
class="ectt-1095">abc.ka </span>model deï¬ned in ChapterÂ <a 
href="#x1-400005">5<!--tex4ht:ref: chap:abc --></a></span></div><!--tex4ht:label?: x1-6800214 -->
                                                                                  

                                                                                  
<!--l. 1793--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">7.6   </span> <a 
 id="x1-690007.6"></a>Inï¬‚uence map</h3>
<!--l. 1799--><p class="noindent" >The inï¬‚uence map of a model is an object that may help modelers checking the consistency of the
rule set they use.
<!--l. 1801--><p class="noindent" >Typing the following instruction:
<!--l. 1803--><p class="noindent" ><span 
class="ectt-1095">KaSa abc.ka â€“reset-all â€“compute-influence-map</span>
<!--l. 1805--><p class="noindent" >will produce a dot format ï¬le named <span 
class="ectt-1095">influence.dot</span>. The name of the output ï¬le and the
directory can be changed thanks to the command line options <span 
class="ectt-1095">--output-influence-map </span>and
<span 
class="ectt-1095">--output-directory</span>. The directory is assumed to exist. The ï¬le will be overwritten if it exists.
All the options related to the computation of the inï¬‚uence map can be accessed on the sub-tab
<span 
class="ectt-1095">Influence map </span>of the graphical interface (see Fig.Â <a 
href="#x1-6900115">7.15<!--tex4ht:ref: fig:kasa:4 --></a>). Two formats are available for the
output: inï¬‚uence map can be generated in DOT or HTML format. The format can be choosen
thanks to the command line option <span 
class="ectt-1095">--influence-map-format</span>.
<!--l. 1809--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6900115"></a>
                                                                                  

                                                                                  

<!--l. 1811--><p class="noindent" ><img 
src="img/kasa_5.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.15: </span><span  
class="content"><span 
class="ecss-1095">KaSa</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Influence map</span></span></div><!--tex4ht:label?: x1-6900115 -->
                                                                                  

                                                                                  
<!--l. 1814--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1816--><p class="noindent" >Unlike the ï¬‚ux map, the inï¬‚uence map is <span 
class="ecti-1095">statically </span>computed and does not depend on kinetic
rates nor the quantities in initial conditions. It describes how rules may potentially inï¬‚uence each
other during a simulation. <span 
class="ecss-1095">KaSa</span>Â will produce a dot format ï¬le containing the inï¬‚uence relation
over all rules and observables of the model. The produced graph visualised using a circular
rendering<span class="footnote-mark"><a 
href="Ka4.htm#fn1x8"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-69002f1"></a> 
is given in FigureÂ <a 
href="#x1-6900316">7.16<!--tex4ht:ref: fig:kasa-abc-im --></a>. Observables are represented as circular nodes and rules as rectangular
nodes. The labels of the nodes are either the label of the rule or of the observable
(if available), otherwise it is made of a unique identiï¬er allocated by <span 
class="ecss-1095">KaSa</span>Â followed
by the kappa deï¬nition of the rule/observable. Edges are decorated with the list of
embeddings (separated by a semi-colon) allowing the identiï¬cation of agents in both rules<span 
class="tcrm-1095">'</span>s
right hand sides/left hand sides. More precisely, for positive inï¬‚uences, the notation
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> denotes a pair of embeddings
from the agent number <!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
of the origin<span 
class="tcrm-1095">'</span>s right hand side and from the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math> of the target<span 
class="tcrm-1095">'</span>s left hand
side and the notation <!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi><mo 
class="MathClass-bin">â‹†</mo> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
denotes a pair of embeddings from an agent attached to the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math> of the
origin<span 
class="tcrm-1095">'</span>s left hand side, which have been freed by side eï¬€ect and from the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math>
of the target<span 
class="tcrm-1095">'</span>s left hand side; for negative inï¬‚uences, the notation
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> denotes a pair of embeddings
from the agent number <!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
of the origin<span 
class="tcrm-1095">'</span>s left hand side and from the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math> of the target<span 
class="tcrm-1095">'</span>s left hand
side and the notation <!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi><mo 
class="MathClass-bin">â‹†</mo> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
denotes a pair of embeddings from an agent attached to the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math> of the
origin<span 
class="tcrm-1095">'</span>s left hand side, which have been freed by side eï¬€ect and from the agent number
<!--l. 1818--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math> of the
target<span 
class="tcrm-1095">'</span>s left hand side; Observables have no inï¬‚uence, but they can be inï¬‚uenced by rules, if the
rule can increase or decrease their value.
<!--l. 1822--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6900316"></a>
                                                                                  

                                                                                  

<!--l. 1824--><p class="noindent" ><img 
src="generated_img/abc_influence.png" alt="PIC"  
>
<br />  <div class="caption" 
><span class="id">FigureÂ 7.16:   </span><span  
class="content">The   inï¬‚uence   map   of   the   <span 
class="ectt-1095">abc.ka  </span>model   deï¬ned   in   ChapterÂ <a 
href="#x1-400005">5<!--tex4ht:ref: chap:abc --></a>.
Edge    labels    denote    embeddings    with    the    convention    that    the    notation
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
in   a   positive   inï¬‚uence,   denotes   a   pair   of   embeddings   from   the   agent   number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
of     the     origin<span 
class="tcrm-1095">'</span>s     right     hand     side     and     from     the     agent     number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math>
of the target<span 
class="tcrm-1095">'</span>s left hand side; the notation <!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
in   negative   inï¬‚uence,   denotes   a   pair   of   embeddings   from   the   agent   number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
of     the     origin<span 
class="tcrm-1095">'</span>s     left     hand     side     and     from     the     agent     number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math>
of the target<span 
class="tcrm-1095">'</span>s left hand side; the notation <!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>i</mi><mo 
class="MathClass-bin">â‹†</mo> <mo 
class="MathClass-rel">â†’</mo> <mi 
>j</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
whatever     the     inï¬‚uence     is     positive     of     negative,     denotes     a     pair
of     embeddings     from     an     agent     attached     to     the     agent     number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
of the origin<span 
class="tcrm-1095">'</span>s left hand side, which have been freed by side eï¬€ect and from the agent number
<!--l. 1828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi></math>
of the target<span 
class="tcrm-1095">'</span>s left hand side. </span></div><!--tex4ht:label?: x1-6900316 -->
                                                                                  

                                                                                  
<!--l. 1830--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1832--><p class="noindent" >More formally, consider the rules <!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>L</mi> <mo 
class="MathClass-rel">â†’</mo> <mi 
>R</mi></math>
and <!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi> <mo 
class="MathClass-punc">:</mo> <msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
><mo 
class="MathClass-rel">â†’</mo> <msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>â€²</mi></mrow></msup 
></math>.
One wishes to know whether it is possible that the application of rule
<!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi></math> over a graph
<!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math> creates a new instance
of rule <!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math> (which is
called a positive inï¬‚uence and that is described by green arrows in the inï¬‚uence map), or destroy a previous
instance of rule <!--l. 1832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
(which is called negative inï¬‚uence and that is described by red arrows in the inï¬‚uence map). In
Fig.Â <a 
href="#x1-6900417">7.17<!--tex4ht:ref: fig:imbis --></a>, we illustrate the construction of positive inï¬‚uences due to overlap of the left hand side
of a rule and the right hand side of another rule on some sites that are modiï¬ed by the former
one.
<!--l. 1835--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6900417"></a>
                                                                                  

                                                                                  

<!--l. 1837--><p class="noindent" ><img 
src="img/im.png" alt="PIC"  
width="227.62204pt" height="117.69954pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.17: </span><span  
class="content">Computation of the inï¬‚uence of the top rule on the rule below: the right hand
side of the ï¬rst rules embeds in a common term with the left hand side of the second rule.
It results that the ï¬rst rule has a positive inï¬‚uence on the second.</span></div><!--tex4ht:label?: x1-6900417 -->
                                                                                  

                                                                                  
<!--l. 1840--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1842--><p class="noindent" >The current implementation has the following limitations:
     <ul class="itemize1">
     <li class="itemize">Currently, only observables that are deï¬ned as patterns are taken into account.
     </li>
     <li class="itemize">Not atomic observables which are deï¬ned as algebraic expressions are not taken into
     account yet. The observables are ignored.
     </li>
     <li class="itemize">The inï¬‚uence map does not take into account indirect inï¬‚uences due to perturbations
     (which could arises when the application of a rule triggers a perturbation which would
     create some agents or increase/decrease the value of some variables).
     </li>
     <li class="itemize">Token are not taken into yet. They are currently ignored.
     </li>
     <li class="itemize">Positive/negative inï¬‚uence of time is not taken into account either.</li></ul>
<!--l. 1851--><p class="noindent" >Lastly, KaSaÂ computes an over-approximation of the inï¬‚uence map. They may show an inï¬‚uence
despite the fact that there can be no actual one. But if it shows no inï¬‚uence it means that either
there are NO such inï¬‚uence, or that we are in a case that is not covered yet as itemised
previously.
<!--l. 1853--><p class="noindent" >Three levels of precision are available: <span 
class="ectt-1095">Low</span>, <span 
class="ectt-1095">Medium</span>, and <span 
class="ectt-1095">High</span>. The level of precision can be
changed thanks to the command line option <span 
class="ectt-1095">--influence-map-accuracy-level</span>.
<!--l. 1856--><p class="noindent" >At low precision, an inï¬‚uence is detected if one rule change at least one bit of information (the
internal state of a site, the binding state of a site), in favor/defavor of the application another
rule. This abstraction level ignore completely the context of application of rules, and just focuses
on modiï¬cations.
<!--l. 1858--><p class="noindent" >At medium precision, the analysis checks that both rules have a common context.
<!--l. 1860--><p class="noindent" >At high precision, the analysis checks that such common context is realizable taking into account
the species that have been declared as initial states and the potential species introduction in
perturbations. High resolution inï¬‚uence is parameterized by the accuracy of the reachability
analysis. It may happen that a given context is infeasible, but that this is not detected by the
analysis.
<!--l. 1864--><p class="noindent" >Let us illustrate these three levels of accuracy by a case study.
<!--l. 1866--><p class="noindent" >We consider the following model. <!--l. 1867-->
<div class="lstlisting" id="listing-31"><span class="label"><a 
 id="x1-69005r1"></a><span 
class="ecrm-0600">1</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">%agent:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">w~u~p,x~u~p,y~u~p,z~u~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69006r2"></a><span 
class="ecrm-0600">2</span></span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69007r3"></a><span 
class="ecrm-0600">3</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69008r4"></a><span 
class="ecrm-0600">4</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p,y~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p,y~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69009r5"></a><span 
class="ecrm-0600">5</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p,z~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">y~p,z~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69010r6"></a><span 
class="ecrm-0600">6</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u,z~p,w~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u,z~p,w~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69011r7"></a><span 
class="ecrm-0600">7</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u,z~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~u,z~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69012r8"></a><span 
class="ecrm-0600">8</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p,w~p</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">-&#x003E;</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">(</span><span 
class="ectt-1095">x~p,w~u</span><span 
class="ectt-1095">)</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">@1</span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69013r9"></a><span 
class="ecrm-0600">9</span></span><span 
class="ectt-1095">Â </span><br /><span class="label"><a 
 id="x1-69014r10"></a><span 
class="ecrm-0600">10</span></span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">%init:</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">10</span><span 
class="ectt-1095">Â </span><span 
class="ectt-1095">A</span><span 
class="ectt-1095">()</span>
                                                                                  

                                                                                  
</div>
<!--l. 1880--><p class="noindent" >The low resolution inï¬‚uence map is given in Fig.Â <a 
href="#x1-6901518">7.18<!--tex4ht:ref: fig:low-res --></a>. There is a positive arc (in green) from a
rule to another one whenever the application of the former pushes at least one bit of information
towards the application of the later; whereas there is a negative arc (in red) from a rule to
another one whenever the former pulls at least one bit of information away from the application
of the later.
<!--l. 1883--><p class="noindent" >The medium resolution inï¬‚uence map is given in Fig.Â <a 
href="#x1-6901619">7.19<!--tex4ht:ref: fig:medium-res --></a>. Every arc corresponding to
incompatible contexts have been removed. In our example, these are the arcs from the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math> and the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math> (in both direction). Despite
the fact that the rule <!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>
may phosphorylate the site <span 
class="ectt-1095">w </span>which is required to apply the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math>, no instance
of the rule <!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math>
may be applied thanks to the application of the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math> right after, because after
the application of the rule <!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>
the state of the site <!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
is necessarily unphosphorylated, whereas it has to be phosphorylated for the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math>
to be applied. The same kind of explanation holds to remove the arc from the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math> to the rule
<!--l. 1885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>.
<!--l. 1887--><p class="noindent" >There are some structural invariants in these models. We give in Fig.Â <a 
href="#x1-6901821">7.21<!--tex4ht:ref: fig:reachability_influence --></a> the
log of the computation of the high resolution contact map. It turns out that
whenever the site <span 
class="ectt-1095">y </span>of an agent is phosphorylated, then the site <span 
class="ectt-1095">x </span>of this protein is
phosphorylated as well. Thus we can deduce that the positive arc from the rules
<!--l. 1887--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math> and
<!--l. 1887--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>, and the negative
arcs from the rules <!--l. 1887--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
and <!--l. 1887--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn></math>
(in both direction) are false positive unless we change the set of the species in the initial state
or in the perturbations. Thus we obtain the high resolution inï¬‚uence map given in
Fig.Â <a 
href="#x1-6901720">7.20<!--tex4ht:ref: fig:high-res --></a>.
<!--l. 1893--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6901518"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1894--><p class="noindent" >

<!--l. 1895--><p class="noindent" ><img 
src="generated_img/inf_map_low_res.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 7.18: </span><span  
class="content">Low resolution inï¬‚uence map</span></div><!--tex4ht:label?: x1-6901518 -->
</div>
                                                                                  

                                                                                  
<!--l. 1899--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1900--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6901619"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1901--><p class="noindent" >

<!--l. 1902--><p class="noindent" ><img 
src="generated_img/inf_map_medium_res.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 7.19: </span><span  
class="content">Medium resolution inï¬‚uence map</span></div><!--tex4ht:label?: x1-6901619 -->
</div>
                                                                                  

                                                                                  
<!--l. 1906--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1907--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6901720"></a>
                                                                                  

                                                                                  
<div class="center" 
>
<!--l. 1908--><p class="noindent" >

<!--l. 1909--><p class="noindent" ><img 
src="generated_img/inf_map_high_res.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">FigureÂ 7.20: </span><span  
class="content">High resolution inï¬‚uence map</span></div><!--tex4ht:label?: x1-6901720 -->
</div>
                                                                                  

                                                                                  
<!--l. 1913--><p class="noindent" ></div><hr class="endfigure">
<!--l. 1915--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-6901821"></a>
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-14">
KappaÂ StaticÂ AnalyzerÂ (03078c3)Â (withoutÂ TkÂ interface)
Â <br />AnalysisÂ launchedÂ atÂ 2017/05/28Â 20:53:28Â (GMT+0)Â on
Â <br />testing-gce-72eb6219-036a-4830-9e48-c1699a3d1ba2
Â <br />ParsingÂ ../kappa/influence.ka...
Â <br />done
Â <br />Compiling...
Â <br />ReachabilityÂ analysis...
Â <br />------------------------------------------------------------
Â <br />everyÂ ruleÂ mayÂ beÂ applied
Â <br />------------------------------------------------------------
Â <br />everyÂ agentÂ mayÂ occurÂ inÂ theÂ model
Â <br />
Â <br />------------------------------------------------------------
Â <br />*Â NonÂ relationalÂ properties:
Â <br />------------------------------------------------------------
Â <br />A()Â =&#x003E;Â [Â A(x~u)Â vÂ A(x~p)Â ]
Â <br />A()Â =&#x003E;Â [Â A(w~u)Â vÂ A(w~p)Â ]
Â <br />A()Â =&#x003E;Â [Â A(y~u)Â vÂ A(y~p)Â ]
Â <br />A()Â =&#x003E;Â [Â A(z~u)Â vÂ A(z~p)Â ]
Â <br />
Â <br />------------------------------------------------------------
Â <br />*Â RelationalÂ properties:
Â <br />------------------------------------------------------------
Â <br />A(w~p)Â =&#x003E;Â A(w~p,z~p)
Â <br />A(y~p)Â =&#x003E;Â A(x~p,y~p)
Â <br />------------------------------------------------------------
Â <br />*Â PropertiesÂ inÂ connectedÂ agents
Â <br />------------------------------------------------------------
Â <br />------------------------------------------------------------
Â <br />*Â PropertiesÂ ofÂ pairsÂ ofÂ bonds
Â <br />------------------------------------------------------------
Â <br />executionÂ finishedÂ withoutÂ anyÂ exception</div>
<!--l. 34--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">FigureÂ 7.21: </span><span  
class="content">Log of the reachability analysis.</span></div><!--tex4ht:label?: x1-6901821 -->
                                                                                  

                                                                                  
<!--l. 1919--><p class="noindent" ></div><hr class="endfigure">
                                                                                  

                                                                                  
<h2 class="chapterHead"><span class="titlemark">ChapterÂ 8</span><br /><a 
 id="x1-700008"></a>The <span 
class="ecss-1095">KaDE</span>Â ODEs generator</h2>
<h3 class="sectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-710008.1"></a>General usage</h3>
<!--l. 1925--><p class="noindent" >From a terminal window, <span 
class="ecss-1095">KaDE</span>Â can be invoked by typing:
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaDE file_1 ... file_n [option]</span></li></ul>
<!--l. 1929--><p class="noindent" >where <span 
class="ectt-1095">file_i </span>are the input Kappa ï¬les containing the rules, initial conditions and observables
(see ChapterÂ <a 
href="#x1-140003">3<!--tex4ht:ref: chap:kappa --></a>).
<!--l. 1931--><p class="noindent" >All the options are summarised as follows:
                                                                                  

                                                                                  
<div class="verbatim" id="verbatim-15">
GeneralÂ options
Â <br />Â Â --helpÂ Â Â Â Â Â Â Â Â Â Â Â VerboseÂ help
Â <br />Â Â Â -hÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â ShortÂ help
Â <br />Â Â --versionÂ Â Â Â Â Â Â Â Â ShowÂ versionÂ number
Â <br />Â Â --guiÂ Â Â Â Â Â Â Â Â Â Â Â Â GUIÂ toÂ select
Â <br />Â Â --(no-)expertÂ Â Â Â Â ExpertÂ modeÂ (moreÂ options)
Â <br />
Â <br />DataÂ set
Â <br />Â Â -(no-)initialÂ &#x003C;float&#x003E;Â Â Â (default:Â 0.000000)
Â <br />Â Â Â Â Â Â MinÂ timeÂ ofÂ simulationÂ (arbitraryÂ timeÂ unit)
Â <br />Â Â -(no-)lÂ &#x003C;float&#x003E;Â Â Â (default:Â 1.000000)
Â <br />Â Â Â Â Â Â LimitÂ ofÂ theÂ simulation
Â <br />Â Â -(no-)pÂ &#x003C;float&#x003E;Â Â Â (default:Â 0.010000)
Â <br />Â Â Â Â Â Â plotÂ period:Â timeÂ intervalÂ betweenÂ pointsÂ inÂ plotÂ (default:Â 1.0)
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />Output
Â <br />Â Â --(no-)output-plotÂ &#x003C;name&#x003E;Â Â Â (defaultÂ data.csv)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ dataÂ output
Â <br />Â Â --ode-backendÂ dotnetÂ |Â mapleÂ |Â mathematicaÂ |Â matlabÂ |Â octaveÂ |Â sbml
Â <br />Â (default:Â octave)
Â <br />Â Â Â Â Â Â SelectÂ theÂ backendÂ format
Â <br />Â Â -modeÂ batchÂ |Â interactive
Â <br />Â (default:Â interactive)
Â <br />Â Â Â Â Â Â eitherÂ &#x0022;batch&#x0022;Â toÂ neverÂ askÂ anythingÂ toÂ theÂ userÂ orÂ &#x0022;interactive&#x0022;Â to
Â <br />Â Â Â Â Â Â askÂ somethingÂ beforeÂ doingÂ anything
Â <br />Â Â --(no-)constant-propagationÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â propagateÂ constants
Â <br />Â Â --(no-)show-reactionsÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â AnnotateÂ ODEsÂ byÂ theÂ correspondingÂ chemicalÂ reactions
Â <br />Â Â --(no-)smash-reactionsÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â GatherÂ identicalÂ reactionsÂ inÂ theÂ ODEs
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
                                                                                  

                                                                                  
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />Semantics
Â <br />Â Â --(no-)output-plotÂ &#x003C;name&#x003E;Â Â Â (defaultÂ data.csv)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ dataÂ output
Â <br />Â Â --rate-conventionÂ KaSimÂ |Â Divide_by_nbr_of_autos_in_lhsÂ |Â Biochemist
Â <br />Â (default:Â Divide_by_nbr_of_autos_in_lhs)
Â <br />Â Â Â Â Â Â conventionÂ forÂ dividingÂ constantÂ rates
Â <br />Â Â --countÂ EmbeddingsÂ |Â Occurrences
Â <br />Â (default:Â Embeddings)
Â <br />Â Â Â Â Â Â tuneÂ whetherÂ weÂ coundÂ inÂ embeddingsÂ orÂ inÂ occurrences
Â <br />Â Â --(no-)truncateÂ &#x003C;int&#x003E;Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â truncateÂ theÂ networkÂ byÂ discardingÂ speciesÂ withÂ sizeÂ greaterÂ thanÂ the
Â <br />Â Â Â Â Â Â argument
Â <br />Â Â --with-symmetriesÂ NoneÂ |Â BackwardÂ |Â Forward
Â <br />Â (default:Â None)
Â <br />Â Â Â Â Â Â TuneÂ whichÂ kindÂ ofÂ bisimulationÂ isÂ usedÂ toÂ reduceÂ theÂ setÂ ofÂ species
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />IntegrationÂ settings
Â <br />Â Â -(no-)initialÂ &#x003C;float&#x003E;Â Â Â (default:Â 0.000000)
Â <br />Â Â Â Â Â Â MinÂ timeÂ ofÂ simulationÂ (arbitraryÂ timeÂ unit)
Â <br />Â Â -(no-)lÂ &#x003C;float&#x003E;Â Â Â (default:Â 1.000000)
Â <br />Â Â Â Â Â Â LimitÂ ofÂ theÂ simulation
Â <br />Â Â --(no-)output-plotÂ &#x003C;name&#x003E;Â Â Â (defaultÂ data.csv)
Â <br />Â Â Â Â Â Â fileÂ nameÂ forÂ dataÂ output
Â <br />Â Â --(no-)smash-reactionsÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â GatherÂ identicalÂ reactionsÂ inÂ theÂ ODEs
Â <br />Â Â -(no-)pÂ &#x003C;float&#x003E;Â Â Â (default:Â 0.010000)
Â <br />Â Â Â Â Â Â plotÂ period:Â timeÂ intervalÂ betweenÂ pointsÂ inÂ plotÂ (default:Â 1.0)
Â <br />Â Â --(no-)compute-jacobianÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â Enable/disableÂ theÂ computationÂ ofÂ theÂ JacobianÂ ofÂ theÂ ODEs
Â <br />Â (not
Â <br />Â Â Â Â Â Â availableÂ yet)
Â <br />Â Â --(no-)nonnegativeÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â Enable/disableÂ theÂ correctionÂ ofÂ negativeÂ concentrationsÂ inÂ stiffÂ ODE
Â <br />Â Â Â Â Â Â systems
                                                                                  

                                                                                  
Â <br />Â Â --initial-stepÂ &#x003C;float&#x003E;Â Â Â (defaultÂ 0.000010)
Â <br />Â Â Â Â Â Â InitialÂ integrationÂ step
Â <br />Â Â --max-stepÂ &#x003C;float&#x003E;Â Â Â (defaultÂ 0.020000)
Â <br />Â Â Â Â Â Â MaximumÂ integrationÂ step
Â <br />Â Â --relative-toleranceÂ &#x003C;float&#x003E;Â Â Â (defaultÂ 0.001000)
Â <br />Â Â Â Â Â Â toleranceÂ toÂ relativeÂ roundingÂ errors
Â <br />Â Â --absolute-toleranceÂ &#x003C;float&#x003E;Â Â Â (defaultÂ 0.001000)
Â <br />Â Â Â Â Â Â toleranceÂ toÂ absoluteÂ roundingÂ errors
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />ModelÂ reduction
Â <br />Â Â --with-symmetriesÂ NoneÂ |Â BackwardÂ |Â Forward
Â <br />Â (default:Â None)
Â <br />Â Â Â Â Â Â TuneÂ whichÂ kindÂ ofÂ bisimulationÂ isÂ usedÂ toÂ reduceÂ theÂ setÂ ofÂ species
Â <br />Â Â --(no-)show-symmetriesÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â DisplayÂ theÂ equivalenceÂ relationsÂ overÂ theÂ sites
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />StaticÂ analysis
Â <br />Â Â --(no-)views-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â Enable/disableÂ viewsÂ analysisÂ whenÂ detectingÂ symmetricÂ sites
Â <br />Â Â --(no-)double-bonds-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â Enable/disableÂ doubleÂ bondsÂ analysisÂ whenÂ detectingÂ symmetricÂ sites
Â <br />Â Â --(no-)site-across-bonds-domainÂ Â Â Â (default:Â enabled)
Â <br />Â Â Â Â Â Â Enable/disableÂ theÂ analysisÂ ofÂ theÂ relationÂ amondÂ theÂ statesÂ ofÂ sites
Â <br />Â Â Â Â Â Â in
Â <br />Â connectedÂ agents
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />DebugÂ mode
Â <br />Â Â --(no-)show-time-advanceÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â DisplayÂ timeÂ advanceÂ duringÂ numericalÂ integration
                                                                                  

                                                                                  
Â <br />Â Â --(no-)debugÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â EnableÂ debugÂ mode
Â <br />Â Â --(no-)print-efficiencyÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â promptÂ CPUÂ timeÂ andÂ variousÂ datas
Â <br />Â Â --(no-)backtraceÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â BacktracingÂ exceptions
Â <br />Â Â --(no-)gluttonyÂ Â Â Â (default:Â disabled)
Â <br />Â Â Â Â Â Â LowerÂ gcÂ activityÂ forÂ aÂ fasterÂ butÂ memoryÂ intensiveÂ simulation
Â <br />Â Â -modeÂ batchÂ |Â interactive
Â <br />Â (default:Â interactive)
Â <br />Â Â Â Â Â Â eitherÂ &#x0022;batch&#x0022;Â toÂ neverÂ askÂ anythingÂ toÂ theÂ userÂ orÂ &#x0022;interactive&#x0022;Â to
Â <br />Â Â Â Â Â Â askÂ somethingÂ beforeÂ doingÂ anything
Â <br />Â Â -dÂ &#x003C;name&#x003E;Â Â Â (default:Â .)
Â <br />Â Â Â Â Â Â SpecifiesÂ directoryÂ nameÂ whereÂ outputÂ file(s)Â shouldÂ beÂ stored
Â <br />Â Â --outputÂ &#x003C;value&#x003E;
Â <br />Â Â Â Â Â Â PrefixÂ forÂ fileÂ nameÂ output
Â <br />
Â <br />(76Â options)</div>
<!--l. 140--><p class="nopar" >
<!--l. 1934--><p class="noindent" >Orders in option matter, since they can be used to toggle on/oï¬€ some functionalities or to
assign a value to some environment variables. The options are interpreted from left to
right.
<!--l. 1937--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-720008.2"></a>Graphical interface</h3>
<!--l. 1939--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.2.1   </span> <a 
 id="x1-730008.2.1"></a>Launching the interface</h4>
<!--l. 1941--><p class="noindent" >The graphical interface can be launched by typing
     <ul class="itemize1">
     <li class="itemize"><span 
class="ectt-1095">KaDE</span></li></ul>
<!--l. 1944--><p class="noindent" >without any option.
                                                                                  

                                                                                  
<!--l. 1946--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-730011"></a>
                                                                                  

                                                                                  

<!--l. 1948--><p class="noindent" ><img 
src="img/kade_0.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 8.1: </span><span  
class="content"><span 
class="ecss-1095">KaDE</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Data set</span></span></div><!--tex4ht:label?: x1-730011 -->
                                                                                  

                                                                                  
<!--l. 1951--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">8.2.2   </span> <a 
 id="x1-740008.2.2"></a>The areas of interest</h4>
<!--l. 1955--><p class="noindent" >There are ï¬ve diï¬€erent areas of importance in the graphical interface:
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-74002x1">On the top left of the window, a button allows for the selection between the Normal
     and the Expert mode (other modes may be available if activated at compilation). In
     expert mode, more options are available in the graphical interface.
     </li>
     <li 
  class="enumerate" id="x1-74004x2">On  the  top  center/right,  some  button  allows  for  the  selection  of  the  tab.  There
     are currently seven sub-tabs available: <span 
class="ectt-1095">Data set</span>, <span 
class="ectt-1095">Output</span>, <span 
class="ectt-1095">Semantics</span>, <span 
class="ectt-1095">Integration</span>
     <span 
class="ectt-1095">settings</span>, <span 
class="ectt-1095">Model reduction</span>, <span 
class="ectt-1095">Static analysis</span>, <span 
class="ectt-1095">Debug mode</span>. The last two tabs are
     availanle only in expert mode (which can be selected on the top-left of the window).
     </li>
     <li 
  class="enumerate" id="x1-74006x3">Center: The options of the selected sub-tab are displayed and can be tuned.
     <!--l. 1963--><p class="noindent" >Contextual help is provided when the mouse is hovered over an element. The interface
     will store the options that are checked or ï¬lled and the order in which they have been
     selected. When launched, the analysis interprets these options in the order they have
     been entered. Some options appear in several sub-tabs. They denote the same option
     and share the same value.
     </li>
     <li 
  class="enumerate" id="x1-74008x4">File selector: The ï¬le selector can be used to upload as many kappa ï¬les as desired.
     The button &#x2019;<span 
class="ectt-1095">Clear</span>&#x2019; can be used to reset the selection of ï¬les.
     </li>
     <li 
  class="enumerate" id="x1-74010x5">Bottom: Some buttons are available. The button &#x2019;<span 
class="ectt-1095">Quit</span>&#x2019; can be used to leave the
     interface. The button &#x2019;<span 
class="ectt-1095">Reset to default</span>&#x2019; tunes all the options to their default value.
     The button &#x2019;<span 
class="ectt-1095">Import options</span>&#x2019; can be used to restore the value of the options as saved
     during a previous session of the graphical interfaces. The button &#x2019;<span 
class="ectt-1095">Save options</span>&#x2019; can
     be used to save the value of the options for a further session. The button &#x2019;<span 
class="ectt-1095">Launch</span>
     <span 
class="ectt-1095">analyze</span>&#x2019; launch <span 
class="ecss-1095">KaDE</span>Â with the current options.
     <!--l. 1971--><p class="noindent" >Importantly, options are saved automatically under various occasions. Thus, it is
     possible to restore the value of the options before the last reset, before the last quit,
     or before the last analysis.</li></ol>
<!--l. 1975--><p class="noindent" >Two ï¬elds deï¬ne the repository and the name of the output:
                                                                                  

                                                                                  
     <ul class="itemize1">
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-d </span>sets the repository where output ï¬le are written. <span 
class="ecss-1095">KaDE</span>Â will create this
     repository, if it does not exist.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output </span>sets the name of the output ï¬le. The following extension will
     be added automatically according to the choice of the backend format: &#x0022;.net&#x0022; in
     DOTNET format, &#x0022;.mws&#x0022; in Maple, &#x0022;.nb&#x0022; in Mathematica, &#x0022;.m&#x0022; in Matlab and
     Octave, and &#x0022;.xml&#x0022; in SBML. When the output ï¬le already exists, <span 
class="ecss-1095">KaDE </span>will ask
     for conï¬rmation before overwritting it, unless the tool is set in batch mode (e.g.Â see
     Sect.Â <a 
href="#x1-780008.2.6">8.2.6<!--tex4ht:ref: kade:debug --></a>).</li></ul>
<!--l. 1981--><p class="noindent" >Both ï¬elds may be modiï¬ed from every sub-tab.
<!--l. 1986--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.2.3   </span> <a 
 id="x1-750008.2.3"></a>The sub-tab <span 
class="ectt-1095">Data set</span></h4>
<!--l. 1988--><p class="noindent" >The sub-tab <span 
class="ectt-1095">Data set </span>(see Fig.Â <a 
href="#x1-730011">8.1<!--tex4ht:ref: fig:kade:0 --></a>) contains the options to tune the time range for the
numerical integration and the frequency of sample plots. These ï¬elds are used only in Maple,
Mathematica, Matlab, and Octave backend formats. They are ignored in SBML and DOTNET
backend formats.
     <ul class="itemize1">
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--initial </span>deï¬nes the starting date of the simulation.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-l </span>deï¬nes the ï¬nal date of the simulation.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-p </span>deï¬nes the time interval between consecutive plots.</li></ul>
<!--l. 1996--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.2.4   </span> <a 
 id="x1-760008.2.4"></a>The sub-tab <span 
class="ectt-1095">Output</span></h4>
<!--l. 1998--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-760012"></a>
                                                                                  

                                                                                  

<!--l. 2000--><p class="noindent" ><img 
src="img/kade_1.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 8.2: </span><span  
class="content"><span 
class="ecss-1095">KaDE</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Output</span></span></div><!--tex4ht:label?: x1-760012 -->
                                                                                  

                                                                                  
<!--l. 2003--><p class="noindent" ></div><hr class="endfigure">
<!--l. 2006--><p class="noindent" >The sub-tab <span 
class="ectt-1095">Output </span>(see Fig.Â <a 
href="#x1-760012">8.2<!--tex4ht:ref: fig:kade:1 --></a>) contains the names of the output ï¬les and their
format.
     <ul class="itemize1">
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--ode-backend </span>allows for the choice among the diï¬€erent backend formats
     among DOTNET, Maple, Mathematica, Matlab, Octave and SBML.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-plot </span>sets the name of the ï¬le where the plots will be dumped
     when it applies. Only the Maple, Mathematica, Matlab and Octave dump plots. The
     option is ignored in the other backend formats.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--(no)-constant-propagation </span>switches on/oï¬€ constant propagation.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--(no)-show-reactions </span>annotates each expression in the output ï¬le,
     with the Kappa rule and the reaction that have generated this contribution.
     </li>
     <li class="itemize">The  option  <span 
class="ectt-1095">--(no)-smash-reactions </span>identiï¬es  multiple  occurrences  of  a  same
     reaction in the reaction network, and sums up their contribution into a single reaction.</li></ul>
<h4 class="subsectionHead"><span class="titlemark">8.2.5   </span> <a 
 id="x1-770008.2.5"></a>The sub-tab <span 
class="ectt-1095">Integration settings</span></h4>
<!--l. 2018--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-770013"></a>
                                                                                  

                                                                                  

<!--l. 2020--><p class="noindent" ><img 
src="img/kade_3.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 8.3: </span><span  
class="content"><span 
class="ecss-1095">KaDE</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">Integration settings</span></span></div><!--tex4ht:label?: x1-770013 -->
                                                                                  

                                                                                  
<!--l. 2023--><p class="noindent" ></div><hr class="endfigure">
<!--l. 2025--><p class="noindent" >The sub-tab <span 
class="ectt-1095">Integration settings </span>(see Fig.Â <a 
href="#x1-770013">8.3<!--tex4ht:ref: fig:kade:3 --></a>) contains the parameters to guide the
numerical integration engine. Except the option <span 
class="ectt-1095">--smash-reaction</span>, these options are ignored in
the SBML and the DOTNET backend format.
     <ul class="itemize1">
     <li class="itemize">The option <span 
class="ectt-1095">--compute-jacobian </span>switches on the computation of the Jacobian of the
     system of ordinary diï¬€erential equations. The Jacobian is computed symbolically. It
     speeds up the numerical integration. The computation of the Jacobian is implemented
     only in two backend formats: Matlab and Octave. Other formats will ignore this
     option.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--non-negative </span>can be used to force concentration to have a non negative
     value during numerical integration. The computation of the Jacobian is implemented
     only in two backend formats: Matlab and Octave. Other formats will ignore this
     option.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--initial-step </span>tunes the initial integration step. This ï¬eld is used only
     in Maple, Mathematica, Matlab, and Octave backend formats. It is ignored in SBML
     and DOTNET backend formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--max-step </span>tunes the maximal size of integration steps. This ï¬eld is used
     only in Maple, Mathematica, Matlab, and Octave backend formats. It is ignored in
     SBML and DOTNET backend formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--relative-tolerance </span>deï¬nes the relative numerical error tolerance in
     integration engines. This means that numerical errors cannot go beyond a bound that
     is proportional to the concentration of the bio-molecular species. This ï¬eld sets the
     value of the proportionality coeï¬ƒcient. This ï¬eld is used only in Maple, Mathematica,
     Matlab, and Octave backend formats. It is ignored in SBML and DOTNET backend
     formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--absolute-tolerance </span>deï¬nes the absolute numerical error tolerance in
     integration engines. This means that numerical errors cannot go beyond the value of
     that ï¬eld. This ï¬eld is used only in Maple, Mathematica, Matlab, and Octave backend
     formats. It is ignored in SBML and DOTNET backend formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--output-plot </span>deï¬ned the csv ï¬le where the values of the sample plots
                                                                                  

                                                                                  
     will be printed. This ï¬eld is used only in Maple, Mathematica, Matlab, and Octave
     backend formats. It is ignored in SBML and DOTNET backend formats.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--smash-reaction </span>gathers isomorphic reactions before generating the
     network or the system of ordinary diï¬€erential equations (while summing their rates).
     This option is used in every backend format.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--initial </span>deï¬nes the starting date of the simulation. This ï¬eld is used only
     in Maple, Mathematica, Matlab, and Octave backend formats. It is ignored in SBML
     and DOTNET backend formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-l </span>deï¬nes the ï¬nal date of the simulation. This ï¬eld is used only in Maple,
     Mathematica,  Matlab,  and  Octave  backend  formats.  It  is  ignored  in  SBML  and
     DOTNET backend formats.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-p </span>deï¬nes the time interval between two plots. This ï¬eld is used only in
     Maple, Mathematica, Matlab, and Octave backend formats. It is ignored in SBML
     and DOTNET backend formats.</li></ul>
<h4 class="subsectionHead"><span class="titlemark">8.2.6   </span> <a 
 id="x1-780008.2.6"></a>The sub-tab <span 
class="ectt-1095">Debug</span></h4>
<!--l. 2054--><p class="noindent" >In expert mode, the last sub-tab provides options to tune the amount of debugging information
that is displayed.
<!--l. 2056--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-780014"></a>
                                                                                  

                                                                                  

<!--l. 2058--><p class="noindent" ><img 
src="img/kade_5.png" alt="PIC"  
width="341.43306pt" height="216.61836pt" >
<br /> <div class="caption" 
><span class="id">FigureÂ 8.4: </span><span  
class="content"><span 
class="ecss-1095">KaDE</span>Â  graphical interface - sub-tab <span 
class="ectt-1095">6_debug_mode</span></span></div><!--tex4ht:label?: x1-780014 -->
                                                                                  

                                                                                  
<!--l. 2061--><p class="noindent" ></div><hr class="endfigure">
     <ul class="itemize1">
     <li class="itemize">The option <span 
class="ectt-1095">--(no)-show-time-advance </span>includes some instructions in the output ï¬le,
     so as to track the progress during numerical integration in the Maple, Mathematica,
     Matlab, and Octave backend. This option is ignored in the other backend format.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">--(no)-print-efficiency </span>provides some information about the CPU time
     that has been used to generate the set of reactions and about the size of the initial
     and reduced models.
     </li>
     <li class="itemize">The  option  <span 
class="ectt-1095">--(no)-backtrace </span>provides  more/less  information  about  internal
     exceptions.
     </li>
     <li class="itemize">The option <span 
class="ectt-1095">--(no)-glutonny </span>tunes the parameters of the garbage collector.
     </li>
     <li class="itemize">The ï¬eld <span 
class="ectt-1095">-mode </span>allows for the choice among batch and interactive mode. In interactive
     mode, <span 
class="ecss-1095">KaDE </span>always asks permission to overwrite ï¬les. In batch mode, <span 
class="ecss-1095">KaDE</span>Ã‚Äƒmay
     overwrite output ï¬les, without permission.</li></ul>
<h3 class="sectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-790008.3"></a>Diï¬€erential semantics</h3>
<!--l. 2080--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.3.1   </span> <a 
 id="x1-800008.3.1"></a>From rules to reactions</h4>
<!--l. 2082--><p class="noindent" >In Kappa, rules may be more and less reï¬ned <span class="cite">[<span 
class="ecbx-1095">?</span>,Â <span 
class="ecbx-1095">?</span>]</span>, according to their preconditions.
<!--l. 2084--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-800015"></a>
                                                                                  

                                                                                  
<div class="minipage">
<!--l. 2086--><p class="noindent" ><img 
src="Ka1x.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="Ka1x.png" src="img/sect1-bind.pdf"  
--></div>
<br /> <div class="caption" 
><span class="id">FigureÂ 8.5: </span><span  
class="content">Proteins <span 
class="ectt-1095">K </span>and <span 
class="ectt-1095">S </span>may bind. </span></div><!--tex4ht:label?: x1-800015 -->
                                                                                  

                                                                                  
<!--l. 2090--><p class="noindent" ></div><hr class="endfigure">
<!--l. 2091--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
<a 
 id="x1-800026"></a>
                                                                                  

                                                                                  
<div class="minipage">
<!--l. 2093--><p class="noindent" ><img 
src="Ka2x.png" alt="PIC" class="graphics"><!--tex4ht:graphics  
name="Ka2x.png" src="img/sect1-phos.pdf"  
--></div>
<br /> <div class="caption" 
><span class="id">FigureÂ 8.6: </span><span  
class="content">The protein <span 
class="ectt-1095">K </span>may activate the protein <span 
class="ectt-1095">S</span>.</span></div><!--tex4ht:label?: x1-800026 -->
                                                                                  

                                                                                  
<!--l. 2097--><p class="noindent" ></div><hr class="endfigure">
<!--l. 2101--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                  

                                                                                  
                                                                                  


